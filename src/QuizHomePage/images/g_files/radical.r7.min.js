/*
 *
 * @author ResponsiveAds Inc. (responsiveads.com)
 * @version 20221123.r7.3.9.7-10
 * Copyright (c) 2012-2022, ResponsiveAds Inc.
 */
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;var i;for(i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],2:[function(require,module,exports){(function(Buffer){(function(){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}}).call(this)}).call(this,require("buffer").Buffer)},{"base64-js":1,buffer:2,ieee754:5}],3:[function(require,module,exports){var objectCreate=Object.create||objectCreatePolyfill;var objectKeys=Object.keys||objectKeysPolyfill;var bind=Function.prototype.bind||functionBindPolyfill;function EventEmitter(){if(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events")){this._events=objectCreate(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;var hasDefineProperty;try{var o={};if(Object.defineProperty)Object.defineProperty(o,"x",{value:0});hasDefineProperty=o.x===0}catch(err){hasDefineProperty=false}if(hasDefineProperty){Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||arg!==arg)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=arg}})}else{EventEmitter.defaultMaxListeners=defaultMaxListeners}EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=="number"||n<0||isNaN(n))throw new TypeError('"n" argument must be a positive number');this._maxListeners=n;return this};function $getMaxListeners(that){if(that._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return that._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return $getMaxListeners(this)};function emitNone(handler,isFn,self){if(isFn)handler.call(self);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self)}}function emitOne(handler,isFn,self,arg1){if(isFn)handler.call(self,arg1);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1)}}function emitTwo(handler,isFn,self,arg1,arg2){if(isFn)handler.call(self,arg1,arg2);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2)}}function emitThree(handler,isFn,self,arg1,arg2,arg3){if(isFn)handler.call(self,arg1,arg2,arg3);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2,arg3)}}function emitMany(handler,isFn,self,args){if(isFn)handler.apply(self,args);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].apply(self,args)}}EventEmitter.prototype.emit=function emit(type){var er,handler,len,args,i,events;var doError=type==="error";events=this._events;if(events)doError=doError&&events.error==null;else if(!doError)return false;if(doError){if(arguments.length>1)er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Unhandled "error" event. ('+er+")");err.context=er;throw err}return false}handler=events[type];if(!handler)return false;var isFn=typeof handler==="function";len=arguments.length;switch(len){case 1:emitNone(handler,isFn,this);break;case 2:emitOne(handler,isFn,this,arguments[1]);break;case 3:emitTwo(handler,isFn,this,arguments[1],arguments[2]);break;case 4:emitThree(handler,isFn,this,arguments[1],arguments[2],arguments[3]);break;default:args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];emitMany(handler,isFn,this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');events=target._events;if(!events){events=target._events=objectCreate(null);target._eventsCount=0}else{if(events.newListener){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(!existing){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else{if(prepend){existing.unshift(listener)}else{existing.push(listener)}}if(!existing.warned){m=$getMaxListeners(target);if(m&&m>0&&existing.length>m){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+' "'+String(type)+'" listeners '+"added. Use emitter.setMaxListeners() to "+"increase limit.");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;if(typeof console==="object"&&console.warn){console.warn("%s: %s",w.name,w.message)}}}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;switch(arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:var args=new Array(arguments.length);for(var i=0;i<args.length;++i)args[i]=arguments[i];this.listener.apply(this.target,args)}}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=bind.call(onceWrapper,state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');events=this._events;if(!events)return this;list=events[type];if(!list)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=objectCreate(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else spliceOne(list,position);if(list.length===1)events[type]=list[0];if(events.removeListener)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(!events)return this;if(!events.removeListener){if(arguments.length===0){this._events=objectCreate(null);this._eventsCount=0}else if(events[type]){if(--this._eventsCount===0)this._events=objectCreate(null);else delete events[type]}return this}if(arguments.length===0){var keys=objectKeys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=objectCreate(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(!events)return[];var evlistener=events[type];if(!evlistener)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,false)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==="function"){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events){var evlistener=events[type];if(typeof evlistener==="function"){return 1}else if(evlistener){return evlistener.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1)list[i]=list[k];list.pop()}function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}return ret}function objectCreatePolyfill(proto){var F=function(){};F.prototype=proto;return new F}function objectKeysPolyfill(obj){var keys=[];for(var k in obj)if(Object.prototype.hasOwnProperty.call(obj,k)){keys.push(k)}return k}function functionBindPolyfill(context){var fn=this;return function(){return fn.apply(context,arguments)}}},{}],4:[function(require,module,exports){"use strict";exports=module.exports=function(doc){if(!doc)doc={};if(typeof doc==="string")doc={cookie:doc};if(doc.cookie===undefined)doc.cookie="";var self={};self.get=function(key){var cookiesSplat=doc.cookie.split(/;\s*/);for(var i=0;i<cookiesSplat.length;i++){var ps=cookiesSplat[i].split("=");var k=decodeURIComponent(ps[0]);if(k===key)return decodeURIComponent(ps[1])}};self.set=function(key,value,opts){if(!opts)opts={};var newCookie=encodeURIComponent(key)+"="+encodeURIComponent(value);if(opts.hasOwnProperty("expires")){newCookie+="; expires="+opts.expires}if(opts.hasOwnProperty("path")){newCookie+="; path="+opts.path}if(opts.hasOwnProperty("domain")){newCookie+="; domain="+opts.domain}if(opts.hasOwnProperty("secure")){newCookie+="; secure"}doc.cookie=newCookie;return newCookie};return self};if(typeof document!=="undefined"){var cookie=exports(document);exports.get=cookie.get;exports.set=cookie.set}},{}],5:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],6:[function(require,module,exports){var dom=require("./radical/dom");var layout=require("./radical/layout");var url=require("./radical/url");var createShrinkableText=require("./radical/elements/createShrinkableText");var conditionsTable=require("./radical/conditionsTable");var types={BACKGROUND_WIDGET:"backgroundWidget",BUTTON_WIDGET:"buttonWidget",IMAGE_BUTTON_WIDGET:"imageButtonWidget",TEXTBOX_WIDGET:"textboxWidget",CAROUSEL_WIDGET:"carouselWidget",CAROUSEL_SLIDE_WIDGET:"carouselSlideWidget",SOCIAL_ICON_WIDGET:"socialIconWidget",SOCIAL_GROUP_WIDGET:"socialGroupWidget",HTML5VIDEO_WIDGET:"html5videoWidget",YOUTUBE_WIDGET:"youtubeWidget",VIMEO_WIDGET:"vimeovideoWidget",BRIGHTCOVE_WIDGET:"brightcovevideowidget",IFRAME_WIDGET:"iframeWidget",SKIN_WIDGET:"skinWidget",SKIN_COMPARTMENT_WIDGET:"skinCompartmentWidget",IMAGE:"image",CUSTOM_PLAY_MUTE_RESTART_CONTROL:"videoCustomPlayMuteRestartControl",CUSTOM_CLICKTHROUGH_CONTROL:"videoClickthroughControl",TWITTER_FEED_WIDGET:"twitterFeedWidget",TWITTER_TIMELINE_WIDGET:"twitterTimelineWidget",ADSONICA_COMPONENT:"adsonicaComponent",SEEKBAR:"seekbar",COUNTDOWN:"countdown",HTML5VIDEOADVANCED_WIDGET:"html5videoAdvancedWidget",SVG_WIDGET:"svgWidget",OMNIVIRT:"omnivirt",IMAGE360:"image360",PLAYIN_WIDGET:"playinWidget"};function ruleToText(obj){return Object.keys(obj).map(function(propName){return propName+": "+obj[propName]}).join("; ")}function createIframe(container,context,config){var document=container.getAdDocument();var el;var obj={};if(context.adContent.screenshot&&config.iframeWidget.fallbackImage){el=document.createElement("div");var screenshot=document.createElement("img");dom.setInlineStyles(screenshot,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%"});screenshot.src=url.toFullUrl(config.iframeWidget.fallbackImage,context.adContent);el.appendChild(screenshot)}else{el=document.createElement("iframe");dom.setupIframe(el);el.frameBorder=0;if(config.iframeWidget.content){obj.rendered=function(){var frameDoc=el.contentDocument;frameDoc.open();frameDoc.write("<!DOCTYPE html><html><head><style>html,body{margin:0;padding:0;overflow:hidden;}</style></head><body>"+config.iframeWidget.content+"</body></html>");frameDoc.close()};if(!config.iframeWidget.hasOwnProperty("disableUpdate")||config.iframeWidget.disableUpdate===false){obj.updated=function(){obj.rendered()}}}else{if(!config.iframeWidget.hasOwnProperty("radMetrics")||config.iframeWidget.radMetrics===true){var clickthrough=context.getMergedContent().clickthrough;var data=context.getAnalyticsCollectData();if(!/\?/.test(config.iframeWidget.src)){config.iframeWidget.src+="?"}else{config.iframeWidget.src+="&"}config.iframeWidget.src+="rad-id="+data.aid;config.iframeWidget.src+="&rad-flowline="+data.fl;config.iframeWidget.src+="&rad-rada="+data.rada;config.iframeWidget.src+="&rad-radb="+data.radb;config.iframeWidget.src+="&rad-vs="+data.vs;config.iframeWidget.src+="&rad-uri="+encodeURIComponent(data.pu);config.iframeWidget.src+="&rad-ald="+data.ald;config.iframeWidget.src+="&rad-deployment="+data.deployment;config.iframeWidget.src+="&rad-sr="+data.sr;config.iframeWidget.src+="&rad-as="+data.as;config.iframeWidget.src+="&rad-o="+data.o;config.iframeWidget.src+="&rad-ascb="+data.ascb;config.iframeWidget.src+="&rad-uuid="+data.uuid;config.iframeWidget.src+="&rad-ec="+data.ec;config.iframeWidget.src+="&rad-asid="+data.asid;config.iframeWidget.src+="&rad-dm="+data.dm;if(clickthrough&&/^https?:\/\/\S+/i.test(clickthrough)){config.iframeWidget.src+="&rad-ctprefix="+encodeURIComponent(clickthrough)}}el.src=config.iframeWidget.src;if(config.iframeWidget.enableScrolling){el.setAttribute("scrolling","yes")}else{el.setAttribute("scrolling","no")}}}obj.domNode=el;return obj}function createDiv(container,context,config){var el=container.getAdDocument().createElement("div");var rendition;return{domNode:el,onRender:function(){var styles=context.getElementStyles(config.id);var activeConfig=context.getActiveConfig();var stylesToSet={};if(config.colorDataSource&&config.colorDataSource.type==="conditionsTable"&&activeConfig.conditionsTable&&activeConfig.activeConditionsTableRow){var col=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.colorDataSource.property);if(col){stylesToSet.css={background:col.value}}}if(styles.backgroundImage&&styles.backgroundImage.imageId){var bgSize=dom.getBackgroundSize(styles.backgroundImage.size);var repeat=styles.backgroundImage.repeat;var bgPosition=styles.backgroundImage.position?styles.backgroundImage.position.x+" "+styles.backgroundImage.position.y:"center center";var imageObjectReference=context.getActiveConfig().elements[styles.backgroundImage.imageId].image;var imageSrc=getImageSrc(imageObjectReference,styles.backgroundImage.usedRenditions,styles.computedSize,context.adContent.export?rendition:null);rendition=getUsedRendition(imageSrc,imageObjectReference.renditions);if(!stylesToSet.css){stylesToSet.css={}}stylesToSet.css.backgroundImage="url("+url.toFullUrl(imageSrc,context.adContent)+")";stylesToSet.css.backgroundPosition=bgPosition;stylesToSet.css.backgroundSize=bgSize;stylesToSet.css.backgroundRepeat=repeat}else{rendition=null;if(!stylesToSet.css){stylesToSet.css={}}stylesToSet.css.backgroundImage=""}context.setElementStyles(config.id,stylesToSet)},getRendition:function(){return rendition}}}function createButton(container,context,config){var document=container.getAdDocument();var content=config.buttonWidget.text.replace(/\n/g,"<br>");var element=createShrinkableText(document,content);const shrinkableOnRender=element.onRender;element.onRender=function(elementId,defs,styles,wasCreated){this.styles=styles;var activeConfig=context.getActiveConfig();if(activeConfig.conditionsTable&&activeConfig.activeConditionsTableRow){if(config.colorDataSource&&config.colorDataSource.type==="conditionsTable"){var col=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.colorDataSource.property);if(col){context.setElementStyles(config.id,{css:{background:col.value}})}}if(config.textColorDataSource&&config.textColorDataSource.type==="conditionsTable"){var col=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.textColorDataSource.property);if(col){context.setElementStyles(config.id,{fontSettings:{color:col.value}})}}if(config.dataSource&&config.dataSource.type==="conditionsTable"){var colText=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.dataSource.property);if(colText&&colText.value){config.buttonWidget.text=colText.value;content=config.buttonWidget.text.replace(/\n/g,"<br>");element.updateContent(content)}}}shrinkableOnRender.call(element,elementId,defs,styles,wasCreated)};element.domNode.className="button-widget";var css=ruleToText({position:"static",margin:"0 0 0 0","vertical-align":"middle"});container.addCSS(".button-widget div { "+css+" }","element-button-styles");return element}function getImageSrc(image,usedRenditions,computedSizeObject,selectedRenditionParam){var imageSrc=image.src;var shouldUseRenditions=usedRenditions&&usedRenditions.length>=1||!usedRenditions;if(image.renditions&&shouldUseRenditions){if(selectedRenditionParam){return selectedRenditionParam.url}else{var selectedRendition;var renditions={};var computedSize={width:computedSizeObject.width.value,height:computedSizeObject.height.value};if(usedRenditions&&usedRenditions[0]!=null){usedRenditions.forEach(function(id){renditions[id]=image.renditions[id]})}else{renditions=image.renditions}var sortedRenditionsArray=Object.values(renditions).sort(function(aRend,bRend){var a=aRend.size;var b=bRend.size;if(a.width===b.width){return a.height>b.height?-1:1}return a.width>b.width?-1:1}).reverse();selectedRendition=sortedRenditionsArray.find(function(rendition){return rendition.size.width>=computedSize.width&&rendition.size.height>=computedSize.height});if(!selectedRendition){selectedRendition=sortedRenditionsArray[sortedRenditionsArray.length-1]}}imageSrc=selectedRendition.src}return imageSrc}function getUsedRendition(imageSrc,renditions){if(renditions){var rendition=Object.values(renditions).find(function(rend){return rend.src===imageSrc});if(rendition){return{size:rendition.kraked_size,url:imageSrc}}}return null}function createImage(container,context,config){var document=container.getAdDocument();var el=document.createElement("div");el.setAttribute("role","img");var rendition;var activeConfig=context.getActiveConfig();if(config.dataSource&&config.dataSource.type==="conditionsTable"&&activeConfig.conditionsTable&&activeConfig.activeConditionsTableRow){var col=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.dataSource.property);if(col){config.image={src:col.value}}}return{domNode:el,onRender:function(){var styles=context.getElementStyles(config.id);if(!styles.image){styles.image={}}if(config.dataSource&&config.dataSource.type==="parentDataSource"){var source=findParentDataSource(config.id);if(source&&source.getDataByProperty){updateDataSource(source);source.onDataUpdated(function(){updateDataSource(source)})}return}var imageSrc=getImageSrc(config.image,styles.image.usedRenditions,styles.computedSize,context.adContent.export?rendition:null);rendition=getUsedRendition(imageSrc,config.image.renditions);setImage(url.toFullUrl(imageSrc,context.adContent))},getRendition:function(){return rendition}};function setImage(fullImageUrl){var styles=context.getElementStyles(config.id);var bgSize=dom.getBackgroundSize(styles.image.layout);var bgPosition;if(bgSize==="cover"&&styles.focalPoint){var img=new Image;img.src=fullImageUrl;var imageSize={width:img.naturalWidth,height:img.naturalHeight};if(imageSize.width===0&&imageSize.height===0){img.onload=function(){var imageSize={width:img.naturalWidth,height:img.naturalHeight};var elementSize={width:styles.computedSize.width.value,height:styles.computedSize.height.value};var pt=layout.calculateFocalPointOffset(styles.focalPoint,elementSize,imageSize);context.setElementStyles(config.id,{css:{backgroundPosition:pt.x+"px "+pt.y+"px"}})}}var elementSize={width:styles.computedSize.width.value,height:styles.computedSize.height.value};var pt=layout.calculateFocalPointOffset(styles.focalPoint,elementSize,imageSize);bgPosition=pt.x+"px "+pt.y+"px"}else{bgPosition=styles.image.position?styles.image.position.x+" "+styles.image.position.y:"center center"}context.setElementStyles(config.id,{css:{backgroundImage:"url("+fullImageUrl+")",backgroundPosition:bgPosition,backgroundSize:bgSize,backgroundRepeat:"no-repeat"}})}function findParentDataSource(elId){var p=context.getElementParent(elId);if(!p){return null}var s=p.getElementDataSource?p.getElementDataSource():null;if(s){return s}return findParentDataSource(p.id)}function updateDataSource(source){source.getDataByProperty(config.dataSource.property,function(err,value,data){setImage(value)})}}function createSVG(container,context,config){var el=createDiv(container,context,config);el.domNode.innerHTML=config.svgWidget.content;return el}function childrenAllowed(type,childType){return type===types.BACKGROUND_WIDGET||type===types.HTML5VIDEO_WIDGET||type===types.CAROUSEL_WIDGET&&childType===types.CAROUSEL_SLIDE_WIDGET||type===types.CAROUSEL_SLIDE_WIDGET||type===types.SOCIAL_GROUP_WIDGET&&childType===types.SOCIAL_ICON_WIDGET||type===types.SKIN_COMPARTMENT_WIDGET}module.exports={types:types,ruleToText:ruleToText,image:createImage,iframe:createIframe,div:createDiv,button:createButton,childrenAllowed:childrenAllowed,svg:createSVG}},{"./radical/conditionsTable":25,"./radical/dom":32,"./radical/elements/createShrinkableText":37,"./radical/layout":64,"./radical/url":79}],7:[function(require,module,exports){var adContentLoader=require("./radical/adContentLoader");var assetLoader=require("./radical/assetLoader");var dom=require("./radical/dom");var config=require("./radical/config");var analytics=require("./radical/analytics");var events=require("./radical/events");var async=require("./radical/async");var browser=require("./radical/browser");var log=require("./radical/log");var advertisement=require("./radical/advertisement");var containerRenderer=require("./radical/containerRenderer");var metrics=require("./radical/metrics");var eventHandlers=require("./radical/eventHandlers");var interactions=require("./radical/interactions");var mraidHandler=require("./radical/mraid");var adformAnalytics=require("./radical/adformAnalytics");var device=require("./radical/device");var mainEmitter=events.createEmitter();var ads=[];log.setErrorHandler(function(error,data){mainEmitter.emit("error",{message:error,data:data})});function initAd(command){if(command[0]=="5a52e69125cdd8d0240005ec"&&!command[1].imptt){analytics.sendPreImpression(command);command[1].imptt=true}var timer=metrics.createTimer();timer.logEvents();var adId=command[0];var givenOptions=command[1];if(givenOptions.mraid){var mraidLoaded=mraidHandler.initialize(document,givenOptions);if(!mraidLoaded){givenOptions.mraid=false}if(givenOptions.mraid&&givenOptions.appSizes){givenOptions.sizes=givenOptions.appSizes}}if(givenOptions.aft){adformAnalytics.setMacros({bn:givenOptions.afbn,creativeId:givenOptions.afci,impId:givenOptions.afimpi,cookieId:givenOptions.afcoi,rnd:givenOptions.afrnd})}var options=dom.merge({},givenOptions.export?config.export:givenOptions.https?config.https:config.http,{fallbackOptions:{minIE:10}},givenOptions);options.id=adId;timer.start("ad-content-load");adContentLoader.load(adId,options,radical.window.document,function(err,adContent){if(err||!adContent){throw err}timer.stop("ad-content-load");adContent.timer=timer;if(err){mainEmitter.emit("error",err);return}var container;var adObject;try{container=containerRenderer.render(radical.window,options);if(!container){console.warn("Container object is null, skip rendering creative with id: "+options.id);return}container.setRadicalApi(radical);adObject=advertisement.create(container,options,adContent);mainEmitter.emit("adCreated",adObject);adObject.start()}catch(err){mainEmitter.emit("error",err);throw err}eventHandlers.setup(adObject);var deviceProps=device.getDeviceProperties(radical.window);if(deviceProps.isChrome){analytics.attachReportingObserver(container,adObject)}if(!container.isCrossOrigin()){dom.addEventListener(container.getAdWindow().parent.document,"trb_unloadAd",function(){log.log("trb_unloadAd");container.remove()});var hidden,visibilityChange;if(typeof radical.window.document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange"}else if(typeof radical.window.document.msHidden!=="undefined"){hidden="msHidden";visibilityChange="msvisibilitychange"}else if(typeof radical.window.document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}if(hidden===undefined){console.log("Page Visibility API not supported.")}else if(!container.isCrossOrigin()){dom.addEventListener(container.getAdWindow().parent.document,visibilityChange,function(){if(container.getAdWindow().parent){events.emitGlobal("pagevisibility",container.getAdWindow().parent.document[hidden])}})}}if(!adObject.isAdContentAvailable()){adObject.onAdContentAvailable(doContentRelatedSetup)}else{doContentRelatedSetup()}function doContentRelatedSetup(){var mergedContent=adObject.getMergedContent();analytics.initializeTrackingCookies(container,adObject);interactions.addListeners(adObject);analytics.trackVisibility(adObject);if(mergedContent.moat){analytics.loadMoat(container,mergedContent.moat)}}ads.push(adObject);adObject.onLoad(function(){analytics.createImpressionTrackers(container,adObject);mainEmitter.emit("adLoaded",adObject)});container.onResize(function(ev){mainEmitter.emit("event",{name:"resize",data:dom.merge(ev.size,{container:container})})});container.onPageScroll(function(ev){mainEmitter.emit("event",{name:"scroll",data:{scroll:{x:ev.x,y:ev.y},viewport:{width:ev.pageWidth,height:ev.pageHeight},container:container}})})})}function handleCommand(command){if(command[0]){initAd(command)}else if(command.cmd=="adContent"){adContentLoader.contentLoaded(command)}else{throw new Error("unknown command")}}var radical={window:null,push:function(){for(var i=0;i<arguments.length;i++){handleCommand(arguments[i])}},getAdByWindow:function(window){return ads.find(function(ad){return ad.getContainer().getAdWindow()===window})},addListener:function(listener){mainEmitter.addListener("event",listener)},onError:function(callback){mainEmitter.addListener("error",callback)},removeListener:function(listener){mainEmitter.removeListener("event",listener)},reset:function(){ads.length=0;mainEmitter.removeAllListeners()},onAdLoad:function(listener){mainEmitter.addListener("adLoaded",listener);return function(){mainEmitter.removeListener("adLoaded",listener)}},onAdCreated:function(listener){mainEmitter.addListener("adCreated",listener);return function(){mainEmitter.removeListener("adCreated",listener)}},pushAd:function(ad){ads.push(ad);eventHandlers.setup(ad);eventHandlers.setUpAutoOpenClose(ad);interactions.addListeners(ad);var container=ad.getContainer();container.onResize(function(ev){mainEmitter.emit("event",{name:"resize",data:dom.merge(ev.size,{container:container})})})},createLightBoxOpenContainer:function(windowObj,options,tagOptions,adContent,dimensions,customJsState,uuid,lbNro){var openStateContainer=containerRenderer.render(radical.window,options,true);var openStateAdObject=advertisement.create(openStateContainer,tagOptions,adContent,dimensions,customJsState,uuid,lbNro);mainEmitter.emit("adCreated",openStateAdObject);openStateAdObject.start();openStateAdObject.getExtension("lightbox");this.pushAd(openStateAdObject)}};module.exports=radical},{"./radical/adContentLoader":9,"./radical/adformAnalytics":11,"./radical/advertisement":13,"./radical/analytics":15,"./radical/assetLoader":21,"./radical/async":23,"./radical/browser":24,"./radical/config":26,"./radical/containerRenderer":28,"./radical/device":31,"./radical/dom":32,"./radical/eventHandlers":51,"./radical/events":52,"./radical/interactions":63,"./radical/log":65,"./radical/metrics":69,"./radical/mraid":70}],8:[function(require,module,exports){function ApiError(message){this.message=message;this.stack=(new Error).stack}ApiError.prototype=new Error;ApiError.prototype.name="ApiError";module.exports=ApiError},{}],9:[function(require,module,exports){var url=require("./url");function createUrl(adId,options){var filename=(options.deployment?"d-"+options.deployment:adId)+".js";var adSource=url.toFullUrl(options.adSource||"",options);return adSource+adId+"/"+filename}var loadCallbacks={};function runCallbacks(loadId,adLoadError,content){if(!loadCallbacks[loadId]){loadCallbacks[loadId]=[]}var callbacks=loadCallbacks[loadId].concat();loadCallbacks[loadId].length=0;callbacks.forEach(function(cb,index){try{if(index!=0){content=JSON.parse(JSON.stringify(content))}cb(adLoadError,content)}catch(err){adLoadError=err}});if(adLoadError){throw adLoadError}}function generateLoadId(adId,deployId){return deployId?adId+"-"+deployId:adId}module.exports={load:function(adId,options,document,callback){var script=document.createElement("script");var loadId=generateLoadId(adId,options.deployment);script.onerror=function(ev){var err=new Error("radical/adContentLoader error loading ad "+adId);err.data={code:"ad_content_load_error",error:ev};runCallbacks(loadId,err)};if(options.inEditor||options.screenshot||options.preview){var cachebuster="cb="+(new Date).getTime();script.src=createUrl(adId,options)+"?"+cachebuster}else{script.src=createUrl(adId,options)}script.className="ad-content";if(!loadCallbacks[loadId]){loadCallbacks[loadId]=[]}loadCallbacks[loadId].push(callback);document.body.appendChild(script)},contentLoaded:function(content){runCallbacks(generateLoadId(content.id,content.deployment),null,content)}}},{"./url":79}],10:[function(require,module,exports){var dom=require("./dom");var element=require("../element");var youtubeElement=require("./elements/youtube");var html5video=require("./elements/html5video");var customControl=require("./elements/customControl");var imageButton=require("./elements/imageButton");var carousel=require("./elements/carousel");var twitterFeed=require("./elements/twitterFeed");var twitterTimeline=require("./elements/twitterTimeline");var skinWidget=require("./elements/skinWidget");var textbox=require("./elements/textbox");var vimeovideo=require("./elements/vimeovideo");var brightcove=require("./elements/brightcove");var omnivirt=require("./elements/omnivirt");var image360=require("./elements/image360");var adsonicaComponent=require("./elements/adsonicaComponent");const seekbar=require("./elements/seekbar");const countdown=require("./elements/countdown");const playinWidget=require("./elements/playinWidget");var url=require("./url");var events=require("./events");var log=require("./log");var device=require("./device");const fonts=require("./fonts");var elementBuilders={};elementBuilders[element.types.IMAGE]=element.image;elementBuilders[element.types.TEXTBOX_WIDGET]=textbox.create;elementBuilders[element.types.IFRAME_WIDGET]=element.iframe;elementBuilders[element.types.BACKGROUND_WIDGET]=element.div;elementBuilders[element.types.BUTTON_WIDGET]=element.button;elementBuilders[element.types.YOUTUBE_WIDGET]=youtubeElement.create;elementBuilders[element.types.HTML5VIDEO_WIDGET]=html5video.create;elementBuilders[element.types.CUSTOM_PLAY_MUTE_RESTART_CONTROL]=customControl.create;elementBuilders[element.types.CUSTOM_CLICKTHROUGH_CONTROL]=customControl.create;elementBuilders[element.types.IMAGE_BUTTON_WIDGET]=imageButton.create;elementBuilders[element.types.CAROUSEL_WIDGET]=carousel.create;elementBuilders[element.types.CAROUSEL_SLIDE_WIDGET]=carousel.createSlide;elementBuilders[element.types.TWITTER_FEED_WIDGET]=twitterFeed.create;elementBuilders[element.types.TWITTER_TIMELINE_WIDGET]=twitterTimeline.create;elementBuilders[element.types.SKIN_WIDGET]=skinWidget.create;elementBuilders[element.types.SKIN_COMPARTMENT_WIDGET]=skinWidget.createCompartment;elementBuilders[element.types.SVG_WIDGET]=element.svg;elementBuilders[element.types.VIMEO_WIDGET]=vimeovideo.create;elementBuilders[element.types.BRIGHTCOVE_WIDGET]=brightcove.create;elementBuilders[element.types.OMNIVIRT]=omnivirt.create;elementBuilders[element.types.IMAGE360]=image360.create;elementBuilders[element.types.ADSONICA_COMPONENT]=adsonicaComponent.create;elementBuilders[element.types.SEEKBAR]=seekbar.create;elementBuilders[element.types.COUNTDOWN]=countdown.create;elementBuilders[element.types.PLAYIN_WIDGET]=playinWidget.create;elementBuilders[element.types.SOCIAL_ICON_WIDGET]=element.image;elementBuilders[element.types.SOCIAL_GROUP_WIDGET]=element.div;function elementFactory(container,context,id,elementProps){var builder=elementBuilders[elementProps.type];if(!builder){throw new Error("Unsupported element type `"+elementProps.type+"` for ID "+id)}var el=builder(container,context,Object.assign({id:id},elementProps));el.domNode.id=id;el.id=id;el.type=elementProps.type;dom.addClass(el.domNode,"rad-element");if(elementProps.ariaLabel){el.domNode.setAttribute("aria-label",elementProps.ariaLabel)}var hasClickAction=elementProps.onClick&&elementProps.onClick.length>0;if(hasClickAction){dom.addClass(el.domNode,"is-clickable");elementProps.onClick.map(function(action){if(action.action==="clickthrough"&&action.data&&action.data.url==="$default_url"){var actConfig=context.getActiveConfig();if(actConfig.clickthroughUrl){action.data.url=actConfig.clickthroughUrl}}})}return el}function ensurePixels(value,comparison){if(value.unit==="px"){return value}return{unit:"px",value:value.value/100*comparison}}function normalizeCSSPropertyName(name){return name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function applyFonts(rules,el,styles){var f=styles.fontSettings;if(!f){return}Object.assign(rules,fonts.fontSettingsToCSSProperties(f))}module.exports={create:function(container,runtimeContext){var emitter=events.createEmitter();runtimeContext.getElementById=function(id){return elsInDom[id]};runtimeContext.getElementChildren=getElementChildren;runtimeContext.getVisibleElementChildren=getVisibleElementChildren;runtimeContext.getElementParent=getElementParent;runtimeContext.setElementStyles=function(elementId,styles){if(!liveStyles[elementId]){log.log("Could not set styles for element #"+elementId+".");return}dom.merge(liveStyles[elementId],styles);liveStyles[elementId].computedSize=computeActualSize(container,elementId,liveStyles[elementId]);if(elsInDom[elementId]){applyElementStyles(container,elsInDom[elementId],liveStyles[elementId],this.adContent);renderTree(elementId)}};runtimeContext.renderTree=renderTree;runtimeContext.getElementStyles=function(elementId){var styles=liveStyles[elementId];if(!styles){throw new Error("Unknown element ID is given or live styles are not ready")}if(styles.useDOMValuesForSizeCalculation){styles.width={value:runtimeContext.getElementById(elementId).domNode.offsetWidth,unit:"px"};styles.height={value:runtimeContext.getElementById(elementId).domNode.offsetHeight,unit:"px"};styles.x={value:runtimeContext.getElementById(elementId).domNode.offsetLeft,unit:"px"};styles.y={value:runtimeContext.getElementById(elementId).domNode.offsetTop,unit:"px"}}return styles};runtimeContext.isElementInLiveStyles=function(elementId){return liveStyles[elementId]?true:false};runtimeContext.clearElements=deleteStylesAndParentsData;var wrapper;var elsInDom={};var parentIds={};var liveStyles={};var previouslyRenderedSize;var runtimeStyles={};function renderTree(root){runtimeContext.getElementChildren(root).forEach(function(childEl){renderElement(childEl.id,childEl,liveStyles[childEl.id]);renderTree(childEl.id)})}return{canBeToggled:canBeToggled,renderSize:renderSize,clear:clear,getElementById:function(id){return elsInDom[id]},getElementStyles:function(id){return liveStyles[id]},renderElement:function(elId,defs,styles){const isNew=!elsInDom[elId];const el=renderElement(elId,defs,styles);renderTree(elId);if(isNew&&el.rendered){el.rendered()}},updateElementStyles:updateElementStyles,getDynamicSize:getDynamicSize,getParentSize:getParentSize,calculateDimensions:calculateDimensions,clearElements:deleteStylesAndParentsData,updateCustomJs:updateCustomJs,updateCustomCSS:updateCustomCSS,onBeforeRender:function(callback){emitter.addListener("beforeRender",callback)},getElementChildren:getElementChildren,areAncestorsVisible:areAncestorsVisible,getVisibleElementChildren:getVisibleElementChildren};function clear(){if(wrapper){wrapper.innerHTML=""}Object.keys(elsInDom).forEach(function(elId){destroyElement(elsInDom[elId])});elsInDom={};parentIds={};liveStyles={}}function canBeToggled(elementId,elementDefs,elementStyles){if(runtimeContext&&runtimeContext.getMergedContent&&runtimeContext.getMergedContent().formatProperties&&runtimeContext.getMergedContent().formatProperties.preventRenderingIfInActionList){return false}var toggleable=Object.keys(elementDefs).some(function(defsId){var defs=elementDefs[defsId];var hasClickAction=false;var hasHoverAction=false;var hasInOut=false;var hasVideoPlay=false;var hasVideoPause=false;var hasVideoEnd=false;var hasPreviewVideoEnd=false;var hasPreviewVideoStart=false;var hasVideoMuted=false;var hasVideoUnMuted=false;var hasMediaPlaying=false;var hasMediaPause=false;var hasMediaEnded=false;var hasOnVideoTimeReached=false;var hasOnCreativeRender=false;if(defs.onClick){hasClickAction=defs.onClick.some(function(a){return isToggleTarget(elementId,a)})}if(!hasClickAction&&defs.type==="image360"){var actions=[];defs.image360.scenes.forEach(function(scene){scene.hotspots.forEach(function(hotspot){hotspot.clickActions.forEach(function(action){actions.push(action)})})});hasClickAction=actions.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onHover){hasHoverAction=defs.onHover.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onMouseInOut){hasInOut=defs.onMouseInOut.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoPlay){hasVideoPlay=defs.onVideoPlay.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoPause){hasVideoPause=defs.onVideoPause.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoEnd){hasVideoEnd=defs.onVideoEnd.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoMuted){hasVideoMuted=defs.onVideoMuted.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoUnMuted){hasVideoUnMuted=defs.onVideoUnMuted.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onPreviewVideoEnd){hasPreviewVideoEnd=defs.onPreviewVideoEnd.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onPreviewVideoStart){hasPreviewVideoStart=defs.onPreviewVideoStart.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onMediaPlaying){hasMediaPlaying=defs.onMediaPlaying.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onMediaPause){hasMediaPause=defs.onMediaPause.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onMediaEnded){hasMediaEnded=defs.onMediaEnded.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onVideoTimeReached){hasOnVideoTimeReached=defs.onVideoTimeReached.some(function(a){return isToggleTarget(elementId,a)})}if(defs.onCreativeRender){hasOnCreativeRender=defs.onCreativeRender.some(function(a){return isToggleTarget(elementId,a)})}if(defs.elementEvents){for(let evName in defs.elementEvents){const hasToggle=defs.elementEvents[evName].some(function(a){return isToggleTarget(elementId,a)});if(hasToggle){return true}}}return hasClickAction||hasHoverAction||hasInOut||hasVideoPlay||hasVideoPause||hasVideoEnd||hasPreviewVideoEnd||hasPreviewVideoStart||hasVideoMuted||hasVideoUnMuted||hasMediaPlaying||hasMediaPause||hasMediaEnded||hasOnVideoTimeReached||hasOnCreativeRender});var parentToggleable=elementStyles[elementId].parentId&&canBeToggled(elementStyles[elementId].parentId,elementDefs,elementStyles);return toggleable&&parentsVisible(elementId,elementDefs,elementStyles)||parentToggleable}function isToggleTarget(elementId,action){const isToggle=action.action==="toggleElement"&&action.data&&action.data.targetElementId===elementId;const isMicroAnimation=action.action==="microanimation"&&action.data&&action.data.targetElementId===elementId;return isToggle||isMicroAnimation}function parentsVisible(elId,elementDefs,elementStyles){var parentId=elementStyles[elId].parentId;if(!parentId){return true}return runtimeContext.animationTimeline.hasKeyframes(parentId)||elementStyles[parentId].visible&&parentsVisible(parentId,elementDefs,elementStyles)}function destroyElement(el){if(el.destroy){el.destroy()}}function renderSize(elementDefs,elementStyles,renderedSize,containerSize){if(!wrapper){renderWrapper()}wrapper.style.height=containerSize.height+"px";if(runtimeContext.adContent.renderHiddenElements){runtimeStyles={}}else{Object.keys(runtimeStyles).forEach(function(elId){if(elementDefs[elId].keepVisibilityBetweenResize){runtimeStyles[elId]={visible:runtimeStyles[elId].visible};return}delete runtimeStyles[elId]})}emitter.emit("beforeRender",{elementDefs:elementDefs,elementStyles:elementStyles});var layoutChanged=previouslyRenderedSize&&(previouslyRenderedSize.width!==renderedSize.width||previouslyRenderedSize.height!==renderedSize.height);previouslyRenderedSize=renderedSize;var newElements=renderNewElements();newElements.forEach(function(el){if(el.rendered){el.rendered()}});Object.keys(elsInDom).forEach(function(elId){var el=elsInDom[elId];if(el.updated){el.updated()}});function renderNewElements(elementIdsToConsiderForRendering,previouslyRenderedIds){if(!previouslyRenderedIds){previouslyRenderedIds=[]}var elementIdsBeforeRender=Object.keys(elementStyles);if(!elementIdsToConsiderForRendering){elementIdsToConsiderForRendering=elementIdsBeforeRender}var elIdsToRender=elementIdsToConsiderForRendering.filter(function(elId){var elParentsAreVisible=parentsVisible(elId,elementDefs,elementStyles);return runtimeContext.adContent.renderHiddenElements||elementStyles[elId].visible&&elParentsAreVisible||canBeToggled(elId,elementDefs,elementStyles)});var domElIds=Object.keys(elsInDom);domElIds.forEach(function(id){if(elIdsToRender.indexOf(id)===-1&&previouslyRenderedIds.indexOf(id)===-1){var el=elsInDom[id];delete elsInDom[id];destroyElement(el);el.domNode.parentNode.removeChild(el.domNode)}});liveStyles=Object.assign({},elementStyles);var sortedElIds=sortByRenderOrder(elIdsToRender,elementStyles);var newElements=sortedElIds.map(function(elId){var el=renderElement(elId,elementDefs[elId],Object.assign({},liveStyles[elId],runtimeStyles[elId]),layoutChanged);return el}).filter(Boolean);var elementIdsAfterRender=Object.keys(elementStyles);if(elementIdsAfterRender.length!==elementIdsBeforeRender.length){var newElementIds=elementIdsAfterRender.filter(function(possiblyNewId){return elementIdsBeforeRender.indexOf(possiblyNewId)===-1});return newElements.concat(renderNewElements(newElementIds,elIdsToRender))}return newElements}}function deleteStylesAndParentsData(elements){elements.forEach(function(elId){delete parentIds[elId];delete liveStyles[elId]})}function getElementChildren(id){var elIds=Object.keys(parentIds);var childIds=elIds.filter(function(elId){return parentIds[elId]===id});var children=[];childIds.forEach(function(childId){if(elsInDom[childId]){children.push(Object.assign({id:childId},elsInDom[childId]))}});return children}function getVisibleElementChildren(id){return runtimeContext.getElementChildren(id).filter(function(el){return runtimeContext.getElementStyles(el.id).visible})}function getElementParent(id){var parentId=liveStyles[id].parentId;if(!parentId){return null}return elsInDom[parentId]}function areAncestorsVisible(elId){if(!elId){return true}var styles=runtimeContext.getElementStyles(elId);if(!styles||styles.parentId){var parentStyle=runtimeContext.getElementStyles(styles.parentId);if(!parentStyle.visible){return false}return areAncestorsVisible(parentStyle.id)}return true}function renderElement(elId,defs,styles,fromSizeChange){var elementCreated=false;fromSizeChange=fromSizeChange||false;liveStyles[elId]=styles;liveStyles[elId].computedSize=computeActualSize(container,elId,styles);var el=elsInDom[elId];var parentEl=wrapper;var parentId=liveStyles[elId].parentId;if(parentId){var p=elsInDom[parentId];if(!p){console.log("Possible incorrect renderElement call");return}parentEl=p.childRoot||p.domNode}if(!el){el=elementFactory(container,runtimeContext,elId,defs);elementCreated=true;parentEl.appendChild(el.domNode);elsInDom[elId]=el}else if((liveStyles[elId].parentId||"")!==(parentIds[elId]||"")){parentEl.appendChild(el.domNode)}parentIds[elId]=!liveStyles[elId].parentId?undefined:liveStyles[elId].parentId;let overrideDisplay;if(!container.getAdOptions().inEditor&&defs.onCreativeRender&&defs.onCreativeRender.length>=1&&el.domNode.style.display==="none"){overrideDisplay="none"}applyElementStyles(container,el,liveStyles[elId],runtimeContext.adContent,overrideDisplay);if(el.onRender){el.onRender(elId,defs,styles,elementCreated,fromSizeChange)}if(elementCreated){return el}}function computeActualSize(container,elId,styles){if(!styles.width||!styles.height){return null}var parentStyles=liveStyles[styles.parentId];var parentSizeValue;if(parentStyles){if(parentStyles.computedSize){parentSizeValue={height:parentStyles.computedSize.height.value,width:parentStyles.computedSize.width.value}}else{parentSizeValue=null}}else{parentSizeValue=container.getAdSize()}if(!parentSizeValue){return null}var size=calculateDimensions(styles,parentSizeValue);return size}function sortByRenderOrder(elIds,styles){return elIds.concat().sort(function(a,b){return styles[a].zIndex>styles[b].zIndex?-1:1})}function updateCustomJs(jsString){var head=container.getAdDocument().getElementsByTagName("head")[0];var scriptElement=container.getAdDocument().getElementById("rad-customjs");if(scriptElement){scriptElement.parentElement.removeChild(scriptElement)}var customJs=dom.createScript(container.getAdDocument(),jsString);customJs.id="rad-customjs";head.appendChild(customJs)}function updateCustomCSS(cssString,cssId){if(!cssId){cssId="rad-customcss"}var head=container.getAdDocument().getElementsByTagName("head")[0];var styleElement=container.getAdDocument().getElementById(cssId);if(styleElement){styleElement.parentElement.removeChild(styleElement)}var customCss=dom.createStylesheet(container.getAdDocument(),cssString);customCss.id=cssId;head.appendChild(customCss)}function renderWrapper(){var document=container.getAdDocument();wrapper=document.createElement("div");wrapper.style.position="absolute";wrapper.style.overflow="hidden";wrapper.style.top=0;wrapper.style.left=0;wrapper.style.right=0;wrapper.className="rad-creative-content";if(container.getAdOptions().ntvc){var flexFrame=document.querySelector("#flex-frame-wrapper");if(flexFrame){flexFrame.appendChild(wrapper)}else{document.body.appendChild(wrapper)}}else{var gave=document.querySelector(".GoogleActiveViewElement");if(gave){gave.appendChild(wrapper)}else{document.body.appendChild(wrapper)}}updateCustomCSS(runtimeContext.adContent.activeConfig.customcss);updateCustomJs(runtimeContext.adContent.activeConfig.customjs);if(runtimeContext.adContent.activeConfig.clickthroughUrl||runtimeContext.adContent.export){dom.addClass(document.body,"is-clickable")}}function getParentSize(styles){var parentSize=container.getContentDimensions();if(!styles.parentId){return parentSize}var parentStyles=liveStyles[styles.parentId];if(!parentStyles){throw new Error("Parent not rendered before child. This should not normally happen")}if(parentStyles.useDOMValuesForSizeCalculation){return{width:runtimeContext.getElementById(styles.parentId).domNode.offsetWidth,height:runtimeContext.getElementById(styles.parentId).domNode.offsetHeight,x:runtimeContext.getElementById(styles.parentId).domNode.offsetLeft,y:runtimeContext.getElementById(styles.parentId).domNode.offsetTop}}else{if(parentStyles.parentId){parentSize=getParentSize(parentStyles)}var realSize=calculateDimensions(parentStyles,parentSize);return{width:ensurePixels(realSize.width,parentSize.width).value,height:ensurePixels(realSize.height,parentSize.height).value}}}function calculateDimensions(styles,parentSize){function fixValue(v,c){if(v.value==="auto"){return Object.assign({},v)}return ensurePixels(v,c)}var size={width:fixValue(styles.width,parentSize.width),height:fixValue(styles.height,parentSize.height)};var aspectRatio=1;if(styles.maxWidth&&styles.maxHeight){aspectRatio=styles.maxWidth.value/styles.maxHeight.value}if(size.width.value==="auto"){size.width.value=size.height.value*aspectRatio;size.width.unit=size.height.unit}if(size.height.value==="auto"){size.height.value=size.width.value/aspectRatio;size.height.unit=size.width.unit}return size}function getDynamicSize(styles,side){var targetSide="width";if(side==="width"){targetSide="height"}if(styles.maxWidth.unit!=="px"||styles.maxHeight.unit!=="px"){throw new Error("maxWidth and maxHeight should always be in pixels when proportions are locked")}var aspectRatio=styles.maxWidth.value/styles.maxHeight.value;var realSize=getParentSize(styles);var adjusted=ensurePixels(styles[targetSide],realSize[targetSide]).value;var result;if(targetSide==="width"){result=adjusted/aspectRatio+"px"}else{result=adjusted*aspectRatio+"px"}return result}function getSizeCSSRules(styles,layoutMode){var cssRules={width:dom.vuToString(styles.width),height:dom.vuToString(styles.height)};if(layoutMode==="flexbox-vertical"){}if(styles.lockProportions&&styles.maxWidth&&styles.maxHeight){if(styles.height.value==="auto"){cssRules.height=getDynamicSize(styles,"height")}else{cssRules.width=getDynamicSize(styles,"width")}}if(styles.autoHeight){cssRules.height="auto"}return cssRules}function getOppositeSide(side){var opposite={left:"right",right:"left",top:"bottom",bottom:"top",center:"center"};return opposite[side]}function getPositionCSSRules(styles,layoutMode){if(layoutMode==="flexbox"||layoutMode==="flexbox-vertical"){return{position:"relative",order:-styles.zIndex,"flex-shrink":layoutMode==="flexbox-vertical"?0:1}}if(layoutMode==="flexbox-vertical"){return{position:"static"}}var cssRules={};var xTransition="0%";var yTransition="0%";if(styles.constrainSize){cssRules["max-width"]=dom.vuToString(styles.maxWidth);cssRules["max-height"]=dom.vuToString(styles.maxHeight)}if(styles.anchor.x!=="center"){cssRules[styles.anchor.x]=dom.vuToString(styles.x);cssRules[getOppositeSide(styles.anchor.x)]="";cssRules["margin-left"]="";cssRules["margin-right"]=""}else{cssRules["margin-right"]="-50%";cssRules.left="50%";xTransition="-50%"}if(styles.anchor.y!=="center"){cssRules[styles.anchor.y]=dom.vuToString(styles.y);cssRules[getOppositeSide(styles.anchor.y)]="";cssRules["margin-top"]="";cssRules["margin-bottom"]=""}else{cssRules.top="50%";yTransition="-50%"}const rotation=(styles.rotation||0)+"deg";if(xTransition!=="0%"||yTransition!=="0%"||styles.rotation>0||styles.rotation<0){cssRules.transform="translate("+xTransition+", "+yTransition+") rotate("+rotation+")"}cssRules["--initial-transform-y"]=yTransition;cssRules["--initial-transform-x"]=xTransition;cssRules["--initial-rotate"]=rotation;return cssRules}function getPaddingCSSRules(wholeStyles){var cssRules={};var styles=wholeStyles.buttonWidget;if(!styles){return null}["Top","Right","Bottom","Left"].forEach(function(direction){var key="padding"+direction;var value=styles[key];if(!value){return}var vertical=direction==="Top"||direction==="Bottom";var sValue=calculateCSSValue(wholeStyles,value,vertical);var name="padding-"+direction.toLowerCase();cssRules[name]=sValue});return cssRules}function getBorderCSSRules(styles){var cssRules={};if(styles.borderRadius){cssRules["border-radius"]=calculateCSSValue(styles,styles.borderRadius,false)}if(styles.borderWidth){cssRules["border-width"]=calculateCSSValue(styles,styles.borderWidth,false)}return cssRules}function getBoxShadowCSSRules(styles){var boxShadow=styles.boxShadow;if(!boxShadow){return{}}var shadowValues=[calculateCSSValue(styles,boxShadow.offsetX,false),calculateCSSValue(styles,boxShadow.offsetY,false),calculateCSSValue(styles,boxShadow.blur,false),calculateCSSValue(styles,boxShadow.spread,false)];var c=boxShadow.color.rgba;shadowValues.push("rgba("+[c[0],c[1],c[2],c[3]].join(", ")+")");var cssRules={"box-shadow":shadowValues.join(" ")};return cssRules}function calculateCSSValue(styles,vu,vertical){var cssValue;if(!vu||!styles.computedSize){cssValue=undefined}else if(vu.unit==="%"){var side=vertical?styles.computedSize.height:styles.computedSize.width;cssValue=side.value*vu.value/100+"px"}else{cssValue=dom.vuToString(vu)}return cssValue}function updateElementStyles(elId,styles){runtimeStyles[elId]=Object.assign(runtimeStyles[elId]||{},styles);var el=elsInDom[elId];if(!el){log.log("Could not update styles for element #"+elId+".");return}liveStyles[el.id]=Object.assign({},liveStyles[el.id],runtimeStyles[el.id]);applyElementStyles(container,el,liveStyles[elId],runtimeContext.adContent);updateShrinkElement(el)}function updateShrinkElement(el){if("updateShrink"in el){el.updateShrink();return}var children=getElementChildren(el.id);children.forEach(function(child){updateShrinkElement(child)})}function getLayoutMode(elId){var parentId=liveStyles[elId].parentId;if(!parentId){return""}return liveStyles[parentId].layoutMode}function applyElementStyles(container,el,styles,adContent,display){var cssRules={"z-index":styles.zIndex,"box-sizing":"border-box"};if(!display){if(!styles.visible){display="none"}else if(styles.layoutMode==="flexbox"||styles.layoutMode==="flexbox-vertical"){display="flex"}else{display="block"}}cssRules.display=display;if(styles.layoutMode==="flexbox"){cssRules["flex-wrap"]="wrap";cssRules["align-content"]="flex-start";cssRules["justify-content"]="space-around"}else if(styles.layoutMode==="flexbox-vertical"){cssRules["flex-direction"]="column"}if("crop"in styles){cssRules.overflow=styles.crop?"hidden":"visible"}if(styles.scrollable){cssRules.overflow="auto"}if(styles.opacity===0||styles.opacity){cssRules.opacity=styles.opacity}dom.merge(cssRules,getSizeCSSRules(styles,getLayoutMode(el.domNode.id)),getPositionCSSRules(styles,getLayoutMode(el.domNode.id)),getPaddingCSSRules(styles),getBorderCSSRules(styles),getBoxShadowCSSRules(styles));if(styles.css){for(var k in styles.css){if(k==="background"&&/url\(.+\)/.test(styles.css[k])){var fixedUrl=styles.css[k].replace(/url\(['"]?(.+?)['"]?\)/,function(urlPart,partialUrl){return urlPart.replace(partialUrl,url.toFullUrl(partialUrl,adContent))});cssRules[normalizeCSSPropertyName(k)]=fixedUrl}else{cssRules[normalizeCSSPropertyName(k)]=styles.css[k]}}}if(styles.fit){var bgPosition=styles.fit.position?styles.fit.position.x+" "+styles.fit.position.y:"center center";cssRules["background-size"]=dom.getBackgroundSize(styles.fit.layout);cssRules["background-position"]=bgPosition}var hoverStyles={};if(styles.hover&&styles.hover.css){hoverStyles=styles.hover.css}applySpecialStyles(container,el.domNode.id,hoverStyles,"hover");var activeStyles={};if(styles.active&&styles.active.css){activeStyles=styles.active.css}applySpecialStyles(container,el.domNode.id,activeStyles,"active");applyFonts(cssRules,el,styles);dom.replaceInlineStyles(el.domNode,cssRules)}function applySpecialStyles(container,elId,declarations,pseudoSelectorName){var propNames=Object.keys(declarations);var name=elId+pseudoSelectorName;if(propNames.length===0){container.removeNamedCSS(name);return}var declStrs=propNames.map(function(prop){var normalizedProp=normalizeCSSPropertyName(prop);return normalizedProp+": "+declarations[prop]+" !important"}).join(";");var ruleStr="#"+elId+":"+pseudoSelectorName+" {"+declStrs+"}";container.replaceNamedCSS(name,ruleStr)}}}},{"../element":6,"./device":31,"./dom":32,"./elements/adsonicaComponent":33,"./elements/brightcove":34,"./elements/carousel":35,"./elements/countdown":36,"./elements/customControl":38,"./elements/html5video":39,"./elements/image360":40,"./elements/imageButton":41,"./elements/omnivirt":42,"./elements/playinWidget":43,"./elements/seekbar":44,"./elements/skinWidget":45,"./elements/textbox":46,"./elements/twitterFeed":47,"./elements/twitterTimeline":48,"./elements/vimeovideo":49,"./elements/youtube":50,"./events":52,"./fonts":59,"./log":65,"./url":79}],11:[function(require,module,exports){var initTime=0;var adformTrackingURL="https://track.adform.net/Serving/Event/?bn=__bn__&event=__eventId__&time=__time__&baid=__creativeId__&name=__eventName__&imprid=__impId__&icid=__cookieId__&rnd=__rnd__";module.exports={sendEvent:function(eventId,eventName){var eventURL=adformTrackingURL;var eventTime=(new Date).getTime();var time=Math.round((eventTime-initTime)/1e3);eventURL=eventURL.replace(/__eventId__/g,String(eventId)).replace(/__time__/g,String(time)).replace(/__eventName__/g,eventName);if(eventURL.indexOf("__")===-1&&eventURL.indexOf("%%")===-1){var adFormEvent=new Image;adFormEvent.src=eventURL}},setMacros:function(macros){initTime=(new Date).getTime();adformTrackingURL=adformTrackingURL.replace(/__bn__/g,macros["bn"]).replace(/__creativeId__/g,macros["creativeId"]).replace(/__impId__/g,macros["impId"]).replace(/__cookieId__/g,macros["cookieId"]).replace(/__rnd__/g,macros["rnd"])}}},{}],12:[function(require,module,exports){(function(Buffer){(function(){const config=require("./config");const libUrlPublic=config.https.adsonicaComponentExternalApi;const libUrlLocal=config.export.adsonicaComponentExternalApi;const noop=function(){};const eventTypes=["playing","pause","ended","timeupdate"];const loadScriptPromiseMap=new WeakMap;const unpackPromiseMap=new WeakMap;const playerStatusMap=new WeakMap;const taskQueueMap=new WeakMap;const listenerMap=new WeakMap;class ElementGoneError extends Error{constructor(){super("Element gone")}}module.exports={initializeAdsonica(elImage){const w=getWindowOf(elImage);return enqueueTask(w,function(){return prepare(elImage).catch(function(error){if(error instanceof ElementGoneError){return}throw error})})},playAdsonica(elImage){const w=getWindowOf(elImage);return enqueueTask(w,function(){return prepare(elImage).then(function(){const status=getPlayerStatus(w);if(status.playingImage===elImage&&status.state==="paused"){w.adsonicaPauseAudio(elImage,noop);return}let p=Promise.resolve();if(status.playingImage!==elImage&&status.state!=="ended"){p=stopNicely(w,status.playingImage).then(function(){updatePlayerStatus(w,{currentTime:0,playingImage:null,state:"ended"})})}return p.then(function(){w.adsonicaPlayAudio(elImage,function(){updatePlayerStatus(w,{currentTime:0,playingImage:null,state:"ended"});const timeupdateData=createEmitData("timeupdate",elImage);emit({...timeupdateData,currentTime:timeupdateData.duration})});return waitUntil(()=>w.adsonicaIsBufferReady())})}).then(function(){updatePlayerStatus(w,{playingImage:elImage,state:"playing"})})})},pauseAdsonica(elImage){const w=getWindowOf(elImage);return enqueueTask(w,function(){return prepare(elImage).then(function(){const w=getWindowOf(elImage);const status=getPlayerStatus(w);if(status.playingImage!==elImage||status.state!=="playing"){return}w.adsonicaPauseAudio(elImage,noop);updatePlayerStatus(w,{state:"paused"})})})},stopAdsonica(elImage){const w=getWindowOf(elImage);if(!unpackPromiseMap.has(elImage)){return Promise.resolve()}return enqueueTask(w,function(){return prepare(elImage).then(function(){const status=getPlayerStatus(w);if(status.playingImage!==elImage){return}return stopNicely(w,elImage).then(function(){updatePlayerStatus(w,{playingImage:null,state:"ended"})})})})},stepAdsonica(elImage,seconds){const w=getWindowOf(elImage);const status=getPlayerStatus(w);if(status.playingImage!==elImage||status.state!=="playing"){return Promise.resolve()}return enqueueTask(w,function(){return prepare(elImage).then(function(){w.adsonicaStepAudio(elImage,seconds,function(currentTime){})})})},isPlayingAdsonica(elImage){const w=getWindowOf(elImage);const status=getPlayerStatus(w);if(status.playingImage!==elImage){return false}const playing=status.state==="playing";return playing},on(elImage,type,listener){if(!eventTypes.includes(type)){throw new Error(`[Rad:adsonicaLib] Unknown event type "${type}". It must be one of: ${eventTypes}`)}if(!listenerMap.has(elImage)){const listeners={ended:[],pause:[],playing:[],timeupdate:[]};listenerMap.set(elImage,listeners)}const allListeners=listenerMap.get(elImage);if(!allListeners){throw new Error("[bug]")}const set=allListeners[type];set.push(listener);return function(){const index=set.indexOf(listener);if(index<0){return}set.splice(index,1)}}};function enqueueTask(w,task){const pLastTask=taskQueueMap.get(w)||Promise.resolve();const pNextTask=pLastTask.then(function(){return task()});taskQueueMap.set(w,pNextTask);return pNextTask}function prepare(elImage){const existingPromise=unpackPromiseMap.get(elImage);if(existingPromise){return existingPromise}const w=getWindowOf(elImage);const currentPromise=prepareAdsonicaLib(w).then(function(){return prepareAdsonicaImage(elImage)});unpackPromiseMap.set(elImage,currentPromise);return currentPromise}function prepareAdsonicaLib(w){return loadAdsonicaComponentApi(w).then(function(){return sleep(100)})}function loadAdsonicaComponentApi(w){const existingPromise=loadScriptPromiseMap.get(w);if(existingPromise){return existingPromise}const url=isRadicalExported(w)?libUrlLocal:libUrlPublic;const currentPromise=new Promise(function(resolve,reject){var el=w.document.createElement("script");el.onload=function(){w.adsonicaAudioInit();resolve()};el.onerror=function(){reject(new Error("Failed to load: "+url))};el.src=url;w.document.head.appendChild(el)});loadScriptPromiseMap.set(w,currentPromise);return currentPromise}function isRadicalExported(w){const Radical=w.Radical;if(!Radical){return false}return Radical.getAdByWindow(w).getAdTagOptions().export||false}function prepareAdsonicaImage(elImage){if(!elImage.id){elImage.id="rad-adsonicaImage-"+Math.random().toFixed(32).slice(2)}if(!isAvailableElement(elImage)){return Promise.reject(new ElementGoneError)}return fetchImageBuffer(elImage).then(function(buf){elImage.src=URL.createObjectURL(new Blob([buf]));var w=getWindowOf(elImage);w.adsonicaUnpack(new Int8Array(buf),elImage.id,"",elImage.id+"_play","",0,0,true);return waitUntil(()=>w.adsonicaIsUnpackerReady())})}function fetchImageBuffer(elImage){return new Promise(function(resolve,reject){const url=elImage.getAttribute("data-src")||elImage.src;if(!url){reject(new Error("Image URL required"));return}if(url.startsWith("data:")){const iDelimiter=url.indexOf(",");const prefix=url.slice(0,iDelimiter+1);if(!prefix.startsWith("data:image/")||!prefix.endsWith(";base64,")){reject(new Error("Unknown URL schema: "+url));return}const base64=url.slice(iDelimiter+1);const buffer=Buffer.from(base64,"base64");resolve(buffer);return}var cleanUrl=url+"?_="+String(Math.random());var xhr=new XMLHttpRequest;xhr.responseType="arraybuffer";xhr.open("GET",cleanUrl);xhr.onload=function(){var buf=xhr.response;resolve(buf)};xhr.onerror=function(){reject(new Error("Failed to fetch: "+cleanUrl))};xhr.send()})}function getPlayerStatus(w){const status=playerStatusMap.get(w);if(status){return status}const tmTimeUpdate=startTimeUpdateObserver(w);const newStatus={currentTime:0,duration:0,playingImage:null,state:"ended",tmTimeUpdate:tmTimeUpdate};playerStatusMap.set(w,newStatus);return newStatus}function updatePlayerStatus(w,status){const prevStatus=getPlayerStatus(w);const elPrevPlayingImage=prevStatus.playingImage;const newStatus=Object.assign({},prevStatus,status);playerStatusMap.set(w,newStatus);const state=newStatus.state;if(state!==prevStatus.state){if(state==="playing"){const elImage=newStatus.playingImage;if(!elImage){throw new Error("Attempting to play `null`")}emit(createEmitData("playing",elImage))}if(state==="paused"){const elImage=newStatus.playingImage;if(!elImage){throw new Error("Attempting to pause `null`")}emit(createEmitData("pause",elImage))}if(state==="ended"){if(!elPrevPlayingImage){throw new Error("Attempting to end `null`")}emit(createEmitData("ended",elPrevPlayingImage));emit(createEmitData("timeupdate",elPrevPlayingImage))}}if(newStatus.currentTime!==prevStatus.currentTime||newStatus.duration!==prevStatus.duration){const lastElImage=prevStatus.playingImage;if(lastElImage&&newStatus.playingImage!==lastElImage){var data=createEmitData("timeupdate",lastElImage);data.currentTime=0;emit(data)}if(newStatus.playingImage){emit(createEmitData("timeupdate",newStatus.playingImage))}}}function emit(data){const listeners=listenerMap.get(data.target);if(!listeners){return}for(const listener of Object.values(listeners[data.type])){listener(data)}}function createEmitData(type,elImage){var w=getWindowOf(elImage);var status=getPlayerStatus(w);const currentTime=Math.min(status.duration,status.currentTime);return{currentTime:currentTime,duration:status.duration,ended:status.state==="ended",paused:status.state==="paused",playing:status.state==="playing",target:elImage,type:type}}function stopNicely(w,elImage){return Promise.resolve().then(function(){const status=getPlayerStatus(w);const elPlayingImage=status.playingImage;if(!elImage||elImage!==elPlayingImage){return}if(status.state==="paused"){w.adsonicaPauseAudio(elImage,noop);w.adsonicaStopAudio(elImage)}else if(status.state==="playing"){w.adsonicaStopAudio(elImage)}const delay=100;return sleep(delay)})}function getWindowOf(el){var w=el.ownerDocument.defaultView;if(!w){throw new Error("Element must belong to a window. (Removed?)")}return w}function startTimeUpdateObserver(w){let lastKey="";let lastElImage=w.document.createElement("img");return w.setInterval(()=>{if(!w.adsonicaGetAudioTime){return}w.adsonicaGetAudioTime(function(duration,countdownTime,currentTime,percentListened){const key=duration+"-"+countdownTime+"-"+currentTime+"-"+percentListened;if(key===lastKey){return}lastKey=key;const status=getPlayerStatus(w);if(!status.playingImage){return}updatePlayerStatus(w,{currentTime:currentTime,duration:duration})})},1)}function isAvailableElement(el){const d=el.ownerDocument;if(!d.getElementById(el.id)){return false}var w=d.defaultView;if(!w){return false}return true}function sleep(ms){return new Promise(function(resolve){setTimeout(resolve,ms)})}function waitUntil(fn){return new Promise((resolve,reject)=>{const tm=window.setInterval(()=>{try{if(fn()){window.clearInterval(tm);resolve()}}catch(error){window.clearInterval(tm);reject(error)}},16)})}}).call(this)}).call(this,require("buffer").Buffer)},{"./config":26,buffer:2}],13:[function(require,module,exports){var dom=require("./dom");var analyticsSender=require("./analyticsSender");var analyticsCollector=require("./analyticsCollector");var events=require("./events");var parser=require("./parser");var adRenderer=require("./adRenderer");var fallbacks=require("./fallbacks");var mediaquery=require("./mediaquery");var assetResolver=require("./assetResolver");var assetLoader=require("./assetLoader");var flowlineLoader=require("./flowlineLoader");var log=require("./log");var async=require("./async");var animationTimeline=require("./animationTimeline");var device=require("./device");var eventHandlers=require("./eventHandlers.js");var messaging=require("./messaging");var uuid=require("./uuid");var metrics=require("./metrics");var adformAnalytics=require("./adformAnalytics");var user=require("./user");const tagParametersParser=require("./tagParametersParser");const cssCustomVariablesParse=require("./cssCustomVariablesParser");var storage;var expandv=require("./extensions/expandv");var lightbox=require("./extensions/lightbox");var lightboxNew=require("./extensions/lightboxNew");function getCurrentMediaquery(mqs,size,container,sizeList,adTagOptions,openStateDimensions,responsiveMode){mqs=mqs.filter(function(mq){return sizeList.length===0||sizeList.find(function(sz){return sz.width===mq.maxWidth.value&&sz.height===mq.maxHeight.value})});var mq;if(container&&container.getFlowline()&&!adTagOptions.isFluid&&!openStateDimensions){mq=mediaquery.findLargestFitting(mqs,size);if(!mq&&adTagOptions.fallbackToProportion){log.log("No possible sizes found for "+size.width+"x"+size.height+" out of ["+sizeList.join(",")+"]");log.log("Fallback to findBestAspectRatio");mq=mediaquery.findBestAspectRatio(mqs,size)}}else if(responsiveMode==="aspectRatioOnly"){mq=mediaquery.findBestByAspectRatio(mqs,size)}else{mq=mediaquery.findBestByAspectAndSize(mqs,size)}return mq}function forEachDescendants(mq,rootId,callback){var elements=mq.elements;Object.entries(elements).forEach(function(pair){var id=pair[0];var element=pair[1];if(element.parentId===rootId){callback(pair);forEachDescendants(mq,id,callback)}})}function findToggledElementFonts(mergedContent,mq){var elements=mergedContent.activeConfig.elements;var ids=[];Object.values(elements).forEach(function(element){Object.entries(element).forEach(function(pair){var key=pair[0];var isAction=/^on[A-Z]/.test(key);if(isAction){var actionOrActions=pair[1];var actions=Array.isArray(actionOrActions)?actionOrActions:[actionOrActions];if(actionOrActions&&actions){actions.forEach(function(action){if(action.data&&action.action==="toggleElement"){var id=action.data.targetElementId;if(id){ids.push(id)}}})}}})});ids.forEach(function(targetId){forEachDescendants(mq,targetId,function(pair){var id=pair[0];if(ids.indexOf(id)>=0){return}var element=pair[1];if("fontSettings"in element){ids.push(id)}})});var fonts=assetResolver.resolveFontsByElementIds(mq,ids);return fonts}var connectionSpeed=null;function create(container,adTagOptions,adContent,openStateDimensions,initialCustomJsState,UUID,lbnro){var activeFormatSize=null;var renderedSize=null;var containerAssetLoader;var initialLoadDone=false;var emitter=events.createEmitter();var isOpenStateAdObj=openStateDimensions;var customJsState=initialCustomJsState?initialCustomJsState:{};var lbNro;var creativeTimeSpentInactivity;var creativeTimeSpentActivityInterval;var creativeTimeSpentInViewInterval;var interActionRefreshDisabled;var store;if(!adTagOptions.applenews){storage=require("./storage");store=storage.open(container.getAdWindow(),adTagOptions)}if(UUID){uuid.creativeUUID=UUID}if(lbnro){lbNro=lbnro}messaging.init(container);if(adTagOptions.assetLoader){containerAssetLoader=adTagOptions.assetLoader.loaderForContainer(container)}else{containerAssetLoader=assetLoader.loaderForContainer(container)}var tagParameters=tagParametersParser.parse(adTagOptions.tagParameters||{});var userInfo=user.createUserInfo(container.getAdWindow(),tagParameters.location||{});var mergedContent;var context={sendAdformAnalyticsEvent:sendAdformAnalyticsEvent,sendAnalyticsEvent:sendAnalyticsEvent,adContent:null,getActiveConfig:function(){return mergedContent.activeConfig},getAnalyticsCollectData:getAnalyticsCollectData,getMergedContent:getMergedContent,updateCustomCSS:function(cssString){renderer.updateCustomCSS(cssString)},getOpenStateAdObj:getOpenStateAdObj,getAdObject:function(){return adObject}};var renderer=null;var responsiveMode=null;var adContentAvailable=false;function start(){parser.parseAdContent(adContent,adTagOptions,userInfo,function(err,parsedMergedContent){if(err){throw new Error(err)}mergedContent=parsedMergedContent;adContentAvailable=true;emitter.emit("adContentAvailable");responsiveMode=mergedContent.activeConfig.responsiveMode;if(openStateDimensions){mergedContent.sizes=[openStateDimensions].concat();mergedContent.timer=metrics.createTimer();mergedContent.timer.logEvents()}if(mergedContent.adVersion<10){var err=new Error("Attempting to load ad with version `"+mergedContent.adVersion+"`, this Radical version supports only v10 and newer");err.data={code:"bad_version",adVersion:mergedContent.adVersion,supportedVersion:10,adContent:adContent};throw err}var ie=dom.getIEInfo(container.getAdWindow());mergedContent.fallbacksEnabled=adTagOptions.fallbacks&&ie&&ie.version<adTagOptions.fallbackOptions.minIE;context.adContent=mergedContent;renderer=adRenderer.create(container,context);if(ie&&mergedContent.hideAd&&ie.version<=mergedContent.hideAd.minIE){container.remove();return}if(mergedContent.fallbacksEnabled){fallbacks.replaceContent(mergedContent)}var deviceProps=device.getDeviceProperties(container.getAdWindow());if(deviceProps.probablyTouchscreen){var elementDefs=mergedContent.activeConfig.elements;Object.keys(elementDefs).reduce(function(targets,elId){var defs=elementDefs[elId];if(!defs.onMouseInOut){return targets}return targets.concat(defs.onMouseInOut.filter(function(a){return a.action==="toggleElement"&&a.data.touchscreenHoverFix}).map(function(a){return{source:elId,target:a.data.targetElementId}}))},[]).forEach(function(trigger){elementDefs[trigger.source].onMouseInOut=undefined;mergedContent.activeConfig.mediaqueries.forEach(function(mq){mq.elements[trigger.target].visible=!mq.elements[trigger.target].visible})})}var initialAssets=assetResolver.resolveForInitialLoad(mergedContent);mergedContent.timer.start("flowline-load");var flowline=openStateDimensions?false:initialAssets.flowline;flowlineLoader.load(container,flowline,function(){mergedContent.timer.stop("flowline-load");if(!container.isCrossOrigin()&&!adTagOptions.dcnl){var adFrame=container.getAdWindow().frameElement;adFrame.height=adFrame.style.height="100%"}container.setFlowline(mergedContent.flowline);if(!openStateDimensions){var initialSize=container.getAdSize();loadAndRender(initialSize,onRenderFinished)}container.onResize(function(ev){loadAndRender(ev.size,onRenderFinished)});container.onUnload(function(){clearTimeout(creativeTimeSpentInactivity);clearInterval(creativeTimeSpentActivityInterval);emitter.removeAllListeners()});mergedContent.getScrollerPaddingTop=mergedContent.getScrollerPaddingTop||function(){var padding=mergedContent.pageScrollerPaddingTop||50;if(container.getIframeContainerNode()){var siteString=container.getIframeContainerNode().id;if(siteString.indexOf("conde.vanityfair")!==-1){padding=56;var linkBanner=0;var primaryLinks=0;var scrollNav=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.getElementsByClassName("link-banner--standard-navigation").length;scrollNav=window.parent.document.querySelectorAll('[data-testid="ScrollingNavigationPrimaryItem"]').length;if(!deviceProps.isiPhone&&!deviceProps.isMobile){primaryLinks=window.parent.document.querySelectorAll('[data-testid="StackedNavigationSectionPrimaryLinks"]').length}}if(linkBanner>0||scrollNav>0){padding=110}if(primaryLinks>0){padding=160}}else if(siteString.indexOf("es.vanityfair")!==-1){padding=116}else if(siteString.indexOf("es.archdigest")!==-1){padding=112;var stickyHero=0;if(!container.isCrossOrigin()){stickyHero=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]').length}if(stickyHero){var element=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]')[0];var heroHeight=element&&element.offsetHeight?element.offsetHeight:100;if(heroHeight>padding){padding=heroHeight}}}else if(siteString.indexOf("conde.bonapp")!==-1){var linkBanner=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.querySelectorAll('[data-testid="StackedNavigationSectionPrimaryLinks"]').length}if(linkBanner>0){padding=136}}else if(siteString.indexOf("conde.glamour")!==-1){padding=57;if(siteString.indexOf("homepage")!==-1){padding=50}}else if(siteString.indexOf("uk.glamour")!==-1){padding=112;var navBanner=0;if(!container.isCrossOrigin()){navBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(navBanner>0){padding+=60}}else if(siteString.indexOf("es.glamour")!==-1){padding=112}else if(siteString.indexOf("conde.allure")!==-1){padding=113;var navBanner=0;if(!container.isCrossOrigin()){navBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(navBanner>0){padding+=60}}else if(siteString.indexOf("conde.vogue")!==-1){var iframeContainer=container.getIframeContainerNode();if(iframeContainer.parentNode&&iframeContainer.parentNode.parentNode&&iframeContainer.parentNode.parentNode.classList.contains("cns-ads-stage")){iframeContainer.parentNode.parentNode.style.setProperty("z-index",80)}padding=64;var linkBanner=0;var navBanner=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.querySelectorAll('[data-testid="LinkBannerMarquee"]').length;if(!deviceProps.isiPhone&&!deviceProps.isMobile){navBanner=window.parent.document.querySelectorAll('[data-testid="StackedNavigationSectionPrimaryLinks"]').length}else{padding=56}}if(linkBanner>0||navBanner>0){padding=112}}else if(siteString.indexOf("uk.vogue")!==-1){padding=112}else if(siteString.indexOf("es.vogue")!==-1){padding=112;var stickyHero=0;if(!container.isCrossOrigin()){stickyHero=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]').length}if(stickyHero){var element=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]')[0];var heroHeight=element&&element.offsetHeight?element.offsetHeight:100;if(heroHeight>padding){padding=heroHeight}}}else if(siteString.indexOf("conde.cntraveler")!==-1){var linkBanner=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.querySelectorAll('[data-testid="PersistentTop SiteHeaderWrapper"]').length}if(linkBanner>0){padding=170}}else if(siteString.indexOf("es.cntraveller")!==-1){padding=56;var stickyHero=0;if(!container.isCrossOrigin()){stickyHero=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]').length}if(stickyHero){var element=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]')[0];padding+=element&&element.offsetHeight?element.offsetHeight:100}}else if(siteString.indexOf("uk.cntraveller")!==-1){padding=56;var navBanner=0;if(!container.isCrossOrigin()){navBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(navBanner>0){padding+=60}}else if(siteString.indexOf("conde.self")!==-1){var iframeContainer=container.getIframeContainerNode();if(iframeContainer.parentNode&&iframeContainer.parentNode.parentNode&&iframeContainer.parentNode.parentNode.classList.contains("cns-ads-stage")){iframeContainer.parentNode.parentNode.style.setProperty("z-index",80)}padding=70;if(!container.isCrossOrigin()){if(!deviceProps.isiPhone&&!deviceProps.isMobile){if(siteString.indexOf("article")!==-1||siteString.indexOf("homepage")!==-1){padding=56}}else{padding=56}}}else if(siteString.indexOf("conde.ars")!==-1){padding=50;if(!container.isCrossOrigin()){if(deviceProps.isiPhone||deviceProps.isMobile){padding=55}}}else if(siteString.indexOf("conde.gq")!==-1){padding=57}else if(siteString.indexOf("uk.gq")!==-1){padding=116;var navBanner=0;if(!container.isCrossOrigin()){navBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(navBanner>0){padding+=60}}else if(siteString.indexOf("es.gq")!==-1){padding=116;var navBanner=0;if(!container.isCrossOrigin()){navBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(navBanner>0){padding+=60}}else if(siteString.indexOf("conde.teenvogue")!==-1){padding=57}else if(siteString.indexOf("conde.pitchfork")!==-1){padding=56;if(!container.isCrossOrigin()){if(!deviceProps.isiPhone&&!deviceProps.isMobile){linkBanner=window.parent.document.querySelectorAll('[data-testid="StackedNavigationSectionPrimaryLinks"]').length}}if(linkBanner>0){padding=160}}else if(siteString.indexOf("conde.them")!==-1){padding=160;var linkBanner=0;if(!container.isCrossOrigin()){if(!deviceProps.isiPhone&&!deviceProps.isMobile){if(siteString.indexOf("article")!==-1){padding=112}}else{padding=56}}}else if(siteString.indexOf("conde.newyorker")!==-1){padding=64;var stackedLinkBanner=0;var linkBanner=0;var siteHeader=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length;siteHeader=window.parent.document.querySelectorAll('[class*="SiteHeader__navWrapper"]').length;if(deviceProps.isiPhone||deviceProps.isMobile){padding=56}else{stackedLinkBanner=window.parent.document.querySelectorAll('[data-testid="StackedNavigationSectionPrimaryLinks"]').length}}if(stackedLinkBanner>0){if(deviceProps.isiPhone||deviceProps.isMobile){padding=56}else{padding=160}}if(linkBanner>0){if(deviceProps.isiPhone||deviceProps.isMobile){padding=116}else{padding=124}}if(siteHeader>0){padding=107}}else if(siteString.indexOf("conde.wired")!==-1){padding=57;var vfLinkBanner=0;if(!container.isCrossOrigin()){linkBanner=window.parent.document.querySelectorAll('[data-testid="LinkBanner"]').length}if(linkBanner>0){padding=117}}else if(siteString.indexOf("uk.wired")!==-1){padding=57;var stickyHero=0;if(!container.isCrossOrigin()){stickyHero=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]').length}if(stickyHero){var element=window.parent.document.querySelectorAll('[class*="ad-stickyhero-sticky-visible"]')[0];padding+=element&&element.offsetHeight?element.offsetHeight:100}}else if(siteString.indexOf("uk.tatler")!==-1){padding=112}else if(siteString.indexOf("uk.houseandgarden")!==-1){padding=112}var disablePaddingArray=["disabledfornow"];disablePaddingArray.forEach(function(item){if(siteString.indexOf(item)!==-1&&!deviceProps.isiPhone&&!deviceProps.isMobile){padding=0}})}return padding};mergedContent.getScrollerPaddingBottom=mergedContent.getScrollerPaddingBottom||function(){var padding=mergedContent.pageScrollerPaddingBottom||0;if(container.getIframeContainerNode()){var siteString=container.getIframeContainerNode().id;if(siteString.indexOf("pitchfork")!==-1&&deviceProps.isMobile&&!deviceProps.isiPad){padding=45}}return padding};var condeIndentifiers=["es.archdigest","es.cntraveller","uk.cntraveller","es.glamour","uk.glamour","es.gq","uk.gq","uk.houseandgarden","uk.tatler","es.vanityfair","es.vogue","uk.vogue","es.voguebusiness","cni.voguebusiness","uk.wired"];var condeMobileImmerse=false;if(mergedContent.pageScroller&&container.getIframeContainerNode()&&(deviceProps.isMobile||deviceProps.isiPad)){var siteString=container.getIframeContainerNode().id;for(var i in condeIndentifiers){if(siteString.indexOf(condeIndentifiers[i])>-1){condeMobileImmerse=true;var adFrame=container.getAdWindow().frameElement;adFrame.style.setProperty("height","90vh","important");break}}}if(mergedContent.pageScroller&&!condeMobileImmerse){var pageScrollerHeight=mergedContent.pageScrollerHeight||100;var pageScrollerPaddingTop=mergedContent.getScrollerPaddingTop&&mergedContent.getScrollerPaddingTop();if(pageScrollerPaddingTop===null||pageScrollerPaddingTop===undefined){pageScrollerPaddingTop=mergedContent.pageScrollerPaddingTop||0}var pageScrollerPaddingBottom=mergedContent.getScrollerPaddingBottom&&mergedContent.getScrollerPaddingBottom();if(pageScrollerPaddingBottom===null||pageScrollerPaddingBottom===undefined){pageScrollerPaddingBottom=mergedContent.pageScrollerPaddingBottom||0}var pageScrollerEnableCentering=mergedContent.pageScrollerEnableCentering||false;var pageScrollerAlignLeftToParent=mergedContent.pageScrollerAlignLeftToParent||false;if(container.isCrossOrigin()){window.top.postMessage({from:"RAD",type:"pageScroller",data:dom.Object.clone(mergedContent)},"*")}else{container.setPageScrollerHeight(pageScrollerHeight,pageScrollerPaddingTop,pageScrollerPaddingBottom,pageScrollerEnableCentering,pageScrollerAlignLeftToParent);container.onPageResize(function(){container.setPageScrollerHeight(pageScrollerHeight,pageScrollerPaddingTop,pageScrollerPaddingBottom,pageScrollerEnableCentering,pageScrollerAlignLeftToParent)})}}eventHandlers.setUpAutoOpenClose(adObject,openStateDimensions)})})}function loadAndRender(size,cb){var mq=getCurrentMediaquery(mergedContent.activeConfig.mediaqueries,size,container,mergedContent.sizes,adTagOptions,openStateDimensions,responsiveMode);if(!mq){var sizes=mergedContent.activeConfig.mediaqueries.map(function(m){return m.maxWidth.value+"x"+m.maxHeight.value});log.log("No possible sizes found for "+size.width+"x"+size.height+" out of ["+sizes.join(",")+"]");if(cb){cb("no size found")}return}renderedSize={width:mq.maxWidth.value,height:mq.maxHeight.value};mergedContent.formatProperties=cssCustomVariablesParse.parse(container.getIframeContainerNode());var mqAssets=assetResolver.resolveForMediaquery(mergedContent,mq);if(mqAssets){var toggledFonts=findToggledElementFonts(mergedContent,mq);var fonts=mqAssets.stage0.fonts||[];mqAssets.stage0.fonts=fonts.concat(toggledFonts)}var assetLoadEventName="asset-load-"+size.width+"x"+size.height;mergedContent.timer.start(assetLoadEventName);containerAssetLoader.load(mqAssets?mqAssets.stage0:{},function(err){if(err){console.error(err)}mergedContent.timer.stop(assetLoadEventName);var renderEventName="ad-render-"+size.width+"x"+size.height;mergedContent.timer.start(renderEventName);if(context.adContent.forceAdProportions){var ratio=renderedSize.width/renderedSize.height;var ratioSize={width:size.width,height:size.width/ratio};if(ratioSize.height>size.height){ratioSize={width:size.height*ratio,height:size.height}}container.setContentDimensions(ratioSize)}if(context.animationTimeline){context.animationTimeline.destroy()}var animationSettings={paused:mergedContent.inEditor,screenshot:mergedContent.screenshot||false};if(mergedContent.activeConfig.animationSettings){if(mergedContent.inEditor){animationSettings.repeat=0;animationSettings.parallax=false}else{animationSettings.repeat=mergedContent.activeConfig.animationSettings.repeatAnimation;animationSettings.parallax=mergedContent.activeConfig.animationSettings.parallax;animationSettings.parallaxStartStop=mergedContent.activeConfig.animationSettings.parallaxStartStop}animationSettings.restartOnScrollIntoView=mergedContent.activeConfig.animationSettings.restartOnScrollIntoView}context.animationTimeline=animationTimeline.create(mq,container,renderer,animationSettings,emitter);context.animationTimeline.onAnimationEvent(function(eventData){eventHandlers.handleEvent(adObject,"animationKeyframe",eventData)});activeFormatSize=size;renderer.renderSize(mergedContent.activeConfig.elements,mq.elements,renderedSize,size);if(mq.animationTimeline&&!mq.animationTimeline.paused){context.animationTimeline.run()}mergedContent.timer.stop(renderEventName);if(cb){cb()}const params={eventType:"onCreativeRender",config:mergedContent.activeConfig,mq:mq};events.emitGlobal("render",params);emitter.emit("render",params)})}function onRenderFinished(err){if(!initialLoadDone&&renderedSize){if(!err){container.show();refreshDisable();if(mergedContent.pageScroller){var isChrome=device.getDeviceProperties(window).isChrome;if(isChrome){container.refreshClipStyles()}}}initialLoadDone=true;const params={eventType:"onCreativeLoad",config:mergedContent.activeConfig,mq:adObject.getCurrentMediaquery(adObject.getRenderedSize())};events.emitGlobal("initialLoad",params);emitter.emit("initialLoad",params)}}function sendAdformAnalyticsEvent(eventId,eventName){adformAnalytics.sendEvent(eventId,eventName)}function sendAnalyticsEvent(data){analyticsSender.sendData(container.getAdWindow(),mergedContent,dom.merge({fls:activeFormatSize.width+"x"+activeFormatSize.height},analyticsCollector.collectData(container,adObject),data))}function getAnalyticsCollectData(){return analyticsCollector.collectData(container,adObject)}function getMergedContent(){return mergedContent}function getOpenStateAdObj(){return isOpenStateAdObj}function creativeTimeSpent(){clearTimeout(creativeTimeSpentInactivity);creativeTimeSpentInactivity=setTimeout(function(){clearInterval(creativeTimeSpentActivityInterval);creativeTimeSpentActivityInterval=null},3e4);if(!creativeTimeSpentActivityInterval){creativeTimeSpentActivityInterval=setInterval(function(){sendAnalyticsEvent({e:"interact.ts",v:"inter"})},5e3)}}function refreshInteractionDisable(){if(!container.isCrossOrigin()&&!mergedContent.activeConfig.disableRefresh&&mergedContent.activeConfig.disableRefreshOnInteraction&&!interActionRefreshDisabled){condeDisableRefresh()}}function refreshDisable(){if(!container.isCrossOrigin()&&mergedContent.activeConfig.disableRefresh){condeDisableRefresh()}}function condeDisableRefresh(){var window=container.getAdWindow();var slotName=container.getIframeContainerNode().parentNode.id;var refresh=false;if(window&&window.top.postMessage){window.top.postMessage({cnsAdEvent:"updateRefresh",payload:{refresh:refresh,slotName:slotName}},"*");interActionRefreshDisabled=true}}function condeHideAd(){events.emitGlobal("hideAd",{});var window=container.getAdWindow();var slotName=container.getIframeContainerNode().parentNode.id;var refresh=3e4;if(window&&window.top.postMessage){window.top.postMessage({cnsAdEvent:"updateRefresh",payload:{refresh:refresh,slotName:slotName}},"*")}container.remove()}function updateState(stateUpdate){dom.merge(customJsState,stateUpdate)}events.addGlobalListener("postMessage",function(event){if(isOpenStateAdObj&&event.data.type==="openState"){if(event.data.action=="updateState"){updateState(event.data.data)}}else if(!isOpenStateAdObj&&event.data.type==="closedState"){if(event.data.action=="updateState"){updateState(event.data.data)}}});events.addGlobalListener("mraid-closed",function(event){dom.forceInlineStyles(container.getAdDocument().body,{display:"none"})});events.addGlobalListener("mraid-impression",function(event){sendAnalyticsEvent({e:"impressions",vi:true,vit:1e3,browserlang:"mraid"})});var adObject={start:start,getContainer:function(){return container},getExtension:function(name){if(name=="lightbox"&&mergedContent.adVersion>10&&!mergedContent.mraid){name="lightboxNew"}return require("./extensions/"+name).forAd(this)},getAdContent:function(){return adContent},getConfig:function(){return mergedContent.config},getActiveConfig:function(){return mergedContent.activeConfig},getAdVersion:function(){return mergedContent.adVersion},getAdTagOptions:function(){return adTagOptions},updateAgTagOptions:function(prop){dom.merge(adTagOptions,prop)},updateCustomJs:function(jsString){renderer.updateCustomJs(jsString)},updateCustomCSS:function(cssString){renderer.updateCustomCSS(cssString)},setConfig:function(config){adContent.config=config;delete adTagOptions.config;var prevSizeFilter=mergedContent.sizes;parser.parseAdContent(adContent,adTagOptions,adObject.getUserInfo(),function(err,parsedMergedContent){mergedContent=parsedMergedContent;if(mergedContent.sizes&&mergedContent.sizes.length===0&&prevSizeFilter){mergedContent.sizes=prevSizeFilter}context.adContent=mergedContent})},renderElement:function(elId){renderer.renderElement(elId,mergedContent.activeConfig.elements[elId],mediaquery.findExact(mergedContent.activeConfig.mediaqueries,renderedSize).elements[elId]);emitter.emit("render",elId)},getFormatLayouts:function(){return mergedContent.activeConfig.mediaqueries.filter(function(mq){return mergedContent.sizes.length===0||mergedContent.sizes.find(function(sz){return sz.width===mq.maxWidth.value&&sz.height===mq.maxHeight.value})})},renderElementWithStyles:function(elId,styles){renderer.renderElement(elId,mergedContent.activeConfig.elements[elId],styles);emitter.emit("render",elId)},updateElementStyles:function(elId,styles){renderer.updateElementStyles(elId,styles)},getAssets:function(){return mergedContent.assets},getMergedContent:function(){return mergedContent},onLoad:function(callback){if(initialLoadDone){setTimeout(callback,0);return}emitter.addListener("initialLoad",callback)},onAdContentAvailable:function(callback){emitter.addListener("adContentAvailable",callback)},isAdContentAvailable:function(){return adContentAvailable},onRender:function(callback){emitter.addListener("render",callback);return function(){emitter.removeListener("render",callback)}},onBeforeRender:function(callback){renderer.onBeforeRender(callback)},stopAnimation:function(){container.getAdDocument().body.className.replace(/play-animations/g,"")},startAnimation:function(){container.getAdDocument().body.className+=" play-animations"},forceRender:function(fullRedraw,cb){if(fullRedraw){renderer.clear()}loadAndRender(container.getAdSize(),cb)},createLightboxContainer:function(container,adTagOptions,adContent,openStateDimensions){return create(container,adTagOptions,adContent,openStateDimensions)},getRenderedSize:function(){return renderedSize},updateAnimationTimeline:function(currentTime,data){context.animationTimeline.update(currentTime,data,container.getAdWindow())},getAnimationTimeline:function(){return context.animationTimeline},getElementById:function(id){return renderer.getElementById(id)},getElementStyles:function(id){return context.getElementStyles(id)},getElementChildren:function(el){return context.getElementChildren(el)},getVisibleElementChildren:function(el){return context.getVisibleElementChildren(el)},restartAnimation:function(){context.animationTimeline.restart()},pauseAnimation:function(){context.animationTimeline.pause()},playAnimation:function(){context.animationTimeline.play()},seekAnimation:function(seconds){context.animationTimeline.seek(seconds)},setProgressAnimation:function(value){context.animationTimeline.setProgress(value)},previewPageForceRender:function(value){events.emitGlobal("previewPageForceRender");this.forceRender(true)},animationTime:function(seconds){return context.animationTimeline.animationTime(seconds)},onAnimationProgress:function(callback){emitter.addListener("animationUpdate",callback);container.onUnload(function(){emitter.removeListener("animationUpdate",callback)});return function(){emitter.removeListener("animationUpdate",callback)}},hideCreative:function(ad,ev,evConfig){container.hide(ad,ev,evConfig)},clearElements:function(elements){return context.clearElements(elements)},sendAdformAnalyticsEvent:sendAdformAnalyticsEvent,sendAnalyticsEvent:sendAnalyticsEvent,creativeTimeSpent:creativeTimeSpent,refreshInteractionDisable:refreshInteractionDisable,onClick:function(callback){return dom.addEventListener(container.getAdDocument().body,"click",function(ev){domEventHandler(ev,"click",callback)})},onElementHover:function(callback){return dom.addEventListener(container.getAdDocument().body,"mouseover",function(ev){domEventHandler(ev,"hover",callback)})},onElementMouseOut:function(callback){return dom.addEventListener(container.getAdDocument().body,"mouseout",function(ev){domEventHandler(ev,"mouseout",callback)})},onVideoPlay:function(callback){events.addGlobalListener("videoPlay",videoPlay);container.onUnload(function(){events.removeGlobalListener("videoPlay",videoPlay)});function videoPlay(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoPlay",callback)}},onVideoTimeUpdate:function(callback){events.addGlobalListener("videoTimeUpdate",videoTimeUpdate);container.onUnload(function(){events.removeGlobalListener("videoTimeUpdate",videoTimeUpdate)});function videoTimeUpdate(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoTimeUpdate",callback)}},onVideoUnableToAutoplay:function(callback){events.addGlobalListener("videoUnableToAutoplay",videoUnableToAutoplay);container.onUnload(function(){events.removeGlobalListener("videoUnableToAutoplay",videoUnableToAutoplay)});function videoUnableToAutoplay(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoUnableToAutoplay",callback)}},onVideoPause:function(callback){events.addGlobalListener("videoPause",videoPause);container.onUnload(function(){events.removeGlobalListener("videoPause",videoPause)});function videoPause(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoPause",callback)}},onVideoEnd:function(callback){events.addGlobalListener("videoEnded",videoEnd);container.onUnload(function(){events.removeGlobalListener("videoEnded",videoEnd)});function videoEnd(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoEnd",callback)}},onVideoMuted:function(callback){events.addGlobalListener("videoMuted",videoMuted);container.onUnload(function(){events.removeGlobalListener("videoMuted",videoMuted)});function videoMuted(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoMuted",callback)}},onVideoUnMuted:function(callback){events.addGlobalListener("videoUnMuted",videoUnMuted);container.onUnload(function(){events.removeGlobalListener("videoUnMuted",videoUnMuted)});function videoUnMuted(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"videoUnMuted",callback)}},onPreviewVideoEnd:function(callback){events.addGlobalListener("previewVideoEnded",previewEnd);container.onUnload(function(){events.removeGlobalListener("previewVideoEnded",previewEnd)});function previewEnd(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"previewVideoEnded",callback)}},onPreviewVideoStart:function(callback){events.addGlobalListener("previewVideoStarted",previewStart);container.onUnload(function(){events.removeGlobalListener("previewVideoStarted",previewStart)});function previewStart(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"previewVideoStarted",callback)}},onCarouselFirstSlide:function(callback){events.addGlobalListener("carouselFirstSlide",firstSlide);container.onUnload(function(){events.removeGlobalListener("carouselFirstSlide",firstSlide)});function firstSlide(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"carouselFirstSlide",callback)}},onCarouselLastSlide:function(callback){events.addGlobalListener("carouselLastSlide",lastSlide);container.onUnload(function(){events.removeGlobalListener("carouselLastSlide",lastSlide)});function lastSlide(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"carouselLastSlide",callback)}},onCarouselMiddleSlide:function(callback){events.addGlobalListener("carouselMiddleSlide",middleSlide);container.onUnload(function(){events.removeGlobalListener("carouselMiddleSlide",middleSlide)});function middleSlide(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"carouselMiddleSlide",callback)}},onAdHover:function(callback){return dom.addEventListener(container.getAdDocument().body,"mouseenter",function(ev){callback({domEvent:ev,eventType:"adHover"})})},onMediaPlaying:function(callback){const listener=function(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"mediaPlaying",callback)};events.addGlobalListener("mediaPlaying",listener);container.onUnload(function(){events.removeGlobalListener("mediaPlaying",listener)})},onMediaPause:function(callback){const listener=function(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"mediaPause",callback)};events.addGlobalListener("mediaPause",listener);container.onUnload(function(){events.removeGlobalListener("mediaPause",listener)})},onMediaEnded:function(callback){const listener=function(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"mediaEnded",callback)};events.addGlobalListener("mediaEnded",listener);container.onUnload(function(){events.removeGlobalListener("mediaEnded",listener)})},onCountdownFinished:function(callback){const listener=function(ev){if(ev.context!==context){return}domEventHandler(ev.domEvent,"countdownFinished",callback)};events.addGlobalListener("countdownFinished",listener);container.onUnload(function(){events.removeGlobalListener("countdownFinished",listener)})},getCurrentMediaquery:function(size){return getCurrentMediaquery(mergedContent.activeConfig.mediaqueries,size,container,mergedContent.sizes,adTagOptions,null,responsiveMode)},setResponsiveMode:function(mode){responsiveMode=mode},setSizeFilter:function(filter){mergedContent.sizes=filter.concat()},getSizeFilter:function(){return mergedContent.sizes},getDeviceInfo:function(){return device.getDeviceProperties(container.getAdWindow())},setCustomTracker:function(eventType,trackerURL){if(!mergedContent.customtracker){mergedContent.customtracker={}}mergedContent.customtracker[eventType]=trackerURL},setVideoInViewPercetage:function(startStop){mergedContent.customVideoInViewPercetage=startStop},getState:function(){return customJsState},setState:function(stateUpdate){dom.merge(customJsState,stateUpdate);if(!container.isCrossOrigin()){var target;var creativeState;var targetAquired=false;var lightboxNro=this.getLbNro();if(lightboxNro){if(isOpenStateAdObj){var closedStateContainerId="rad-container-"+uuid.creativeUUID+"-"+lightboxNro;var closeStateDiv=container.getAdWindow().parent.document.getElementsByClassName(closedStateContainerId)[0];if(closeStateDiv){var closedFrame=closeStateDiv.getElementsByTagName("iframe")[0];target=closedFrame.contentWindow||closedFrame;creativeState="closedState";targetAquired=true}}else{var openStateContainerId="rad-lb-container-"+uuid.creativeUUID+"-"+lightboxNro;var openStateDiv=container.getAdWindow().parent.document.getElementById(openStateContainerId);if(openStateDiv){var openFrame=openStateDiv.getElementsByTagName("iframe")[0];if(openFrame){target=openFrame.contentWindow||openFrame;targetAquired=true;creativeState="openState"}}}if(targetAquired){messaging.sendMessage(target,creativeState,"updateState",stateUpdate)}}}},isOpenStateAdObj:function(){return isOpenStateAdObj},getLbNro:function(){return lbNro},setLbNro:function(nro){lbNro=nro},getUUID:function(){return uuid.creativeUUID},generateUUID:function(){return uuid.generateUUID()},callTrackerURL:function(url){analyticsSender.callTrackerURL(container.getAdWindow(),mergedContent,url)},addGlobalEventListener:function(event,callback){events.addGlobalListener(event,callback)},removeGlobalEventListener:function(event,callback){events.removeGlobalListener(event,callback)},domEventHandler:domEventHandler,getUserInfo:function(){return userInfo},getCookie:function(key){return store?store.get(key):null},setCookie:function(key,value,lifetimeSeconds){if(store){store.set(container.isCrossOrigin(),key,value,lifetimeSeconds)}},condeHideAd:condeHideAd,getAdRenderer:function(){return renderer}};return adObject;function domEventHandler(ev,eventType,callback){var targetAdElement=findClosestAdElement(ev.target);var elId=targetAdElement?targetAdElement.id:"";callback({eventType:eventType,element:renderer.getElementById(elId),elementConfig:mergedContent.activeConfig.elements[elId],elementStyles:renderer.getElementStyles(elId),domEvent:ev})}function findClosestAdElement(el){return el&&el.closest(".rad-element")}}module.exports={create:create}},{"./adRenderer":10,"./adformAnalytics":11,"./analyticsCollector":16,"./analyticsSender":18,"./animationTimeline":20,"./assetLoader":21,"./assetResolver":22,"./async":23,"./cssCustomVariablesParser":29,"./device":31,"./dom":32,"./eventHandlers.js":51,"./events":52,"./extensions/expandv":53,"./extensions/lightbox":54,"./extensions/lightboxNew":55,"./fallbacks":57,"./flowlineLoader":58,"./log":65,"./mediaquery":67,"./messaging":68,"./metrics":69,"./parser":71,"./storage":75,"./tagParametersParser":77,"./user":80,"./uuid":81}],14:[function(require,module,exports){module.exports={load:function(url,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState!=4){return}if(xhr.status===200){callback(null,xhr.responseText)}else{callback(xhr.responseText)}};xhr.open("GET",url);xhr.send(null)}}},{}],15:[function(require,module,exports){var collector=require("./analyticsCollector");var sender=require("./analyticsSender");var dom=require("./dom");var scriptLoader=require("./scriptLoader");var analyticsConfig=require("./analyticsConfig");var storage;module.exports={attachReportingObserver:function(container,ad){var observer;try{observer=new ReportingObserver(function(reports,observer){if(reports.length>0){sendReport(reports,container,ad)}},{types:["intervention"],buffered:true})}catch(err){console.log("Failed to attach Rerporting Observer")}window.addEventListener("unload",function(event){var reports=observer.takeRecords();if(reports.length>0){sendReport(reports,container,ad)}});if(observer){observer.observe()}},createImpressionTrackers:function(container,ad){var adConfig=ad.getMergedContent();var window=container.getAdWindow();var data=Object.assign({},collector.collectData(container,ad),collector.collectImpressionData(container,ad.getMergedContent()));data.e="impression";if(!adConfig.imptt){sender.sendData(window,adConfig,data)}if(adConfig.tracking!==false&&adConfig.dfpvu){sender.createTrackerIframe(window,adConfig.dfpvu)}if((adConfig.tracking!==false||adConfig.export)&&adConfig.activeConfig&&adConfig.activeConfig.impressionTrackers){var trackers=adConfig.activeConfig.impressionTrackers;for(var i=0;i<trackers.length;i++){var tracker=trackers[i];if(tracker.value){if(tracker.type==="url"&&tracker.name&&(tracker.name==="_RAD_CUSTOM_TRACKER_LIGHTBOX_"||tracker.name==="_RAD_CUSTOM_TRACKER_PUSHDOWN_")){if(tracker.name==="_RAD_CUSTOM_TRACKER_LIGHTBOX_"){adConfig.activeConfig["lightboxOpenTracker"]=tracker.value}else{adConfig.activeConfig["pushdownOpenTracker"]=tracker.value}continue}if(tracker.type==="url"){sender.createTrackerImgElement(window,tracker.value,adConfig.dfpcb)}else{sender.appendHtml(window,tracker.value,adConfig.dfpcb)}}}}},initializeTrackingCookies:function(container,ad){var adConfig=ad.getMergedContent();var window=container.getAdWindow();if(!adConfig){return}if(adConfig.tracking===false){return}if(adConfig.activeConfig&&adConfig.activeConfig.disableRefresh){storage=require("./storage");var store=storage.open(window,adConfig);var cookie=store.get(analyticsConfig.COOKIE_C+adConfig.deployment);var adCall=1;if(cookie){adCall=parseInt(cookie,10);adCall++;store.set(container.isCrossOrigin(),analyticsConfig.COOKIE_C+adConfig.deployment,adCall,60*60*24*365*1)}else{store.set(container.isCrossOrigin(),analyticsConfig.COOKIE_C+adConfig.deployment,adCall,60*60*24*365*1)}adConfig.activeConfig.trackAdCalls=adCall}},loadMoat:function(container,options){var doc=container.getAdDocument();var head=doc.getElementsByTagName("head")[0];var noscript=doc.createElement("noscript");noscript.className="MOAT-"+options.id+"?"+options.macros.replace("&","&amp;");head.appendChild(noscript);var moatUrl="//js.moatads.com/"+options.id+"/moatad.js#"+options.macros;scriptLoader.load(moatUrl,doc,function(){})},sendPreImpression:function(options){var data={};data.aid=options[0];data.fl=options[1].flowline;data.deployment=options[1].deployment;data.pu=top.location.href||location.href;data.sr=screen.width+"x"+screen.height;data.vs=top.document.documentElement.clientWidth+"x"+top.document.documentElement.clientHeight;data.o=window.orientation==undefined?null:Math.abs(window.orientation)==90?"landscape":"portrait";data.e="impression";data.cb=(new Date).getTime();var serialized=[];var fnc=function(param,data){serialized.push(param+"="+encodeURIComponent(data))};if(typeof data.length!="undefined"){var len=data.length,i=-1;while(++i<len){var value=fnc.call(this,i,data[i]);if(value===false){break}}}else{for(var key in data){if(!data.hasOwnProperty(key)){continue}if(fnc.call(this,key,data[key])===false){break}}}var img=new Image;img.src="https://analytics.responsiveads.com/"+"___tp.gif?"+serialized.join("&")},trackVisibility:function(ad){var container=ad.getContainer();var config=ad.getMergedContent();var checkTimer;var viewabilitySent=false;ad.onLoad(testVisibility);container.onPageScroll(function(){testVisibility()});container.onPageResize(function(){testVisibility()});container.onUnload(function(){clearTimeout(checkTimer)});function testVisibility(){if(viewabilitySent){return}if(container.getVisiblePercentage()>=.5){if(checkTimer){return}checkTimer=setTimeout(function(){checkTimer=null;if(!ad.getRenderedSize()){return}var data=Object.assign(collector.collectData(container,ad),{e:"impressions",vi:true,vit:1e3});sender.sendData(container.getAdWindow(),config,data);viewabilitySent=true},1e3)}else{clearTimeout(checkTimer);checkTimer=null}}}};function sendReport(reports,container,ad){var adConfig=ad.getMergedContent();var window=container.getAdWindow();var data=Object.assign({},collector.collectData(container,ad));var message="";var itype="";if(reports[0].body&&reports[0].body.message){message=reports[0].body.message.indexOf("network")>-1?"network":reports[0].body.message.indexOf("CPU")>-1?"cpu":""}if(reports[0].body&&reports[0].body.id){itype=reports[0].body.id}data.e="intervention";if(message!==""){data.e+="."+message}data.v=itype;sender.sendData(window,adConfig,data)}},{"./analyticsCollector":16,"./analyticsConfig":17,"./analyticsSender":18,"./dom":32,"./scriptLoader":74,"./storage":75}],16:[function(require,module,exports){var dom=require("./dom");var uuid=require("./uuid");function getOrientationString(orientation){return Math.abs(orientation)==90?"landscape":"portrait"}function guessAdLocationData(locationStr){if(locationStr.indexOf("tripleclick")==-1){return null}else{var tripleclickRe=/pos%3D([^%]+)/;var result=tripleclickRe.exec(locationStr);if(!result){tripleclickRe=/pos=([^&]+)/;result=tripleclickRe.exec(locationStr)}if(result&&result[1]){return result[1]}}}module.exports={collectData:function(container,ad){var window=container.getAdWindow();var adConfig=ad.getMergedContent();var adActiveConfig=ad.getActiveConfig();var windowSize=dom.getWindowSize(window);var mq=ad.getCurrentMediaquery(ad.getRenderedSize());var url=container.isCrossOrigin()?null:window.parent.location.href;var previewURL=null;if(url=="about:blank"&&adConfig.preview){previewURL="https://preview.responsiveads.com"}var domain="";if(url){var arr=url.split("/");domain=arr[2]?arr[2]:"";if((!domain||domain===""||domain==="pubads.g.doubleclick.net")&&adConfig.source&&adConfig.source!="%%PATTERN:source%%"){domain=adConfig.source}}else if(adConfig.asdm&&adConfig.asdm!=="%%SITE%%"){domain=adConfig.asdm}return{mrkt:adActiveConfig.market?adActiveConfig.market:"",ac:adActiveConfig.trackAdCalls?adActiveConfig.trackAdCalls:0,conid:adActiveConfig.activeConditionsTableRowIndex?adActiveConfig.activeConditionsTableRowIndex:"",aid:adConfig.id,fl:adConfig.flowline,deployment:adConfig.deployment,vid:adActiveConfig.selectedVariant?adActiveConfig.selectedVariant:"",pu:container.isCrossOrigin()?undefined:previewURL?previewURL:window.parent.location.href,dm:domain,asid:adConfig.asid&&adConfig.asid.indexOf("%eaid!")==-1?adConfig.asid:"",ascid:adConfig.ascid&&adConfig.ascid.indexOf("%ecid!")==-1?adConfig.ascid:"",pcat:mq&&mq.pcat?mq.pcat:-1,sr:window.screen.width+"x"+window.screen.height,vs:container.isCrossOrigin()?undefined:window.parent.document.documentElement.clientWidth+"x"+window.parent.document.documentElement.clientHeight,as:windowSize.width+"x"+windowSize.height,o:window.orientation==undefined?null:getOrientationString(window.orientation),ald:guessAdLocationData(window.location.href),ascb:adConfig.dfpcb&&adConfig.dfpcb.indexOf("%%")==-1?adConfig.dfpcb:"",uuid:uuid.creativeUUID,ec:adConfig.export?1:0}},collectImpressionData:function(container){var window=container.getAdWindow();return{bl:window.navigator.language||window.navigator.userLanguage,pt:container.isCrossOrigin()?undefined:window.parent.document.title}}}},{"./dom":32,"./uuid":81}],17:[function(require,module,exports){module.exports={COOKIE_A:"___rada",COOKIE_B:"___radb",COOKIE_C:"___rabc_"}},{}],18:[function(require,module,exports){var dom=require("./dom");var _addCacheBuster=function(content,dfpCachebuster,ad){var adConfig=ad?ad.getAdContent():false;var activeConfig=ad?ad.getActiveConfig():false;var ord=Math.random();ord=ord*1e19;var cb=dfpCachebuster?dfpCachebuster:ord+"";if(content.indexOf("[timestamp]")>-1){content=content.replace(/\[timestamp\]/g,cb)}if(content.indexOf("[TIMESTAMP]")>-1){content=content.replace(/\[TIMESTAMP\]/g,cb)}if(content.indexOf("[InsertCachebusterHere]")>-1){content=content.replace(/\[InsertCachebusterHere\]/g,cb)}if(content.indexOf("[RANDOM]")>-1){content=content.replace(/\[RANDOM\]/g,cb)}if(content.indexOf("[INSERT_CACHEBUSTER_HERE]")>-1){content=content.replace(/\[INSERT_CACHEBUSTER_HERE\]/g,cb)}if(content.indexOf("%n")>-1){content=content.replace(/\%n/g,cb)}if(content.indexOf("%%CACHEBUSTER%%")>-1){content=content.replace(/%%CACHEBUSTER%%/g,cb)}if(content.indexOf("%%RANDOM%%")>-1){content=content.replace(/%%RANDOM%%/g,cb)}if(content.indexOf("ADD-RANDOM-NUMBER-HERE")>-1){content=content.replace(/ADD-RANDOM-NUMBER-HERE/g,cb)}if(content.indexOf("[rad-cid]")>-1){var replaceValue="";if(adConfig&&adConfig.id){replaceValue=adConfig.id}content=content.replace(/\[rad-cid\]/g,replaceValue)}if(content.indexOf("[rad-did]")>-1){var replaceValue="";if(adConfig&&adConfig.deployment){replaceValue=adConfig.deployment}content=content.replace(/\[rad-did\]/g,replaceValue)}if(content.indexOf("[rad-vid]")>-1){var replaceValue="";if(activeConfig&&activeConfig.selectedVariant){replaceValue=activeConfig.selectedVariant}content=content.replace(/\[rad-vid\]/g,replaceValue)}if(content.indexOf("[rad-conid]")>-1){var replaceValue="";if(activeConfig&&activeConfig.activeConditionsTableRowIndex){replaceValue=activeConfig.activeConditionsTableRowIndex}content=content.replace(/\[rad-conid\]/g,replaceValue)}return content};module.exports={addCacheBuster:_addCacheBuster,sendData:function(window,adConfig,data){if(adConfig.tracking===false){return}data.cb=(new Date).getTime();var serialized=[];for(var k in data){serialized.push(k+"="+encodeURIComponent(data[k]))}var img=new window.Image;img.src=adConfig.analytics+"___tp.gif?"+serialized.join("&")},callTrackerURL:function(window,adConfig,clickTrackerURL){var url=_addCacheBuster(clickTrackerURL,adConfig.dfpcb);var img=new window.Image;img.src=url},createTrackerImgElement:function(window,url,dfpCachebuster){var doc=window.document;var img=doc.createElement("img");url=_addCacheBuster(url,dfpCachebuster);img.style.width=img.style.height="1px";img.width=img.height="1";doc.body.appendChild(img);img.src=url},createTrackerIframe:function(window,url,dfpCachebuster){var doc=window.document;var iframe=doc.createElement("iframe");url=_addCacheBuster(url,dfpCachebuster);dom.setupIframe(iframe);iframe.style.width=iframe.style.height="1px";iframe.width=iframe.height="1";doc.body.appendChild(iframe);iframe.src=url},appendHtml:function(window,html,dfpCachebuster){var doc=window.document;var container=doc.createElement("div");html=_addCacheBuster(html,dfpCachebuster);container.innerHTML=html;var scripts=container.getElementsByTagName("script");dom.Array.from(scripts).forEach(function(script){var safeScript=document.createElement("script");dom.Array.from(script.attributes).forEach(function(attribute){safeScript.setAttribute(attribute.name,attribute.value)});safeScript.text=script.text;var parent=script.parentElement;parent.insertBefore(safeScript,script);parent.removeChild(script)});doc.body.appendChild(container)}}},{"./dom":32}],19:[function(require,module,exports){var dom=require("./dom");function getTransitionDuration(domEl){var ownerWindow=dom.getOwnerWindow(domEl);if(!ownerWindow.getComputedStyle){return 0}return(parseFloat(ownerWindow.getComputedStyle(domEl).transitionDuration)||0)*1e3}function createFader(container,body,dimensions,transitionHeight,fadeOut,fadeIn){var fadingOut=true;return function fader(){if(fadingOut){if(dimensions.width){dom.forceInlineStyles(container,{width:dimensions.width+"px"})}else{container.style.width=""}if(dimensions.height){var heightStyles={height:dimensions.height+"px"};if(transitionHeight){heightStyles.transition="height 0.6s";heightStyles["transition-timing-function"]="linear"}else{heightStyles.transition="";heightStyles["transition-timing-function"]=""}dom.forceInlineStyles(container,heightStyles)}else{container.style.height=""}fadeOut();setTimeout(function(){body.className=body.className.replace(/fadeOut/,"");setTimeout(fader,getTransitionDuration(body))},1);fadingOut=false}else{fadeIn()}}}function setupTransition(frame,doc,fader,transitionHeight,noFadeOut){var adBody=doc.body;var transitionInfo=dom.getTransitionInfo(doc);if(transitionInfo){if(!noFadeOut){adBody.className+=" fadeOut"}setTimeout(fader,getTransitionDuration(adBody))}else{fader();fader()}}module.exports={transitionAdSize:function(container,dimensions,fadeOutCallback,fadeInCallback){if(container.isCrossOrigin()){return}var frame=container.getAdWindow().frameElement;var fader=createFader(frame,frame.contentDocument.body,dimensions,false,fadeOutCallback,fadeInCallback);setupTransition(frame,frame.contentDocument,fader,false,false)},transitionContainerSize:function(container,dimensions,transitionHeight,noFadeOut,fadeOutCallback,fadeInCallback){if(container.isCrossOrigin()){return}var frame=container.getAdWindow().frameElement;var frameContainer=frame.parentElement;var fader=createFader(frameContainer,frame.contentDocument.body,dimensions,transitionHeight,fadeOutCallback,fadeInCallback);setupTransition(frameContainer,frame.contentDocument,fader,noFadeOut)},transitionProperty:function(element,property,options,callback){if(options.from===undefined||options.to===undefined||options.duration===undefined){throw new Error("from, to and duration options must be passed in")}var easing=options.easing||"ease-out";var tinfo=dom.getTransitionInfo(element.ownerDocument);if(!tinfo){element.style[property]=options.to;callback();return}var tprop=tinfo.property;element.style[tprop]="none";element.style[property]=options.from;element.style[tprop]=property+" "+options.duration+"ms "+easing;element.style[property];setTimeout(function(){element.style[property]=options.to;setTimeout(callback,options.duration)},20)}}},{"./dom":32}],20:[function(require,module,exports){var dom=require("./dom");var events=require("./events");function createTimeline(mq,_container,_renderer,_options,_emitter){var renderer=_renderer;var container=_container;var adEventsEmitter=_emitter;var animationEventsEmitter=events.createEmitter();var oldCurrentTime;var mainTimeline=null;var editorIsPlaying=false;var data=mq.animationTimeline;killTimeline(mainTimeline);var videoTweens=[];var pausedByVisibility=false;events.addGlobalListener("pagevisibility",function(hidden){if(!timelineObject||!mainTimeline){return}if(!hidden&&pausedByVisibility){timelineObject.play();pausedByVisibility=false}else if(hidden&&timelineObject.isPlaying()){timelineObject.pause();pausedByVisibility=true}});container.getAdWindow()._gsDefine&&container.getAdWindow()._gsDefine.plugin({propName:"video",priority:0,API:2,version:"1.0.0",overwriteProps:[],init:function(target,value,tween,index){this._target=target;this._value=value;this._tween=tween;this._videoEl=renderer.getElementById(this._target.id);var seeking=false;var waiting=false;this._videoEl.onWaiting(function(ev){if(mainTimeline.paused()){return}mainTimeline.pause();waiting=true});this._videoEl.onSeeking(function(){if(mainTimeline.paused()){return}mainTimeline.pause();seeking=true});this._videoEl.onSeeked(function(){if(seeking){seeking=false;if(mainTimeline.time()<mainTimeline.duration()){mainTimeline.resume()}}});this._videoEl.onPlaying(function(){if(waiting){waiting=false;if(mainTimeline.time()<mainTimeline.duration()){mainTimeline.resume()}}});if(tween._prev.vars.video&&tween._prev.vars.video===value){return false}this.pauseVideo=function(){this._videoEl.pause()};this._syncVideo=function(ratio){var timeDiff=Math.abs(this._videoEl.getCurrentTime()-this._value*ratio);if(timeDiff>.5){this._videoEl.setCurrentTime(this._value*ratio);this._videoEl.play();this._chromeEndFix()}};this._chromeEndFix=function(){if(this._videoEl.getCurrentTime()>=this._videoEl.getDuration()&&!this._videoEl.getEnded()){this._videoEl.play()}};if(this._videoEl.previewRenditionPlaying()){mainTimeline.pause()}else{this._videoEl.pause()}videoTweens.push(this);return true},set:function(ratio){var inPlayMode=editorIsPlaying||this._tween.isActive();if(inPlayMode&&this._videoEl.paused&&ratio<1){this._syncVideo(ratio);this._videoEl.play()}else if(!inPlayMode&&this._videoEl.paused){this._videoEl.editorSetCurrentTime(this._value*ratio);if(ratio===1){this._videoEl.editorRunPauseEvents()}}else{this._syncVideo(ratio)}if(ratio===1&&!this._videoEl.paused){this._videoEl.setCurrentTime(this._value*ratio);this._chromeEndFix();if(this._videoEl.getCurrentTime()+.3<this._videoEl.getDuration()){this._videoEl.pause()}}}});var timelineObject={hasKeyframes:function(elementId){return data&&data.enabled&&data.elements.some(function(el){return el.id===elementId})},run:function(){if(!data||!container){return}if(data.enabled!==false){videoTweens=[];mainTimeline=createTimelineMax(_options,container.getAdWindow());this.update(null,data,container.getAdWindow());if(_options.screenshot===true){this.update(mainTimeline.duration()*1e3,null,container.getAdWindow())}}},play:function(){if(!mainTimeline){this.run()}else{mainTimeline.resume()}},isPaused:function(){return mainTimeline.paused()},isPlaying:function(){return mainTimeline.isActive()},pause:function(){if(!mainTimeline){return}mainTimeline.pause();videoTweens.forEach(function(v){v.pauseVideo()})},restart:function(){if(mainTimeline){mainTimeline.restart()}},seek:function(seconds){if(mainTimeline){mainTimeline.seek(Math.max(0,mainTimeline.time()+seconds))}},setTime:function(seconds){if(!mainTimeline){return}if(seconds!=null){mainTimeline.seek(seconds)}updateFunction()},getCurrentTime:function(){if(mainTimeline){return mainTimeline.time()}},setProgress:function(value){if(mainTimeline){mainTimeline.progress(value)}},editorSetPlaying:function(isPlaying){editorIsPlaying=isPlaying},destroy:function(){killTimeline(mainTimeline);animationEventsEmitter.removeAllListeners()},update:function(currentTime,data,hwnd){if(!mainTimeline&&mq.animationTimeline&&mq.animationTimeline.enabled!==false){videoTweens=[];mainTimeline=createTimelineMax(_options,container.getAdWindow());updateTimeline(mq.animationTimeline,mainTimeline,hwnd)}if(data&&data.enabled!==false){updateTimeline(data,mainTimeline,hwnd)}setTimelineTime(mainTimeline,currentTime);if(data&&data.elements){data.elements.forEach(function(item){var element=renderer.getElementById(item.id);if(element&&element.updateShrink){element.updateShrink({contentUpdated:false})}})}},onAnimationEvent:function(callback){animationEventsEmitter.addListener("keyframeEvent",callback)},invalidate:function(){if(mainTimeline){mainTimeline.invalidate()}}};return timelineObject;function getEasing(key,hwnd){if(key&&key.ease){var easeIndex=key.ease.split(".");if(easeIndex.length===2&&hwnd[easeIndex[0]]&&hwnd[easeIndex[0]][easeIndex[1]]){return hwnd[easeIndex[0]][easeIndex[1]]}}return hwnd.Linear.easeNone}function toPixels(value,comparison){if(value.unit==="px"){return value}return{unit:"px",value:value.value/100*comparison}}function toPercentage(from,relativeTo){if(from.unit==="%"){return from}return{value:(from.value/relativeTo*100).toFixed(2),unit:"%"}}function applyPositionMultiplier(val,comp,axis){var positionValue=val.value;if(val.unit==="*"&&comp.unit==="px"){var size=container.getContentDimensions();positionValue=size[axis]*(val.value/100)}return{unit:comp.unit,value:val.unit!=="*"?positionValue:positionValue+comp.value}}function applySizeMultiplier(val,comp){return{unit:comp.unit,value:val.unit!=="*"?val.value:val.value*comp.value}}function getValueString(keyVal){if(keyVal.value===""){return""}var valueString=keyVal.value;if(keyVal.unit){valueString+=keyVal.unit}return valueString}function calculateAnchoredPosition(styles,fromAnchor,targetAnchor,toUnits){if(!toUnits){toUnits={x:"px",y:"px"}}var containerSize=renderer.getParentSize(styles);var elSize=renderer.calculateDimensions(styles,containerSize);var targetPos=toTopLeftPx(styles,fromAnchor,elSize,containerSize);if(targetAnchor.x==="right"){targetPos.x.value=containerSize.width-(targetPos.x.value+elSize.width.value)}if(targetAnchor.y==="bottom"){targetPos.y.value=containerSize.height-(targetPos.y.value+elSize.height.value)}if(toUnits.x=="%"){targetPos.x=toPercentage(targetPos.x,containerSize.width)}if(toUnits.y=="%"){targetPos.y=toPercentage(targetPos.y,containerSize.height)}return targetPos}function toTopLeftPx(pos,anchor,ownSize,containerSize){var x={value:"",unit:"px"};var y={value:"",unit:"px"};if(anchor.x==="center"){x.value=containerSize.width/2-ownSize.width.value/2}else{x.value=toPixels(pos.x,containerSize.width).value}if(anchor.y==="center"){y.value=containerSize.height/2-ownSize.height.value/2}else{y.value=toPixels(pos.y,containerSize.height).value}if(anchor.x==="right"){x.value=containerSize.width-ownSize.width.value-x.value}if(anchor.y==="bottom"){y.value=containerSize.height-ownSize.height.value-y.value}return{x:x,y:y}}function createPositionObject(key,baseStyles){var result={};var multiplierAnchor={x:"center",y:"center"};if(key.value.left.value!==""){multiplierAnchor.x="left"}else if(key.value.right.value!==""){multiplierAnchor.x="right"}if(key.value.top.value!==""){multiplierAnchor.y="top"}else if(key.value.bottom.value!==""){multiplierAnchor.y="bottom"}var comparisonPos=calculateAnchoredPosition(baseStyles,baseStyles.anchor,multiplierAnchor);if(multiplierAnchor.x!=="center"){comparisonPos.x=applyPositionMultiplier(key.value[multiplierAnchor.x],comparisonPos.x,"width")}if(multiplierAnchor.y!=="center"){comparisonPos.y=applyPositionMultiplier(key.value[multiplierAnchor.y],comparisonPos.y,"height")}result.marginLeft="";result.marginRight="";result.marginBottom="";result.marginTop="";result.left=result.top=result.right=result.bottom=0;result.x=getValueString(comparisonPos.x);result.y=getValueString(comparisonPos.y);return result}function createSizeObject(key,domEl,elementStyles){var result={};var clonedStyles=dom.Object.clone(elementStyles);if(key.value.maxWidth){clonedStyles.maxWidth=key.value.maxWidth}if(key.value.maxHeight){clonedStyles.maxHeight=key.value.maxHeight}if(key.value.width.value==="auto"){clonedStyles.height=applySizeMultiplier(key.value.height,elementStyles.height);result.width=renderer.getDynamicSize(clonedStyles,"width")}else{result.width=getValueString(applySizeMultiplier(key.value.width,elementStyles.computedSize.width))}if(key.value.height.value==="auto"){clonedStyles.width=applySizeMultiplier(key.value.width,elementStyles.width);result.height=renderer.getDynamicSize(clonedStyles,"height")}else{result.height=getValueString(applySizeMultiplier(key.value.height,elementStyles.computedSize.height))}return result}function addSizeRelatedObject(keyObject,elementStyles){var s=elementStyles.buttonWidget;if(!s){return}if(s.borderRadius!==undefined){keyObject.borderRadius=calculateStyleLength(s.borderRadius,keyObject.width)}if(s.borderWidth!==undefined){keyObject.borderWidth=calculateStyleLength(s.borderWidth,keyObject.width)}if(s.paddingTop!==undefined){keyObject.paddingTop=calculateStyleLength(s.paddingTop,keyObject.height)}if(s.paddingRight!==undefined){keyObject.paddingRight=calculateStyleLength(s.paddingRight,keyObject.width)}if(s.paddingBottom!==undefined){keyObject.paddingBottom=calculateStyleLength(s.paddingBottom,keyObject.height)}if(s.paddingLeft!==undefined){keyObject.paddingLeft=calculateStyleLength(s.paddingLeft,keyObject.width)}}function calculateStyleLength(vu,elementLength){var length;if(!vu){length=undefined}else if(vu.unit==="%"){var elementValue=parseInt(elementLength);length=elementValue*vu.value/100+"px"}else{length=vu.value+vu.unit}return length}function updateTimeline(data,timeline,hwnd){if(!timeline||!data||!data.elements){return}timeline.clear();oldCurrentTime=0;if(data.repeat){timeline.repeat(data.repeat)}for(var i=0;i<=data.elements.length-1;i++){var item=data.elements[i];if(item.id==="internal:events"){timeline.add(prepareEventsTimeline(hwnd,item),0);continue}var itemTimeline=prepareItemTimeline(hwnd,item);if(itemTimeline&&renderer.areAncestorsVisible(item.id)){timeline.add(itemTimeline,0)}}}function prepareEventsTimeline(hwnd,item){var tl=new hwnd.TimelineMax;var eventsProp=item.properties.find(function(p){return p.name==="Events"});if(!eventsProp){console.log("Events timeline is missing the Events property");return tl}eventsProp.keys.forEach(function(key){if(key.value.length===0){return}tl.call(function(data){animationEventsEmitter.emit("keyframeEvent",data)},[key.value],{},key.time)});return tl}function prepareItemTimeline(hwnd,item){var element=renderer.getElementById(item.id);var elementStyles=renderer.getElementStyles(item.id);if(!item||!element||!elementStyles.visible){return}var domEl=element.domNode;delete domEl._gsTransform;var itemTimeline=new hwnd.TimelineMax;var properties=item.properties.find(function(p){return p.name==="position"});if(properties&&properties.keys.length===0){var basePosition={x:"-50%",y:"-50%",parseTransform:true};if(elementStyles.anchor.x!=="center"){basePosition.x=undefined;basePosition[elementStyles.anchor.x]=elementStyles.x.value+elementStyles.x.unit}if(elementStyles.anchor.y!=="center"){basePosition.y=undefined;basePosition[elementStyles.anchor.y]=elementStyles.y.value+elementStyles.y.unit}itemTimeline.set(domEl,basePosition)}for(var j=item.properties.length-1;j>=0;j--){var prop=item.properties[j];var propertyTimeline=new hwnd.TimelineMax;itemTimeline.add(propertyTimeline,0);if(!prop.keys.length){continue}prop.keys=prop.keys.sort(function(key1,key2){return key1.time-key2.time});var firstKey=prop.keys[0];if(firstKey){var firstkeyObject={};if(prop.name==="position"){firstkeyObject=createPositionObject(firstKey,elementStyles)}else if(prop.name==="size"){firstkeyObject=createSizeObject(firstKey,domEl,elementStyles);addSizeRelatedObject(firstkeyObject,elementStyles)}else if(prop.name==="video"){firstkeyObject={video:firstKey.value}}else{if(prop.name==="opacity"){if(prop.value===0){firstkeyObject.display="none"}else{firstkeyObject.display=""}}firstkeyObject[prop.name]=getValueString(firstKey);firstkeyObject.immediateRender=true}var firstTween=hwnd.TweenMax.set(domEl,firstkeyObject);propertyTimeline.add(firstTween,firstKey.time);if(firstKey.time!==0&&prop.name!=="video"){propertyTimeline.add(firstTween,0)}}for(var k=0;k<=prop.keys.length-1;k++){var key=prop.keys[k];if(k<prop.keys.length-1){var nextKey=prop.keys[k+1];var keyObject={};var duration=nextKey.time-key.time;var time=key.time;if(prop.name==="position"){keyObject=Object.assign(keyObject,createPositionObject(nextKey,elementStyles))}else if(prop.name==="size"){keyObject=Object.assign(keyObject,createSizeObject(nextKey,domEl,elementStyles));addSizeRelatedObject(keyObject,elementStyles)}else if(prop.name==="video"){keyObject={video:nextKey.value}}else{if(prop.name==="opacity"){if(nextKey.value===0){keyObject.display="none"}else{keyObject.display=""}}keyObject[prop.name]=getValueString(nextKey)}keyObject.ease=getEasing(nextKey,hwnd);if(nextKey.ease==="Linear.instant"){time=nextKey.time;duration=0;keyObject.immediateRender=false}var tween=hwnd.TweenMax.to(domEl,duration,keyObject);propertyTimeline.add(tween,time)}}}var shrinkableElementsIds=[];var isShrinkable=function(elStyles){if(elStyles.updateShrink){shrinkableElementsIds.push(elStyles.id)}renderer.getElementChildren(elStyles.id).forEach(function(elStyles){isShrinkable(elStyles)})};isShrinkable(element);if(shrinkableElementsIds&&shrinkableElementsIds.length>=1){itemTimeline.eventCallback("onUpdate",function(){shrinkableElementsIds.forEach(function(elId){var el=renderer.getElementById(elId);el.updateShrink({contentUpdated:false})})})}return itemTimeline}function killTimeline(timeline){if(timeline){timeline.clear();timeline.kill();timeline=null}}function onPageScroll(){var percentageIn=_container.getOnScreenPercentage(_options.parallaxStartStop);if(mainTimeline){mainTimeline.progress(percentageIn)}}function onVisibilityChange(isVisible){if(isVisible&&mainTimeline){mainTimeline.restart()}}function updateFunction(){adEventsEmitter.emit("animationUpdate",{time:mainTimeline.time(),progress:mainTimeline.progress(),active:mainTimeline.isActive(),duration:mainTimeline.duration()})}function createTimelineMax(options,hwnd){if(options.parallax){options.paused=true;container.onPageScroll(onPageScroll)}if(options.restartOnScrollIntoView&&!options.parallax&&!options.screenshot){container.onVisibilityChange(onVisibilityChange)}if(hwnd.TimelineMax){var timeline=new hwnd.TimelineMax(options);timeline.eventCallback("onUpdate",updateFunction);return timeline}}function setTimelineTime(timeline,currentTime){if(oldCurrentTime==0||oldCurrentTime!=currentTime&&timeline){timeline.seek(currentTime/1e3,false);oldCurrentTime=currentTime}}}module.exports={create:function(mq,_container,_renderer,_options,emitter){return createTimeline(mq,_container,_renderer,_options,emitter)}}},{"./dom":32,"./events":52}],21:[function(require,module,exports){var scriptLoader=require("./scriptLoader.js");var imageLoader=require("./imageLoader.js");var async=require("./async.js");var dom=require("./dom");var config=require("./config");var log=require("./log");var webfontLoader=require("./webfontLoader");var device=require("./device");function createLoader(container){var pageScripts={};var scripts={};var loadIndex=0;var embededMonotypeFontCSSStrings={};var googleFontsPromises={};return{load:function(assets,callback){var loadCallbackCalled=false;loadIndex++;var currentLoadIndex=loadIndex;var otherFonts=(assets.fonts||[]).filter(function(font){return font.fontProvider!=="google"});var document=container.getAdDocument();if(otherFonts.length>0&&assets.monotypeImportCSSString&&!embededMonotypeFontCSSStrings[assets.monotypeImportCSSString]){var monotype=dom.createStylesheet(document,assets.monotypeImportCSSString);document.body.appendChild(monotype);embededMonotypeFontCSSStrings[assets.monotypeImportCSSString]=true}var tasks=[stylesheetTask,fontTask,microAnimationCSSTask].concat(createImageTasks()).concat(createPageScriptTasks()).concat(createScriptTasks());async.all(tasks,function(err){if(currentLoadIndex!==loadIndex){return}if(!loadCallbackCalled){loadCallbackCalled=true;callback(err)}});function stylesheetTask(cb){container.loadStylesheetToPage(assets.flowline,cb)}function microAnimationCSSTask(cb){if(assets.microAnimationCSS){container.loadStylesheetToCreative(assets.microAnimationCSS,cb)}else{cb()}}function fontTask(cb){if(!assets.fonts||assets.fonts.length<1){cb(null);return}loadWebFont(container,function(WebFont){fontCssTask(WebFont,function(err){if(err){cb(err);return}fontFileTask(WebFont,function(err){cb(err)})})})}function fontCssTask(WebFont,cb){async.all([function(eachCb){loadUploadedFonts(eachCb)},function(eachCb){loadGoogleFonts(WebFont,eachCb)}],cb)}function loadUploadedFonts(cb){var fonts=(assets.fonts||[]).filter(function(v){return v.fontType==="upload"});var tasks=fonts.map(function(font){var task=function(eachCb){webfontLoader.load(document,font,eachCb)};return task});async.all(tasks,cb)}function loadGoogleFonts(WebFont,callback){var fonts=(assets.fonts||[]).filter(function(font){return font.fontProvider==="google"});if(fonts.length===0){callback();return}var families=fonts.map(function(font){if(font.fontProvider==="google"&&font.variationKey){var family=font.fontFamily+":"+font.variationKey;var deviceProps=device.getDeviceProperties(window);var isMobileSafari=deviceProps.isMobile&&deviceProps.isSafari;if(isMobileSafari&&font.bolderVariationKey){family+=","+font.bolderVariationKey}return family}return font.fontFamily});var loadingFamilyPromises=families.map(function(fontFamily){if(!googleFontsPromises[fontFamily]){googleFontsPromises[fontFamily]=_load(fontFamily)}return function(done){googleFontsPromises[fontFamily].then(done)}});async.all(loadingFamilyPromises,callback);return;function _load(fontFamily){return async.defer(function(done){WebFont.load({google:{families:[fontFamily]},fontactive:function(f){done(null,f)},fontinactive:function(f){log.log("Following Google Fonts failed to load: "+fontFamily);done(null,f)}})})}}function fontFileTask(WebFont,cb){var fonts=assets.fonts;if(!fonts||fonts.length<1){cb(null);return}var defers=fonts.map(function(font){return function(eachCb){if(/^monotype/.test(font.fontProvider)){eachCb(null)}var fontFamily=font.fontFamily;WebFont.load({active:function(){eachCb(null)},custom:{families:[fontFamily]},context:container.getAdDocument().defaultView,inactive:function(){console.warn(new Error('Failed to load font "'+fontFamily+'"'));eachCb(null)}})}});async.all(defers,function(err){cb(err)})}function createImageTasks(){return(assets.images||[]).map(function(image){return function(cb){imageLoader.load(image,container.getAdDocument(),cb)}})}function createPageScriptTasks(){return(assets.pageScripts||[]).map(function(scriptUrl){return function(cb){if(pageScripts[scriptUrl]){pageScripts[scriptUrl].then(cb);return}var deferred=async.defer(function(cb){scriptLoader.load(scriptUrl,window.document,cb)});pageScripts[scriptUrl]=deferred;deferred.then(cb)}})}function createScriptTasks(){return(assets.scripts||[]).map(function(scriptUrl){return function(cb){if(scripts[scriptUrl]){scripts[scriptUrl].then(cb);return}var deferred=async.defer(function(cb){scriptLoader.load(scriptUrl,container.getAdDocument(),cb)});scripts[scriptUrl]=deferred;deferred.then(cb)}})}function loadWebFont(container,callback){var adWindow=container.getAdWindow();if(adWindow.WebFont){callback(adWindow.WebFont);return}var webfontLoaderUrl=config[assets.protocol].webfontLoader;if(container.getAdOptions().skipResolvingScripts){return callback(adWindow.WebFont)}else{scriptLoader.load(webfontLoaderUrl,container.getAdDocument(),function(){callback(adWindow.WebFont)})}}}}}module.exports={loaderForContainer:createLoader}},{"./async.js":23,"./config":26,"./device":31,"./dom":32,"./imageLoader.js":61,"./log":65,"./scriptLoader.js":74,"./webfontLoader":84}],22:[function(require,module,exports){var element=require("../element");var dom=require("./dom");var url=require("./url");var config=require("./config");function resolveFlowlineFromSettings(settings){if(!settings.flowline||settings.export===true){return undefined}if(settings.fallbacksEnabled){return resolveFallbackFlowline(settings.flowline,settings.id,settings.flSource)}return resolveFlowline(settings.flowline,settings.flSource)}function resolveFallbackFlowline(flowlineId,adId,flowlineSource){return flowlineSource+adId+"/fallbacks/fallback-"+flowlineId+".css"}function resolveFlowline(flowlineId,flowlineSource){return flowlineSource+flowlineId+"/rad-fl-"+flowlineId+".css"}function visibleElementIds(mq){var ids=[];for(var elId in mq.elements){if(mq.elements[elId].visible&&parentsVisible(elId,mq.elements)){ids.push(elId)}}return ids}function parentsVisible(elementId,elements){var parentId=elements[elementId].parentId;if(!parentId){return true}return elements[parentId].visible&&parentsVisible(parentId,elements)}function resolveImages(elements,imageIds,imageButtonIds){return imageIds.map(function(id){return elements[id]&&!elements[id].image.renditions?elements[id].image.src:null}).concat(imageButtonIds.reduce(function(prev,id){if(!elements[id]){return null}var el=elements[id].imageButtonWidget;prev.push(el.image,el.hoverImage,el.activeImage);return prev},[])).filter(Boolean)}function getProto(adSettings){return adSettings.export?"export":adSettings.https?"https":"http"}function fontScriptURL(monotypeImportCSSString,adSettings){if(!monotypeImportCSSString){return}var proto=config[getProto(adSettings)].externalAssetsProtocol;return monotypeImportCSSString.replace('url("//','url("'+proto+"://")}function resolveScripts(adSettings,visibleElementIds,hasTimeline){if(adSettings.skipResolvingScripts){return[]}var hasCarousel=!!visibleElementIds.find(function(elId){return adSettings.activeConfig.elements[elId].type===element.types.CAROUSEL_WIDGET});var hasOmnivirt=!!visibleElementIds.find(function(elId){return adSettings.activeConfig.elements[elId].type===element.types.OMNIVIRT});var proto=getProto(adSettings);var scripts=[];if(hasCarousel){scripts.push(config[proto].externalLibs+"gsap/latest/plugins/CSSPlugin.min.js")}if(hasCarousel||hasTimeline){scripts.push(config[proto].externalLibs+"gsap/latest/TweenMax.min.js")}if(hasOmnivirt){scripts.push("//cdn.omnivirt.com/scripts/embed.js")}if(adSettings.activeConfig.externalAssets){adSettings.activeConfig.externalAssets.forEach(function(asset){scripts.push(config[proto].externalLibs+asset)})}return scripts}function resolveFontsByElementIds(mq,elIds){return elIds.reduce(function(resolvedFonts,elId){const elStyles=mq.elements[elId];if(!elStyles){return resolvedFonts}const allFonts=Object.values(elStyles.fonts||[]);if(elStyles.fontSettings){allFonts.push(elStyles.fontSettings)}const elementFontSettings=allFonts.map(function(fontSettings){return{fontFamily:fontSettings.fontFamily,displayName:fontSettings.displayName,fontProvider:fontSettings.fontProvider,monotypeVariationId:fontSettings.monotypeVariationId,variationKey:fontSettings.variationKey,bolderVariationKey:fontSettings.bolderVariationKey,fontType:fontSettings.fontType,import:fontSettings.import}}).filter(function(f){return!!f.fontProvider});return resolvedFonts.concat(elementFontSettings)},[])}function resolveFonts(mediaquery){var visibleEls=visibleElementIds(mediaquery);return resolveFontsByElementIds(mediaquery,visibleEls)}function getStages(elements,ids){var stages={};ids.forEach(function(elId){var data=elements[elId];var stageName="stage"+(typeof data.stage!=="undefined"?data.stage:0);if(!stages[stageName]){stages[stageName]=[]}stages[stageName].push(elId)});return stages}function elementHasMicroAnimation(el){for(const property in el){if(Array.isArray(el[property])){var actions=el[property];if(actions.some(e=>e.action==="microanimation")){return true}}if(property==="elementEvents"){for(const elProp in el.elementEvents){if(Array.isArray(el.elementEvents[elProp])){var actions=el.elementEvents[elProp];if(actions.some(e=>e.action==="microanimation")){return true}}}}}}module.exports={resolveForMediaquery:function(adSettings,mediaquery){if(!mediaquery){throw new TypeError("Mediaquery not defined")}if(!adSettings.activeConfig){throw new Error("No activeConfig. You probably passed the wrong settings object")}var elementSettings=adSettings.activeConfig.elements;var imageIds=[];var imageButtonIds=[];var loadYouTube=false;var loadAdsonicaComponent=false;var loadMicroAnimationsCSSFile=false;for(var elId in elementSettings){var elType=elementSettings[elId].type;if(elType===element.types.IMAGE){imageIds.push(elId)}else if(elType===element.types.IMAGE_BUTTON_WIDGET){imageButtonIds.push(elId)}else if(elType===element.types.YOUTUBE_WIDGET){loadYouTube=true}else if(elType===element.types.ADSONICA_COMPONENT){loadAdsonicaComponent=true}if(!loadMicroAnimationsCSSFile&&elementHasMicroAnimation(elementSettings[elId])){loadMicroAnimationsCSSFile=true}}var pageScripts=[];if(loadYouTube){pageScripts.push(config[getProto(adSettings)].youtubeExternalApi)}if(loadAdsonicaComponent){pageScripts.push(config[getProto(adSettings)].adsonicaComponentExternalApi)}var visibleElIds=visibleElementIds(mediaquery);var hasTimeline=mediaquery.hasOwnProperty("animationTimeline")&&mediaquery.animationTimeline.enabled;var stages={stage0:{flowline:resolveFlowlineFromSettings(adSettings),fonts:resolveFonts(mediaquery),protocol:getProto(adSettings),monotypeImportCSSString:fontScriptURL(adSettings.activeConfig.monotypeImportCSSString,adSettings),pageScripts:pageScripts,scripts:resolveScripts(adSettings,visibleElIds,hasTimeline),microAnimationCSS:loadMicroAnimationsCSSFile?config.microAnimationCSS:null}};var idsByStage=getStages(elementSettings,visibleElIds);Object.keys(idsByStage).forEach(function(stage){var ids=idsByStage[stage];var elementsForStage={};ids.forEach(function(id){elementsForStage[id]=adSettings.activeConfig.elements[id]});var visibleImageIds=visibleElIds.filter(function(id){return imageIds.indexOf(id)!==-1});var visibleImageButtonIds=visibleElIds.filter(function(id){return imageButtonIds.indexOf(id)!==-1});if(!stages[stage]){stages[stage]={}}stages[stage].images=resolveImages(elementsForStage,visibleImageIds,visibleImageButtonIds).map(function(imgUrl){return url.toFullUrl(imgUrl,adSettings)})});return stages},resolveFlowline:resolveFlowline,resolveForInitialLoad:function(adSettings){if(!adSettings.activeConfig){throw new Error("No activeConfig. You probably passed the wrong settings object")}return{flowline:resolveFlowlineFromSettings(adSettings)}},resolveFontsForMediaquery:resolveFonts,resolveFontsByElementIds:resolveFontsByElementIds}},{"../element":6,"./config":26,"./dom":32,"./url":79}],23:[function(require,module,exports){var dom=require("./dom");module.exports.forEach=function(values,iterator,callback){var index=0;next();function next(){var value=values[index];if(!value){if(callback){callback()}return}iterator(next,value,index,values);index++}};module.exports.all=function(funcs,callback){var waiting=funcs.length;var results=[];if(funcs.length<1){callback(null,results);return}funcs.forEach(function(func,index){func(function(err,result){waiting--;results[index]=result;if(waiting==0||err){callback(err,results);return}})})};module.exports.defer=function(func){var callbacks=[];var deferred={then:function(callback){callbacks.push(callback)}};if(func){func(done)}else{deferred.done=done}return deferred;function done(err,res){callbacks.forEach(function(cb){cb(err,res)});deferred.then=function(cb){cb(err,res)}}}},{"./dom":32}],24:[function(require,module,exports){module.exports={supportsMediaqueries:function(window){return typeof window.matchMedia!="undefined"||typeof window.msMatchMedia!="undefined"}}},{}],25:[function(require,module,exports){module.exports={getValueColumnByName:function(table,row,columnName){for(var i=0;i<table.valueColumns.length;i++){var definition=table.valueColumns[i];if(definition.name&&definition.name.toLowerCase()===columnName.toLowerCase()){return row.values[i]}}return null},getColumnDataByType:function(table,columnType){var columnIndexes=table.conditionColumns.concat(table.valueColumns).map(function(col,index){return{type:col.type,index:index}}).filter(function(col){return col.type===columnType}).map(function(col){return col.index});return table.rows.map(function(row){return row.conditions.concat(row.values).filter(function(r,index){return columnIndexes.indexOf(index)!==-1}).map(function(row){return row})}).reduce(function(accum,item){return accum.concat(item)},[])}}},{}],26:[function(require,module,exports){module.exports=Object.assign({http:{adSource:"http://publish.responsiveads.com/ads/",jsSource:"http://publish.responsiveads.com/libs/",flSource:"http://publish.responsiveads.com/flowlines/",analytics:"http://analytics.responsiveads.com/",webfontLoader:"http://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js",externalLibs:"http://publish.responsiveads.com/libs/external/",externalLibsGDN:"http://cdnjs.cloudflare.com/ajax/libs/",externalVideoPoster:"http://publish.responsiveads.com/tool_assets/VideoControls/standard_poster.png",externalVideoInitialize:"http://publish.responsiveads.com/tool_assets/videoExtras/video-initialize.gif",externalAssetsProtocol:"http",youtubeExternalApi:"http://www.youtube.com/iframe_api",adsonicaComponentExternalApi:"https://publish.responsiveads.com/tool_assets/Adsonica/v3.11.0/adsonicaDecode.min.js"},https:{adSource:"https://publish.responsiveads.com/ads/",jsSource:"https://publish.responsiveads.com/libs/",flSource:"https://publish.responsiveads.com/flowlines/",analytics:"https://analytics.responsiveads.com/",webfontLoader:"https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js",externalLibs:"https://publish.responsiveads.com/libs/external/",externalLibsGDN:"https://cdnjs.cloudflare.com/ajax/libs/",externalVideoPoster:"https://publish.responsiveads.com/tool_assets/VideoControls/standard_poster.png",externalVideoInitialize:"https://publish.responsiveads.com/tool_assets/videoExtras/video-initialize.gif",externalAssetsProtocol:"https",youtubeExternalApi:"https://www.youtube.com/iframe_api",adsonicaComponentExternalApi:"https://publish.responsiveads.com/tool_assets/Adsonica/v3.11.0/adsonicaDecode.min.js"},export:{adSource:"assets/",jsSource:"libs/",flSource:"flowlines/",analytics:"https://analytics.responsiveads.com/",webfontLoader:"libs/webfont/1.6.28/webfontloader.js",externalLibs:"libs/external/",externalLibsGDN:"https://cdnjs.cloudflare.com/ajax/libs/",externalVideoPoster:"tool_assets/VideoControls/standard_poster.png",externalVideoInitialize:"tool_assets/videoExtras/video-initialize.gif",externalAssetsProtocol:"https",youtubeExternalApi:"https://www.youtube.com/iframe_api",adsonicaComponentExternalApi:"libs/external/adsonica/v3.11.0/adsonicaDecode.min.js"}},"production"==="production"?require("./config/production.js"):require("./config/dev.js"))},{"./config/dev.js":undefined,"./config/production.js":27}],27:[function(require,module,exports){module.exports={weatherApiZipCode:"https://zldagevqaf.execute-api.us-east-1.amazonaws.com/zipcode",microAnimationCSS:"https://publish.responsiveads.com/libs/radical.animations.v1.min.css"}},{}],28:[function(require,module,exports){var dom=require("./dom");var visibility=require("./visibility");var stylesheetLoader=require("./stylesheetLoader");var events=require("./events");var device=require("./device");var placementOverride=require("./placementOverride");function dynamicContainer(adTagOptions,adWindow,crsorg){var gamPreviewPage=crsorg?false:adWindow.location.href.indexOf("partner.googleadservices.com")>-1?true:false;var adTagSizes;var orientationChange=false;var selectedSize;var adSlotType;var matchingSize;adTagSizes=adTagOptions.sizes;adTagSizes=adTagSizes.filter(function(x,i,a){return a.indexOf(x)==i});var sizeConfiguration={"970x250":{fluid:false},"970x90":{fluid:false},"728x90":{fluid:false},"450x450":{fluid:true,ratio:(450/450).toFixed(2)},"450x75":{fluid:true,ratio:(450/75).toFixed(2)},"320x50":{fluid:false},"300x600":{fluid:false},"300x250":{fluid:false}};var adSlotTypes=["mobiletopbanner","topbanner","topbox","bottombox","marketing","olympicsbox","bottombanner","mobilemultibox"];var adSlotTypeData={mobiletopbanner:{possibleSizes:["450x75","320x50"]},topbanner:{possibleSizes:["970x250","970x90","728x90"]},topbox:{possibleSizes:["300x600","450x450","300x250"]},bottombox:{possibleSizes:["300x600","450x450","300x250"]},marketing:{possibleSizes:["970x250","970x90","728x90"]},olympicsbox:{possibleSizes:["450x450","300x250"]},worldcupbox:{possibleSizes:["300x250"]},bottombanner:{possibleSizes:["970x250","970x90","728x90"]},mobilemultibox:{possibleSizes:["450x450","300x250"]}};var adSlot=adWindow.frameElement?adWindow.frameElement.parentNode.parentNode:undefined;if(adSlot){for(var i=0;i<adSlotTypes.length;i++){if(adSlot.id.indexOf(adSlotTypes[i])>-1){adSlotType=adSlotTypes[i];break}}if(!adSlotType){if(gamPreviewPage){var divElements=parent.document.body.getElementsByTagName("div");var sizeElement=divElements[divElements.length-1];adWindow.frameElement.parentNode.style.setProperty("width",sizeElement.style.width,"important");adWindow.frameElement.parentNode.style.setProperty("height",sizeElement.style.height,"important");var frame=adWindow.frameElement;frame.style.setProperty("width",sizeElement.style.width,"important");frame.style.setProperty("height",sizeElement.style.height,"important")}else{var appSlotHeight;var appSlotWidth;var currentDimensions=dom.getWindowSize(adWindow);var comps=adWindow.getComputedStyle(adWindow.parent.document.body);var divElements=adWindow.parent.document.body.getElementsByTagName("div");var sizeElement=divElements[divElements.length-1];var parentSizeHeight=0;var parentSizeWidth=0;var bodyAr=comps.getPropertyValue("aspect-ratio");if(bodyAr==="auto"){parentSizeWidth=parseInt(sizeElement.style.width,10);parentSizeHeight=parseInt(sizeElement.style.height,10)}else{var parentWidth=adWindow.parent.document.body.offsetWidth;if(parentWidth===0){parentWidth=adWindow.parent.screen.width}if(bodyAr=="1 / 1"){parentSizeWidth=parentWidth;parentSizeHeight=parentWidth}else if(bodyAr=="6 / 1"){parentSizeWidth=parentWidth;parentSizeHeight=parentWidth/6}}if(parentSizeWidth==300){appSlotWidth=300;appSlotHeight=250}else if(parentSizeWidth==320){appSlotWidth=320;appSlotHeight=50}else{appSlotWidth=parentSizeWidth;appSlotHeight=parentSizeHeight}if(appSlotWidth!==0){adWindow.frameElement.style.setProperty("height",appSlotHeight+"px","important");adWindow.frameElement.style.setProperty("width",appSlotWidth+"px","important");adWindow.frameElement.parentNode.style.setProperty("height",appSlotHeight+"px","important");adWindow.frameElement.parentNode.style.setProperty("width",appSlotWidth+"px","important");adWindow.frameElement.parentNode.parentNode.style.setProperty("height",appSlotHeight+"px","important");adWindow.frameElement.parentNode.parentNode.style.setProperty("width",appSlotWidth+"px","important")}else{}}return}var possibleSizes=adSlotTypeData[adSlotType].possibleSizes;loop1:for(var i=0;i<possibleSizes.length;i++){loop2:for(var j=0;j<adTagSizes.length;j++){if(adTagSizes[j]==possibleSizes[i]){matchingSize=possibleSizes[i];break loop1}}}if(matchingSize){if(adSlotType=="topbanner"){return}selectedSize=sizeConfiguration[matchingSize];var dimensions=matchingSize.split("x");var parentWidth;var height;var width;if(selectedSize.fluid&&adSlotType.indexOf("mobile")>-1){if(adSlotType=="mobilemultibox"){parentWidth=adWindow.frameElement.parentNode.parentNode.parentNode.clientWidth}else{parentWidth=parent.document.body.clientWidth}width=parentWidth;height=parentWidth/selectedSize.ratio;if(width>dimensions[0]){width=dimensions[0];height=dimensions[1]}}else if(selectedSize.fluid&&adSlotType.indexOf("box")>-1){parentWidth=adWindow.frameElement.parentNode.parentNode.parentNode.clientWidth;width=parentWidth;if(width>450){width=450}height=width/selectedSize.ratio}else{width=dimensions[0];height=dimensions[1]}if(adSlotType=="mobilemultibox"){adWindow.frameElement.style.setProperty("width",width+"px","important");adWindow.frameElement.style.setProperty("height",height+"px","important")}adWindow.frameElement.parentNode.style.setProperty("width",width+"px","important");adWindow.frameElement.parentNode.style.setProperty("height",height+"px","important");if(adSlotType=="topbox"){adWindow.frameElement.parentNode.parentNode.style.setProperty("width",width+"px","important");adWindow.frameElement.parentNode.parentNode.style.setProperty("height",height+"px","important")}}else{console.warn("no suitable ad size found: "+adSlotType);var container=adWindow.frameElement.parentNode;container.parentNode.removeChild(container)}}}function setupContainer(document,window,crossOrigin,adOptions){if(adOptions.ntvc){cssFixes=cssFixes.replace("height:100%;","")}if(crossOrigin&&adOptions.gntv){cssFixes=cssFixes.replace("height:100%;","");var selectedHeight=findNativeContainerHeight(window,adOptions);cssFixes+="body{height:"+selectedHeight+"px;}"}document.body.style.opacity=0;document.body.className+=" play-animations loading";document.getElementsByTagName("head")[0].appendChild(dom.createStylesheet(document,cssFixes));if(!crossOrigin&&adOptions.dcnl){dynamicContainer(adOptions,window,crossOrigin)}window.require=require}function findNativeContainerHeight(window,adOptions){var windowWidth=dom.getWindowSize(window).width;var widths=[];var widthToHeight={};var fixedHeight=true;var heightCheck=0;var largerThanFormatSizes=false;for(var i in adOptions.sizes){widths.push(parseInt(adOptions.sizes[i].split("x")[0],0));if(i===0&&windowWidth>parseInt(adOptions.sizes[i].split("x")[0],0)){largerThanFormatSizes=true}widthToHeight[adOptions.sizes[i].split("x")[0]]=adOptions.sizes[i].split("x")[1];if(heightCheck===0){heightCheck=adOptions.sizes[i].split("x")[1]}else{if(heightCheck!==adOptions.sizes[i].split("x")[1]){fixedHeight=false}}}var finaWidth=widths.reduce(function(prev,curr){return windowWidth<=curr?curr:prev});if(largerThanFormatSizes){finaWidth=widths[0]}var creativeHeight=widthToHeight[finaWidth+""];if(!largerThanFormatSizes&&widths.indexOf(finaWidth)!==0&&!fixedHeight){var ratio=creativeHeight/finaWidth;creativeHeight=ratio*windowWidth}return creativeHeight}var cssFixes="";cssFixes+="html,body{width:100%;height:100%;margin:0;padding:0;overflow:hidden}";cssFixes+="body{-webkit-transition:opacity 0.2s ease-in-out;-moz-transition:opacity 0.2s ease-in-out;-o-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out}";cssFixes+="body *{-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none}";cssFixes+="body{position:relative}";cssFixes+=".rad-element {position:absolute}";cssFixes+="#rad-wrapper{overflow:hidden;left:0;top:0;right:0;bottom:0}";cssFixes+=".loading { -webkit-animation-play-state: paused; animation-play-state: paused; }";cssFixes+="img{border:0;image-rendering:optimizeQuality;-ms-interpolation-mode:bicubic}";cssFixes+='.rad-ext{cursor:pointer;background:url("data:image/gif;base64,R0lGODlhCgAKAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjEgNjQuMTQwOTQ5LCAyMDEwLzEyLzA3LTEwOjU3OjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxODUxMEYwQzQ4NDkxMUUyQjVFRTg3N0VFNkJBQjk3RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxODUxMEYwRDQ4NDkxMUUyQjVFRTg3N0VFNkJBQjk3RSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjE4NTEwRjBBNDg0OTExRTJCNUVFODc3RUU2QkFCOTdFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjE4NTEwRjBCNDg0OTExRTJCNUVFODc3RUU2QkFCOTdFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAAAsAAAAAAoACgAAAgiEj6nL7Q9jKwA7")}';cssFixes+=".rad-ext-placeholder{display:none;overflow:hidden}";cssFixes+=".fadeOut{opacity:0}";cssFixes+="a#atecllink{display:none}";cssFixes+=".is-clickable{cursor:pointer}";cssFixes+="@-webkit-keyframes pagescroller-fix{from{top:0px;}to{top:0.01px;}}";cssFixes+="body{-ms-text-size-adjust: none;-moz-text-size-adjust: none;-o-text-size-adjust: none;-webkit-text-size-adjust: none; text-size-adjust: unset;}";cssFixes+="body{-webkit-tap-highlight-color: rgba(0,0,0,0);}";function container(window,crossOrigin,adOptions,openState){var styleKeys={};var loadedStylesheets=[];var loadedStylesheetsCreative=[];var currentFlowlineId=null;var autoResize=false;var containerWindowSize=null;var scrollbarSize=-1;dom.addEventListener(window,"resize",function(){containerWindowSize=dom.getWindowSize(window);scrollbarSize=calculateScrollbarSize()});function calculateScrollbarSize(){if(crossOrigin||adOptions.applenews){return 0}if(!window.parent){console.warn("window.parent in undefined. Radical will not measure scroll bar size");return 0}var t=window.parent;return t.innerWidth-t.document.documentElement.clientWidth}var containerObject={isCrossOrigin:function(){return crossOrigin},setRadicalApi:function(api){window.Radical=api},remove:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var container=window.frameElement.parentNode;container.parentNode.removeChild(container)},getAdDocument:function(){return window.document},getAdWindow:function(){return window},getAdOptions:function(){return adOptions},onPageScroll:function(callback){if(adOptions.export){return}if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var top=window.parent;return dom.addEventListener(top,"scroll",function(){var x=top.pageXOffset;var y=top.pageYOffset;var w=top.innerWidth;var h=top.innerHeight;callback({x:x,y:y,pageWidth:w,pageHeight:h})})},isAdVisible:function(startStop){if(crossOrigin||adOptions.applenews||adOptions.mraid){return 0}var frame=window.frameElement;if(adOptions.pageScroller){frame=window.frameElement.parentElement}var owner=dom.getOwnerWindow(frame);if(!frame){return false}if(adOptions.pageScroller){var threshold=startStop?startStop:2;var visibilityPercentage=visibility.getOnScreenPercentage(owner,frame,threshold);return visibilityPercentage<=0||visibilityPercentage>=1?false:true}else{return visibility.isElementVisible(owner,frame)}},onVisibilityChange:function(callback,startStop){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}return visibility.onVisibilityChange(containerObject,callback,startStop)},setContentDimensions:function(size){window.document.body.style.width=size.width+"px";window.document.body.style.height=size.height+"px";window.document.body.style.margin="0 auto"},getContentDimensions:function(){var contentDims={width:parseInt(window.document.body.style.width,10),height:parseInt(window.document.body.style.height,10)};if(!contentDims.width){return this.getAdSize()}return contentDims},onPageResize:function(callback){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}dom.addEventListener(window.parent,"resize",callback)},onUnload:function(callback){window.addEventListener("unload",callback,true)},onFullscreenChange:function(callback){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(function(evName){dom.addEventListener(window.document,evName,function(){var fullscreenElement=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;callback({isFullscreen:!!fullscreenElement,fullscreenElement:fullscreenElement})})})},getVisiblePercentage:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return 0}var frame=window.frameElement;var owner=dom.getOwnerWindow(frame);if(adOptions.pageScroller){frame=window.frameElement.parentElement}if(frame&&owner){return visibility.getVisiblePercentage(owner,frame)}},getOnScreenPercentage:function(startStop){if(crossOrigin||adOptions.applenews||adOptions.mraid){return 0}var frame=window.frameElement;if(adOptions.pageScroller){frame=window.frameElement.parentElement}var owner=dom.getOwnerWindow(frame);return visibility.getOnScreenPercentage(owner,frame,startStop)},enableOverlay:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var ins=window.frameElement.parentNode.getElementsByTagName("ins")[0];dom.forceInlineStyles(ins,{left:0,top:0,bottom:0,right:0,position:"fixed"})},setAutoOpen:function(autoOpen){autoResize=autoOpen},getAutoOpen:function(){return autoResize},disableOverlay:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var ins=window.frameElement.parentNode.getElementsByTagName("ins")[0];ins.style.position=ins.style.top=ins.style.bottom=ins.style.left=ins.style.right="";ins.style.zIndex=ins.style.background=""},centerForSize:function(size,noLightBoxTopCenter,customOpenStateZindex,lightBoxTopCenterOverride){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var isMobile=device.getDeviceProperties(window).isMobile;var isiOs=device.getDeviceProperties(window).isiOs;var viewport;if(isMobile&&!isiOs){viewport=dom.getWindowSizeClient(dom.getOwnerWindow(window.frameElement))}else{viewport=dom.getWindowSize(dom.getOwnerWindow(window.frameElement))}var centerX=(viewport.width-size.width)/2;var centerY=(viewport.height-size.height)/2;if(lightBoxTopCenterOverride){if(viewport.width<lightBoxTopCenterOverride.limit){centerY=lightBoxTopCenterOverride.limited}else{centerY=lightBoxTopCenterOverride.default}}if(noLightBoxTopCenter){centerY=0}var zIndex=customOpenStateZindex?customOpenStateZindex:2147483646;dom.forceInlineStyles(window.frameElement,{left:centerX+"px",top:centerY+"px",position:"fixed","z-index":zIndex,"max-width":"none"})},resetCentering:function(){var frame=window.frameElement;frame.style.position=frame.style.top=frame.style.bottom=frame.style.left=frame.style.right="";frame.style.maxWidth=frame.style.zIndex=""},setSideKickPosition:function(oldSize,newSize,position){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}if(!position){position="left"}var leftOffset=0;if(position==="left"){var fullSpace=oldSize.width+window.frameElement.offsetLeft;leftOffset=fullSpace-newSize.width}else if(position==="right"){leftOffset=window.frameElement.offsetLeft}else if(position==="center"){var centerOld=window.frameElement.offsetLeft+oldSize.width/2;leftOffset=centerOld-newSize.width/2}dom.forceInlineStyles(window.frameElement,{"max-width":"none","max-height":"none",height:newSize.height+"px",width:newSize.width+"px",position:"absolute",left:leftOffset+"px"})},resetSideKickPosition:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}var frame=window.frameElement;frame.style.position=frame.style.top=frame.style.bottom=frame.style.left=frame.style.right="";frame.style.maxWidth=frame.style.maxHeight=frame.style.height=frame.style.width=""},getPageSize:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return{width:0,height:0}}return dom.getCachedWindowSize(dom.getOwnerWindow(window.frameElement))},getAdSize:function(){if(adOptions.singleSize){return{width:adOptions.singleSize.width,height:adOptions.singleSize.height}}if(!containerWindowSize){containerWindowSize=dom.getWindowSize(window)}return containerWindowSize},getScrollBarsSize:function(){return dom.getScrollBarsSize(window,crossOrigin)},show:function(){if(!openState){window.document.body.style.opacity=1}window.document.body.className=window.document.body.className.replace("loading","");if(crossOrigin||adOptions.applenews||adOptions.mraid){return}window.frameElement.style.display="block"},hide:function(ad,ev,evConfig){events.emitGlobal("hideAd",{});var animation=evConfig&&evConfig.data&&evConfig.data.animation;if(crossOrigin||adOptions.applenews||adOptions.mraid){if(animation==="fadeOut"){Object.assign(window.document.body.style,{transition:"opacity 0.2s",opacity:0});setTimeout(hideBody,200)}else if(animation==="slideOut"){Object.assign(window.document.body.querySelector(".rad-creative-content").style,{bottom:0,top:"auto"});window.document.body.setAttribute("style","position: relative !important; overflow: hidden; transition: height 0.2s; height: 0%;");setTimeout(hideBody,200)}else{hideBody()}}else{var pos=dom.getMousePosition(ev.domEvent,window);pos=pos.posx+"x"+pos.posy;var eventData={e:"interact.hide",elId:ev.element.id,pos:pos};ad.sendAnalyticsEvent(eventData);if(animation==="fadeOut"){Object.assign(window.frameElement.parentNode.style,{transition:"opacity 0.2s",opacity:0});setTimeout(hideFrame,200)}else if(animation==="slideOut"){window.frameElement.setAttribute("style",`height: ${window.frameElement.clientHeight}px; position: absolute !important; bottom: 0`);window.frameElement.parentNode.setAttribute("style","position: relative !important; overflow: hidden; transition: height 0.2s; height: 0%;");setTimeout(hideFrame,200)}else{hideFrame()}}function hideBody(){window.document.body.style.display="none"}function hideFrame(){if(window.frameElement.parentNode.parentNode){window.frameElement.parentNode.parentNode.setAttribute("style","display:none !important")}else{window.frameElement.parentNode.setAttribute("style","display:none !important")}}},onResize:function(callback){dom.addEventListener(window,"resize",function(){callback({size:containerObject.getAdSize()})})},addCSS:function(css,key){if(key&&styleKeys[key]){return}if(key){styleKeys[key]=true}var stylesheet=dom.createStylesheet(window.document,css);window.document.getElementsByTagName("head")[0].appendChild(stylesheet)},replaceNamedCSS:function(name,css){var style=dom.createStylesheet(window.document,css);style.id="nc-"+name;var old=window.document.getElementById("nc-"+name);var head=window.document.getElementsByTagName("head")[0];if(old){head.replaceChild(style,old)}else{head.appendChild(style)}},removeNamedCSS:function(name){var old=window.document.getElementById("nc-"+name);if(old){old.parentNode.removeChild(old)}},loadStylesheetToPage:function(url,callback){callback=callback||function(){};if(crossOrigin||adOptions.applenews||adOptions.mraid||!url||loadedStylesheets.indexOf(url)!==-1){setTimeout(function(){callback()},1);return}loadedStylesheets.push(url);stylesheetLoader.load(url,window.parent.document,callback)},loadStylesheetToCreative:function(url,callback){callback=callback||function(){};if(!url||loadedStylesheetsCreative.indexOf(url)!==-1){setTimeout(function(){callback()},1);return}loadedStylesheetsCreative.push(url);stylesheetLoader.load(url,window.document,callback)},insertStylesToPage:function(styles){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}if(!window.frameElement){console.warn("window.frameElement in undefined. Radical will not insert styles to the page");return}var doc=window.frameElement.ownerDocument;var tag=dom.createStylesheet(doc,styles);doc.body.appendChild(tag);return tag},getScrollbarSize:function(){if(scrollbarSize===-1){scrollbarSize=calculateScrollbarSize()}return scrollbarSize},removeFlowline:function(url,callback){stylesheetLoader.remove(url,window.parent.document,callback)},setFlowline:function(flowlineId){if(!adOptions.export){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}}else{return}currentFlowlineId=flowlineId;var target=window.frameElement.parentNode;if(adOptions.flowlineTarget==="iframe"){target=window.frameElement}var flowlineClass="rad-fl-"+flowlineId+" nedit";var flRe=/^rad-fl-/;var classes=dom.getClasses(target).filter(function(className){return!flRe.test(className)});classes.push(flowlineClass);target.className=classes.join(" ")},getFlowline:function(){return currentFlowlineId},getPageScrollerFlowlineTarget:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return null}var flTarget=window.frameElement;return flTarget},getIframeContainerNode:function(){if(crossOrigin||adOptions.applenews||adOptions.mraid){return}return window.frameElement.parentNode},refreshClipStyles:function(){var el=containerObject.getIframeContainerNode();function fix(){el.style.display="none";el.offsetHeight;el.style.display="block";setTimeout(function(){window.requestAnimationFrame(fix)},100)}window.requestAnimationFrame(fix)},setPageScrollerHeight:function(pageScrollerHeight,paddingTop,paddingBottom,enableCentering,alignLeftToParent){var el=containerObject.getIframeContainerNode();dom.forceInlineStyles(el,{width:"100%"});if(el.parentNode&&el.parentNode.className.indexOf("cns-ads-container")>-1){dom.forceInlineStyles(el.parentNode,{width:"100%"})}var flTarget=el.parentNode;var iframe=el.querySelector("iframe");var centerPadding=0;paddingTop=paddingTop||0;paddingBottom=paddingBottom||0;var alignLeftOffset=0;var paddingReduction=0;var offsetHeight;if(paddingTop){offsetHeight=containerObject.getPageSize().height-paddingTop+"px";paddingReduction=paddingTop}if(paddingBottom){offsetHeight=containerObject.getPageSize().height-paddingTop-paddingBottom+"px";paddingReduction=paddingTop+paddingBottom}if(enableCentering){dom.forceInlineStyles(iframe,{position:"relative","padding-left":"","padding-right":""});centerPadding=(containerObject.getPageSize().width-parseInt(getComputedStyle(el).width,10)-containerObject.getScrollBarsSize().width)/2}if(alignLeftToParent){alignLeftOffset=(parseInt(el.getBoundingClientRect().left,10)-centerPadding)*2}dom.setInlineStyles(flTarget,{position:"relative",height:pageScrollerHeight+"vh",top:"0px",zIndex:"214748364"});if(el.parentNode&&el.parentNode.className.indexOf("cns-ads-container")>-1){dom.forceInlineStyles(flTarget,{width:"100%"})}var forcedInlineStyles={position:"absolute",width:"100%",height:pageScrollerHeight+"vh","-webkit-clip-path":"inset(0px)","clip-path":"inset(0px)",clip:"rect(0px auto auto 0px)","-webkit-animation":"pagescroller-fix 0.1s infinite"};dom.forceInlineStyles(el,forcedInlineStyles);var iframeStyles={position:"fixed",top:paddingTop+"px",right:"0px",left:alignLeftOffset+"px",width:"100%",height:"calc(100vh - "+paddingReduction+"px)","box-sizing":"border-box",display:"block"};if(paddingBottom){delete iframeStyles.top;iframeStyles.bottom=paddingBottom+"px"}dom.forceInlineStyles(iframe,iframeStyles);if(enableCentering){iframe.style.setProperty("padding-left",centerPadding+"px","important");iframe.style.setProperty("padding-right",centerPadding+"px","important")}return flTarget}};return containerObject}module.exports={render:function(window,adOptions,openState){var crossOrigin=false;if(adOptions.crossOrigin!=undefined){crossOrigin=adOptions.crossOrigin}else{try{crossOrigin=!window.top.location.hostname}catch(err){crossOrigin=true}}var servedInFrame=crossOrigin||window.frameElement;var adFrame;var adDocument;var adWindow;if(servedInFrame&&!adOptions.overridePlacement){adDocument=window.document;adWindow=window;if(!crossOrigin){adFrame=window.frameElement;adFrame.parentNode.insertBefore(adFrame.ownerDocument.createElement("ins"),adFrame)}else{setupContainer(adDocument,adWindow,crossOrigin,adOptions)}}else{var doc=window.document;var tagAnchor;if(adOptions.overridePlacement&&typeof adOptions.overridePlacement!=="function"){adOptions.overridePlacement=placementOverride.createOverride(adOptions.overridePlacement)}if(typeof adOptions.overridePlacement==="function"){tagAnchor=adOptions.overridePlacement()}else{tagAnchor=window.document.getElementById("responsivead-"+adOptions.id)}if(!tagAnchor){console.warn("tagAnchor not found. Radical will not render creative with id: "+adOptions.id);return}tagAnchor.id="responsivead-"+adOptions.id+"-1";adFrame=doc.createElement("iframe");adFrame.frameBorder=0;if(tagAnchor.parentNode.nodeName=="BODY"){var div=tagAnchor.parentNode.insertBefore(doc.createElement("div"),tagAnchor.nextSibling);div.appendChild(tagAnchor)}if(typeof adOptions.overridePlacement==="function"){adFrame.style.display="none"}tagAnchor.parentNode.insertBefore(adFrame,tagAnchor.nextSibling);adWindow=adFrame.contentWindow;adDocument=adFrame.contentDocument;adDocument.open();adDocument.write('<!DOCTYPE html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script>var Radical = parent.Radical;<\/script></head><body></body>');adDocument.close()}if(!crossOrigin){if(!adOptions.applenews){dom.setupIframe(adFrame,true,crossOrigin,adOptions.dcnl)}setupContainer(adDocument,adWindow,crossOrigin,adOptions)}return container(adWindow,crossOrigin,adOptions,openState)}}},{"./device":31,"./dom":32,"./events":52,"./placementOverride":72,"./stylesheetLoader":76,"./visibility":82}],29:[function(require,module,exports){module.exports={parse:function(domElement){const props={};if(domElement){const computedStyles=getComputedStyle(domElement);if(computedStyles){props.preventRenderingIfInActionList=Boolean(computedStyles.getPropertyValue("--rad-variable-prevent-rendering-if-in-action-list"))}}return props}}},{}],30:[function(require,module,exports){var dom=require("./dom");var events=require("./events");var urlFuncs=require("./url");var requests={};var cache={};var getDotNotation=function(obj,path){if(obj[path]){return obj[path]}return path.replace(/\[|\]\.?/g,".").split(".").filter(s=>s).reduce((acc,val)=>acc&&acc[val],obj)};module.exports={clearCache:function(){cache={};requests={}},feed:function(url){var emitter=events.createEmitter();var pageSize=10;var feedParameters={};return{load:function(callback){if(cache[url]){callback(null,cache[url]);return}loadPage(0,callback)},onParametersUpdated:function(callback){emitter.addListener("parametersUpdated",callback)},setParameter:function(paramName,paramValue){feedParameters[paramName]=paramValue;cache[url]=undefined;emitter.emit("parametersUpdated")},setPageSize:function(newPageSize){pageSize=newPageSize},getRow:function(rowNumber,callback){if(cache[url]&&cache[url].total<=rowNumber){callback(null,null);return}if(!cache[url]||!cache[url].data[rowNumber]){loadPage(Math.floor(rowNumber/pageSize),function(err){callback(err,cache[url].data[rowNumber])});return}callback(null,cache[url].data[rowNumber])},getTotalRows:function(callback){if(!cache[url]){this.load(function(){callback(null,cache[url].total)});return}callback(null,cache[url].total)}};function loadPage(page,callback){if(requests[url]){requests[url].push(callback);return}requests[url]=[callback];var queryParams=Object.assign({},feedParameters,{start:page*pageSize,limit:pageSize});dom.ajax("GET",urlFuncs.combineUrlAndQueryParams(url,queryParams),function(err,data){if(!err){var parsedData=JSON.parse(data);if(!cache[url]){cache[url]=parsedData}else{parsedData.data.forEach(function(data,index){cache[url].data[index+parsedData.start]=data})}}var reqsForUrl=requests[url];requests[url]=null;reqsForUrl.forEach(function(fn){fn(err,cache[url])})})}},feedRow:function(feed,initialRowNumber){var rowNumber=initialRowNumber;var emitter=events.createEmitter();var currentData=null;feed.onParametersUpdated(function(){emitter.emit("dataUpdated")});return{setRowNumber:function(newRowNumber){rowNumber=newRowNumber;emitter.emit("dataUpdated")},getRowNumber:function(){return rowNumber},getData:function(callback){feed.getRow(rowNumber,function(err,data){currentData=data;callback(err,data)})},getDataByProperty:function(property,callback){feed.getRow(rowNumber,function(err,data){if(err){return callback(err)}try{var value=getDotNotation(data,property);callback(null,value,data)}catch(error){callback(error)}})},getCurrentData:function(){return currentData},onDataUpdated:function(callback){emitter.addListener("dataUpdated",callback)}}}}},{"./dom":32,"./events":52,"./url":79}],31:[function(require,module,exports){var device={getDeviceProperties:function(window){return{isMobile:isMobile(window),isiOs:isiOs(window),isiPad:isiPad(window),isiMobile:isiMobile(window),isiPhone:isiPhone(window),iosVersion:getiOsVersion(window),isSafari:isSafari(window),isChrome:isChrome(window),isIE11:isIE11(window),isEdge:isEdge(window),isIE:isIE(window),isMobileOrTablet:isMobileOrTablet(window),probablyTouchscreen:probablyTouchscreen(window)}}};function isMobile(window){var check=false;(function(a){if(/(android|bb\d+|meego).+mobile|android|ipad|playbook|silk|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0,4)))check=true})(window.navigator.userAgent||window.navigator.vendor||window.opera);return check}function isiOs(currentWindow){var ua=currentWindow.navigator.userAgent;if(ua.match(/(iPad|iPhone|iPod)/g)){return true}if(ua.match(/Mac/)&&currentWindow.navigator.maxTouchPoints&&currentWindow.navigator.maxTouchPoints>2){return true}return false}function isiPad(currentWindow){var ua=currentWindow.navigator.userAgent;if(ua.indexOf("iPad")>-1){return true}if(ua.match(/Mac/)&&currentWindow.navigator.maxTouchPoints&&currentWindow.navigator.maxTouchPoints>2){return true}return false}function isiMobile(currentWindow){return currentWindow.navigator.userAgent.match(/(iPhone|iPod)/g)?true:false}function isiPhone(currentWindow){return currentWindow.navigator.userAgent.match(/iPhone/i)!=null}function getiOsVersion(currentWindow){var ios=currentWindow.navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return ios?ios[1]:null}function isSafari(currentWindow){var ua=currentWindow.navigator.userAgent;return ua.match(/(Safari)/g)&&!ua.match(/(Chrome)/g)?true:false}function isChrome(currentWindow){var isChromium=currentWindow.chrome;var winNav=currentWindow.navigator;var vendorName=winNav.vendor;var isOpera=typeof currentWindow.opr!=="undefined";var isIEedge=winNav.userAgent.indexOf("Edge")>-1;var isIOSChrome=winNav.userAgent.match("CriOS");if(isIOSChrome){return true}else if(isChromium!==null&&typeof isChromium!=="undefined"&&vendorName==="Google Inc."&&isOpera===false&&isIEedge===false){return true}else{return false}}function isIE11(currentWindow){return!!currentWindow.msCrypto}function isEdge(currentWindow){var ua=currentWindow.navigator.userAgent;return/Edge/.test(ua)}function isIE(currentWindow){var ua=currentWindow.navigator.userAgent;var isIEBrowser=/MSIE|Trident/.test(ua);return isIEBrowser}function probablyTouchscreen(window){return"ontouchstart"in window||window.navigator.MaxTouchPoints>0||window.navigator.msMaxTouchPoints>0}function isMobileOrTablet(currentWindow){return isMobile(currentWindow)||isiPad(currentWindow)}module.exports=device},{}],32:[function(require,module,exports){var device=require("./device.js");function setInlineStyles(el,styles,important,replace){if(!replace){el.style.cssText.replace(/ *! *important */g,"").split(/ *; */g).forEach(function(decl){var vals=decl.split(/ *: */);var prop=vals[0];var value=vals[1];if(vals[2]!==undefined){value=value+":"+vals[2]}if(prop===undefined||value===undefined){return}prop=prop.toLowerCase();if(styles[prop]===undefined){styles[prop]=value}})}var props=[];for(var k in styles){if(styles[k]===undefined){continue}var value=styles[k];if(value===""){value='""'}value=value+(important?"!important":"");props.push(k+":"+value);if(k==="transform"||k==="transform-origin"){props.push("-webkit-"+k+":"+value)}}el.style.cssText=props.join(";")}function vuToString(vu){if(!vu){return""}if(vu.value==="auto"){return vu.value}return vu.value+vu.unit}var cachedOrientation;var cachedWindowsSize={width:0,height:0};var swipeListenersSet=false;var dom={vuToString:vuToString,addEventListener:function(el,eventName,callback){el.addEventListener(eventName,callback,false);return function(){el.removeEventListener(eventName,callback,false)}},createStylesheet:function(document,cssString){var style=document.createElement("style");style.setAttribute("type","text/css");if(style.styleSheet){style.styleSheet.cssText=cssString}else{style.appendChild(document.createTextNode(cssString))}return style},enableSwipeEvents:function(_window,_document){if(swipeListenersSet){return}if(typeof _window.CustomEvent!=="function"){_window.CustomEvent=function(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt};_window.CustomEvent.prototype=_window.Event.prototype}_document.addEventListener("touchstart",handleTouchStart,false);_document.addEventListener("touchmove",handleTouchMove,false);_document.addEventListener("touchend",handleTouchEnd,false);swipeListenersSet=true;var xDown=null;var yDown=null;var xDiff=null;var yDiff=null;var timeDown=null;var startEl=null;function handleTouchEnd(e){if(startEl!==e.target)return;var swipeThreshold=parseInt(startEl.getAttribute("data-swipe-threshold")||"20",10);var swipeTimeout=parseInt(startEl.getAttribute("data-swipe-timeout")||"500",10);var timeDiff=Date.now()-timeDown;var eventType="";if(Math.abs(xDiff)>Math.abs(yDiff)){if(Math.abs(xDiff)>swipeThreshold&&timeDiff<swipeTimeout){if(xDiff>0){eventType="swiped-left"}else{eventType="swiped-right"}}}else{if(Math.abs(yDiff)>swipeThreshold&&timeDiff<swipeTimeout){if(yDiff>0){eventType="swiped-up"}else{eventType="swiped-down"}}}if(eventType!==""){startEl.dispatchEvent(new CustomEvent(eventType,{bubbles:true,cancelable:true}))}xDown=null;yDown=null;timeDown=null}function handleTouchStart(e){if(e.target.getAttribute("data-swipe-ignore")==="true")return;startEl=e.target;timeDown=Date.now();xDown=e.touches[0].clientX;yDown=e.touches[0].clientY;xDiff=0;yDiff=0}function handleTouchMove(e){if(!xDown||!yDown)return;var xUp=e.touches[0].clientX;var yUp=e.touches[0].clientY;xDiff=xDown-xUp;yDiff=yDown-yUp}},hasClass:function(elem,klass){return(" "+elem.className+" ").indexOf(" "+klass+" ")>-1},createScript:function(document,jsString){var s=document.createElement("script");try{s.appendChild(document.createTextNode(jsString))}catch(e){s.text=jsString}return s},addClass:function(el,className){if(!dom.hasClass(el,className)){el.className=dom.trim(el.className+" "+className)}},removeClass:function(el,className){if(!className){el.className="";return}var classes=className.split(" ");if(classes.length>1){var i=classes.length;while(i--){dom.removeClass(el,classes[i])}return}if(dom.hasClass(el,className)){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");el.className=el.className.replace(reg," ").replace(/\s{2,}/g," ");el.className=dom.trim(el.className)}return},trim:function(str0){var str=str0.replace(/^\s\s*/,""),ws=/\s/,i=str0.length;while(ws.test(str.charAt(--i)));return str.slice(0,i+1)},Object:{clone:function(obj){if(obj){return JSON.parse(JSON.stringify(obj))}}},generateUUID:function(){return function b(a){return a?(a^Math.random()*32>>a/4).toString(16):([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,b)}()},preventDefault:function(ev){if(ev.preventDefault){ev.preventDefault()}else{ev.returnValue=false}},getIEInfo:function(window){var ua=window.navigator.userAgent.toLowerCase();return ua.indexOf("msie")!=-1?{version:parseInt(ua.split("msie")[1])}:null},throttle:function(fn,threshhold,scope){threshhold||(threshhold=250);var last,deferTimer;return function(){var context=scope||this;var now=+new Date,args=arguments;if(last&&now<last+threshhold){clearTimeout(deferTimer);deferTimer=setTimeout(function(){last=now;fn.apply(context,args)},threshhold)}else{last=now;fn.apply(context,args)}}},setupIframe:function(frame,adFrame,crossOrigin,dcnl){if(!dcnl){frame.width=frame.style.width="100%";if(!crossOrigin){if(!adFrame){frame.height=frame.style.height="100%"}}else{frame.height=frame.style.height="100%"}}frame.scrolling="no";frame.setAttribute("msallowfullscreen","");frame.setAttribute("webkitAllowFullScreen","");frame.setAttribute("mozallowfullscreen","");frame.setAttribute("allowFullScreen","");frame.setAttribute("allowTransparency","true");frame.setAttribute("frameborder","0");frame.setAttribute("allow","autoplay;fullscreen;camera")},fixIframeForIOs:function(frame){frame.style.width="1px";frame.style.minWidth="100%";frame.style.height="1px";frame.style.minHeight="100%";frame.scrolling="no"},getCachedWindowSize:function(_window){if(!device.getDeviceProperties(_window).isiOs){return this.getWindowSize(_window)}var newOrientation=Math.abs(_window.orientation);if(cachedOrientation===undefined||newOrientation!=cachedOrientation){cachedOrientation=newOrientation;cachedWindowsSize=this.getWindowSize(_window)}return cachedWindowsSize},getWindowSize:function(_window){var width=_window.innerWidth;var height=_window.innerHeight;if(!width||!height){width=_window.document.documentElement.clientWidth;height=_window.document.documentElement.clientHeight}return{width:width,height:height}},getScrollBarsSize:function(_window,crossOrigin){if(!crossOrigin){_window=_window.parent}var width=_window.innerWidth;var height=_window.innerHeight;return{width:width-_window.document.documentElement.clientWidth,height:height-_window.document.documentElement.clientHeight}},getWindowSizeClient:function(_window){if(_window.document.documentElement.clientWidth&&_window.document.documentElement.clientHeight){return{width:_window.document.documentElement.clientWidth,height:_window.document.documentElement.clientHeight}}else{return this.getWindowSize(_window)}},getWindowScrollOffset:function(window){var x=window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft;var y=window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:x,y:y}},getMousePosition:function(event,window){var posx=0;var posy=0;if(!event)event=window.event;if(event.pageX||event.pageY){posx=event.pageX;posy=event.pageY}else if(event.clientX||event.clientY){posx=event.clientX+window.document.body.scrollLeft+window.document.documentElement.scrollLeft;posy=event.clientY+window.document.body.scrollTop+window.document.documentElement.scrollTop}return{posx:posx,posy:posy}},getOwnerWindow:function(el){if(!el){return null}var doc;if(el.nodeName=="#document"){doc=el}else{doc=el.ownerDocument}return doc.defaultView||doc.parentWindow},Array:{from:function(){if(Array.from){return function(arrayish){return Array.from(arrayish)}}return function(arrayish){var arr=[];for(var i=0;i<arrayish.length;i++){arr.push(arrayish[i])}return arr}}()},getTransitionInfo:function(document){var style=document.createElement("p").style;var prefixes=["webkit","o",""];for(var i=0;i<prefixes.length;i++){var prefix=prefixes[i];var propName=prefix==""?"transition":prefix.charAt(0).toUpperCase()+prefix.slice(1)+"Transition";if(style[propName]==""){return{end:prefix==""?"transitionend":prefix+"TransitionEnd",property:prefix==""?"transition":prefix+"Transition"}}}return null},ajax:function(method,url,callback){var xhr=new XMLHttpRequest;xhr.open(method,url,true);xhr.onreadystatechange=function(){if(xhr.readyState!=4){return}var error=null;if(xhr.status===0||xhr.status>=400){error={status:xhr.status};if(xhr.status===0){error.message="Probably invalid crossdomain request"}}callback(error,xhr.responseText)};xhr.send(null)},forceInlineStyles:function(el,styles){setInlineStyles(el,styles,true)},setInlineStyles:function(el,styles){setInlineStyles(el,styles,false)},replaceInlineStyles:function(el,styles){setInlineStyles(el,styles,false,true)},merge:function(){var args=dom.Array.from(arguments);var destination=args.shift();args.forEach(function(source){mergeObj(destination,source)});return destination;function mergeObj(destination,source){for(var k in source){var prop=source[k];var isDOMNode=prop&&!!prop.nodeName;var isArray=prop&&typeof prop==="object"&&"splice"in prop&&"sort"in prop;var isNull=prop===null;if(!isNull&&typeof prop=="object"&&!isArray&&!isDOMNode){destination[k]=mergeObj(Object.assign({},destination[k]||{}),source[k])}else{destination[k]=source[k]}}return destination}},path:function(obj,path,def){var i,len;for(i=0,path=path.split("."),len=path.length;i<len;i++){if(!obj||typeof obj!=="object")return def;obj=obj[path[i]]}if(obj===undefined)return def;return obj},normalizeUrl:function(url,https){if(/^http/.test(url)){return url}return(https?"https:":"http:")+url},getClasses:function(element){if(element.classList){return Array.prototype.slice.call(element.classList)}return element.className.split(/ /g)},getScreenSize:function(){return{width:screen.width,height:screen.height}},findAncestor:function(el,cls){while((el=el.parentElement)&&!this.hasClass(el,cls));return el},findAncestorWithDataAttr:function(el,dataAttr){while(el=el.parentElement){if(el.hasAttribute(dataAttr)){break}}return el},getBackgroundSize:function(layout){var bgSize;if(!layout||layout==="fill"){bgSize="100% 100%"}else if(typeof layout==="object"){bgSize=layout.x.value+layout.x.unit+" "+layout.y.value+layout.y.unit}else{bgSize=layout}return bgSize},setDisplayOnAllParents:function(domEl,reset){while(domEl&&domEl.style){if(reset){domEl.style.display=domEl.dataset.radTmpDisplay;delete domEl.dataset.radTmpDisplay}else{domEl.dataset.radTmpDisplay=domEl.style.display;domEl.style.display="block"}domEl=domEl.parentNode}}};module.exports=dom},{"./device.js":31}],33:[function(require,module,exports){var adsonica=require("../adsonica2");var events=require("../events");var url=require("../url");const emptyImage="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";function create(container,context,config){var document=container.getAdDocument();var domNode=document.createElement("div");var img=document.createElement("img");img.id="adsonica-image-"+String(Math.random()).slice(2);img.className="adsonica-image";img.style.height="100%";img.style.position="absolute";img.style.width="100%";img.style.transition="opacity 300ms";img.src=emptyImage;const imageUrl=url.toFullUrl(config.adsonicaComponent.src,context.adContent);img.setAttribute("data-src",imageUrl);domNode.appendChild(img);return{domNode:domNode,onRender:async function(elId,defs,styles,elementCreated){if(!elementCreated){return}const el=this.domNode;var elImage=findAdsonicaImageElement(el);let progressReached=0;let audiobilityFired=false;elImage.addEventListener("click",function(){if(adsonica.isPlayingAdsonica(elImage)){adsonica.stopAdsonica(elImage);sendAdsonicaAnalyticsEvent("stop")}else{adsonica.playAdsonica(elImage);sendAdsonicaAnalyticsEvent("play")}});adsonica.on(img,"playing",function(){progressReached=0;audiobilityFired=false;events.emitGlobal("mediaPlaying",{domEvent:{target:el},context:context});sendAdsonicaAnalyticsEvent("started")});adsonica.on(img,"pause",function(){events.emitGlobal("mediaPause",{domEvent:{target:el},context:context});sendAdsonicaAnalyticsEvent("paused")});adsonica.on(img,"ended",function(){events.emitGlobal("mediaEnded",{domEvent:{target:el},context:context})});adsonica.on(img,"timeupdate",function({currentTime,duration}){if(!audiobilityFired&&currentTime>2){sendAdsonicaAnalyticsEvent("audiobility");audiobilityFired=true}const progress=duration>0?currentTime/duration:0;if(progress<=progressReached){return}if(progressReached<.25&&progress>=.25){sendAdsonicaAnalyticsEvent("25")}else if(progressReached<.5&&progress>=.5){sendAdsonicaAnalyticsEvent("50")}else if(progressReached<.75&&progress>=.75){sendAdsonicaAnalyticsEvent("75")}else if(progress>=1){sendAdsonicaAnalyticsEvent("ended")}progressReached=progress});if(config.adsonicaComponent.loadType!=="onAction"){adsonica.initializeAdsonica(elImage)}function sendAdsonicaAnalyticsEvent(v){context.sendAnalyticsEvent({e:"interact.audio",elId:elId,v:v})}}}}function readBlob(blob){return new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=()=>{const dataUrl=reader.result;if(typeof dataUrl!=="string"){reject(new Error("Failed to read as data URL"));return}return resolve(dataUrl)};reader.onerror=()=>reject(new Error("Failed to read a blob to data URL"));reader.readAsDataURL(blob)})}function findAdsonicaImageElement(el){const w=el.ownerDocument.defaultView;const HTMLImageElement=w&&w.HTMLImageElement;if(!HTMLImageElement){throw new Error("Element must be in a window (removed?)")}var elImage=el.querySelector(".adsonica-image");if(!elImage||!(elImage instanceof HTMLImageElement)){throw new Error("Element must contain Adsonica image element")}return elImage}module.exports={create:create}},{"../adsonica2":12,"../events":52,"../url":79}],34:[function(require,module,exports){var dom=require("../dom");var url=require("../url");var BRIGHTCOVE_PLAYER_URL="//players.brightcove.net/";function create(container,context,config){var wrapper=document.createElement("div");if(context.adContent.screenshot){if(!config.brightcovevideowidget.fallbackImage){return{domNode:wrapper}}var screenshot=document.createElement("img");dom.setInlineStyles(screenshot,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%","min-width":"100%","min-height":"100%"});screenshot.src=url.toFullUrl(config.brightcovevideowidget.fallbackImage,context.adContent);wrapper.appendChild(screenshot);return{domNode:wrapper}}var options={loop:config.brightcovevideowidget.loop,accountid:config.brightcovevideowidget.accountid,videoid:config.brightcovevideowidget.videoid,playerid:config.brightcovevideowidget.playerid};var embedOptions={id:options.id};if(options.autoplay){embedOptions.autoplay=options.autoplay}var iframePlayer=document.createElement("iframe");iframePlayer.width="100%";iframePlayer.height="100%";iframePlayer.style.width="100%";iframePlayer.style.height="100%";iframePlayer.frameBorder=0;iframePlayer.scrolling="no";iframePlayer.setAttribute("msallowfullscreen","");iframePlayer.setAttribute("webkitAllowFullScreen","");iframePlayer.setAttribute("mozallowfullscreen","");iframePlayer.setAttribute("allowFullScreen","");iframePlayer.setAttribute("allowTransparency","true");wrapper.appendChild(iframePlayer);var src=url.toFullUrl(BRIGHTCOVE_PLAYER_URL+options.accountid+"/"+options.playerid+"_default"+"/index.html",context.adContent);if(options.videoid){src=src+"?videoId="+options.videoid}iframePlayer.src=src;return{domNode:wrapper}}module.exports={create:create}},{"../dom":32,"../url":79}],35:[function(require,module,exports){var dom=require("../dom");var log=require("../log");var events=require("../events");var dataSource=require("../dataSource");function removeIds(root){root.id="";for(var i=0;i<root.childNodes.length;i++){removeIds(root.childNodes[i])}}function create(container,context,config){var window=container.getAdWindow();var document=container.getAdDocument();var div=document.createElement("div");var slideAnimation;var slideAnimationCurrent;dom.enableSwipeEvents(window,document);var visibleSlideId="";var slideTimer;var animating=false;var slideChangeCallback;var gapWidth=0;var fixedWidth=false;var visibleSlideCount=0;var slideDirection="horizontal";var swipeLeftListenerDestroy;var swipeRightListenerDestroy;var mouseEnterListenerDestroy;var mouseLeaveListenerDestroy;var loops=true;var duration=.5;var pauseOnHover=false;var pauseVideosOnSlideChange=true;var pausedCarouselAfterSlideChange=false;var directionsProps={side:"left",point:"x",measureSize:"offsetWidth",size:"width",scrollDirection:"next"};var elementDataSource=null;if(!context.getMergedContent().inEditor&&config.dataSource&&config.dataSource.type==="feed"){elementDataSource=dataSource.feed(config.dataSource.url);elementDataSource.onParametersUpdated(function(){getSlides().forEach(function(c,idx){if(c.getElementDataSource){c.getElementDataSource().setRowNumber(idx)}});moveToSlideIndex(0)})}return{domNode:div,rendered:rendered,destroy:destroy,updated:updated,setVisibleSlide:setVisibleSlide,setVisibleSlideIndex:setVisibleSlideIndex,animateToSlide:animateToSlide,moveToSlide:moveToSlide,animateToSlideIndex:animateToSlideIndex,getVisibleSlideIndex:getVisibleSlideIndex,getSlides:getSlides,nextSlide:nextSlide,previousSlide:previousSlide,pause:pause,resume:resume,removeSlide:removeSlide,slideChangeCallback:function(callback){slideChangeCallback=callback},onRender:onRender,getElementDataSource:function(){return elementDataSource},setPausedCarouselAfterSlideChange:function(newValue){pausedCarouselAfterSlideChange=newValue}};function rendered(){if(!window.TweenLite){log.log("TweenLite is not available. Carousel will not animate correctly")}processAutoplay()}function destroy(){clearTimeout(slideTimer);if(swipeLeftListenerDestroy){swipeLeftListenerDestroy()}if(swipeRightListenerDestroy){swipeRightListenerDestroy()}if(mouseEnterListenerDestroy){mouseEnterListenerDestroy()}if(mouseLeaveListenerDestroy){mouseLeaveListenerDestroy()}}function pause(){clearTimeout(slideTimer)}function resume(){pausedCarouselAfterSlideChange=false;processAutoplay()}function processAutoplay(){if(!config.carouselWidget.autoplay){return}var defaultTime=config.carouselWidget.pauseTime;clearTimeout(slideTimer);slideTimer=setTimeout(function(){if(directionsProps.side==="left"){nextSlide()}else{previousSlide()}processAutoplay()},defaultTime*1e3)}function nextSlide(){if(slideAnimation&&slideAnimation.isActive()){slideAnimation.progress(1)}if(slideAnimationCurrent&&slideAnimationCurrent.isActive()){slideAnimationCurrent.progress(1)}if(visibleSlideCount===-1){animateFade("next")}else{animateSlide("next")}if(slideChangeCallback){var children=getSlides();var visibleSlideIndex=getVisibleSlideIndex();slideChangeCallback("next",visibleSlideIndex,children[visibleSlideIndex].domNode)}if(pauseVideosOnSlideChange){pauseAllHtml5Videos()}}function getVisibleSlideIndex(){var children=getSlides();var idx=children.findIndex(function(child){return child.id===visibleSlideId});return idx===-1?0:idx}function getSlides(){var slides=context.getElementChildren(config.id);slides=slides.filter(function(r){return context.getElementStyles(r.id).visible});slides.sort(function(a,b){return+b.domNode.style.zIndex-+a.domNode.style.zIndex});if(!visibleSlideId&&slides.length>0){visibleSlideId=slides[0].id}return slides}function previousSlide(){if(slideAnimation&&slideAnimation.isActive()){slideAnimation.progress(1)}if(slideAnimationCurrent&&slideAnimationCurrent.isActive()){slideAnimationCurrent.progress(1)}if(visibleSlideCount===-1){animateFade("previous")}else{animateSlide("previous")}if(slideChangeCallback){var children=getSlides();var visibleSlideIndex=getVisibleSlideIndex();slideChangeCallback("previous",visibleSlideIndex,children[visibleSlideIndex].domNode)}if(pauseVideosOnSlideChange){pauseAllHtml5Videos()}}function pauseAllHtml5Videos(){const checkElement=function(el){if(el.type==="html5videoWidget"){if(context.getElementStyles(el.id).visible&&!el.previewRenditionPlaying()){el.pause()}return}const childrenEls=context.getElementChildren(el.id);childrenEls.forEach(c=>checkElement(c))};const children=getSlides();children.forEach(s=>{checkElement(s)})}function setUpPauseCarouselOnVideoPlay(){const checkElement=function(el){if(el.type==="html5videoWidget"){if(context.getElementStyles(el.id).visible){el.onPlay(()=>{if(!el.previewRenditionPlaying()){pause();pausedCarouselAfterSlideChange=true}})}return}const childrenEls=context.getElementChildren(el.id);childrenEls.forEach(c=>checkElement(c))};const children=getSlides();children.forEach(s=>{checkElement(s)})}function animateFade(direction){if(slideAnimation&&slideAnimation.isActive()){slideAnimation.progress(1)}if(slideAnimationCurrent&&slideAnimationCurrent.isActive()){slideAnimationCurrent.progress(1)}animating=true;var currentSlide=getVisibleSlideIndex();var targetSlide=direction==="next"?currentSlide+1:currentSlide-1;var children=getSlides();if(targetSlide===-1){targetSlide=children.length-1}else if(targetSlide===children.length){targetSlide=0}visibleSlideId=children[targetSlide].id;slideAnimationCurrent=window.TweenLite.to(children[currentSlide].domNode,.5,{autoAlpha:0});slideAnimation=window.TweenLite.to(children[targetSlide].domNode,.5,{autoAlpha:1,onComplete:function(){animating=false}})}function animateFadeToSlideId(targetSlideId){var currentSlideIndex=getVisibleSlideIndex();var children=getSlides();var currentSlide=children[currentSlideIndex];if(targetSlideId===currentSlide.id){return}var targetSlideIndex=children.findIndex(function(child){return child.id===targetSlideId});visibleSlideId=children[targetSlideIndex].id;if(slideAnimation&&slideAnimation.isActive()){slideAnimation.progress(1)}if(slideAnimationCurrent&&slideAnimationCurrent.isActive()){slideAnimationCurrent.progress(1)}animating=true;slideAnimationCurrent=window.TweenLite.to(currentSlide.domNode,.5,{autoAlpha:0});slideAnimation=window.TweenLite.to(children[targetSlideIndex].domNode,.5,{autoAlpha:1,onComplete:function(){animating=false}})}function animateSlide(direction,step,durationParam,animationEndCallback){var oldVisibleSlideIndex=getVisibleSlideIndex();if(slideAnimation&&slideAnimation.isActive()){slideAnimation.progress(1)}if(slideAnimationCurrent&&slideAnimationCurrent.isActive()){slideAnimationCurrent.progress(1)}step=step||1;animating=true;durationParam=durationParam!=undefined?durationParam:duration;var children=getSlides();var childNodes=children.map(function(c){return c.domNode});var tempSlideNode=null;if(loops&&childNodes.length===visibleSlideCount){var leftIdx=oldVisibleSlideIndex;var rightIdx=oldVisibleSlideIndex-1;if(rightIdx===-1){rightIdx=childNodes.length-1}var actualNode;var box;if(direction==="next"){box=getBox(childNodes.length);actualNode=childNodes[leftIdx]}else{box=getBox(childNodes.length-1);actualNode=childNodes[rightIdx]}var fakeNodeList=actualNode.parentNode.querySelectorAll(".temp-carousel-node");for(let i=0;i<fakeNodeList.length;i++){var fakeNode=fakeNodeList[i];fakeNode.parentNode.removeChild(fakeNode)}if(direction==="previous"){tempSlideNode=actualNode.cloneNode(true);actualNode.parentNode.appendChild(tempSlideNode);tempSlideNode.style[directionsProps.side]=box[directionsProps.point].value+""+box[directionsProps.point].unit}else{var parentNode=actualNode.parentNode;tempSlideNode=actualNode.cloneNode(true);parentNode.replaceChild(tempSlideNode,actualNode);parentNode.appendChild(actualNode);actualNode.style[directionsProps.side]=box[directionsProps.point].value+""+box[directionsProps.point].unit}removeIds(tempSlideNode);dom.addClass(tempSlideNode,"temp-carousel-node");childNodes.push(tempSlideNode)}var visibleSlideIndex;if(direction==="next"){visibleSlideIndex=oldVisibleSlideIndex+step;if(loops){if(visibleSlideIndex===children.length){visibleSlideIndex=0}}else{if(visibleSlideIndex>children.length-visibleSlideCount){visibleSlideIndex=children.length-visibleSlideCount;step=visibleSlideIndex-oldVisibleSlideIndex}}}else{visibleSlideIndex=oldVisibleSlideIndex-step;if(loops){if(visibleSlideIndex===-1){visibleSlideIndex=children.length-1}childNodes[visibleSlideIndex].style[directionsProps.side]="-"+(childNodes[visibleSlideIndex][directionsProps.measureSize]+gapWidth)+"px"}else{if(visibleSlideIndex<0){visibleSlideIndex=0;step=oldVisibleSlideIndex-visibleSlideIndex}}}var updateDataSource=function(){if(elementDataSource){var endSlide=(visibleSlideIndex+children.length+(direction==="next"?-1:0))%children.length;var ds=children[endSlide].getElementDataSource();var targetRowNumber=ds.getRowNumber()+(direction==="next"?children.length:-children.length);elementDataSource.getTotalRows(function(err,totalRows){if(targetRowNumber<0){targetRowNumber=totalRows+targetRowNumber}else if(targetRowNumber>=totalRows){targetRowNumber-=totalRows}ds.setRowNumber(targetRowNumber)})}};if(direction==="previous"){updateDataSource()}if(children&&children.length>=visibleSlideIndex){visibleSlideId=children[visibleSlideIndex].id}if(step===0){animating=false;return}var tweenProperties={onComplete:function(){if(direction==="next"){updateDataSource()}if(loops){if(tempSlideNode!==null){tempSlideNode.parentNode.removeChild(tempSlideNode);childNodes.pop()}if(direction==="next"){dom.setDisplayOnAllParents(childNodes[0]);var negativeEl=childNodes.find(function(c){return parseInt(c.style[directionsProps.side],10)<0});if(negativeEl){var gap=(children.length-1)*gapWidth;var width=0;if(directionsProps.measureSize==="offsetHeight"){width=childNodes[0].getBoundingClientRect().height}else if(directionsProps.measureSize==="offsetWidth"){width=childNodes[0].getBoundingClientRect().width}negativeEl.style[directionsProps.side]=width*(children.length-1)+gap+"px"}dom.setDisplayOnAllParents(childNodes[0],true)}}animating=false;if(animationEndCallback){animationEndCallback()}var eventName="carouselMiddleSlide";if(visibleSlideIndex===0){eventName="carouselFirstSlide"}else if(visibleSlideIndex===childNodes.length-visibleSlideCount){eventName="carouselLastSlide"}events.emitGlobal(eventName,{domEvent:{target:div},carouselId:config.id,context:context,slideIndex:visibleSlideIndex,slideId:visibleSlideId})}};if(childNodes.length){var value=0;dom.setDisplayOnAllParents(childNodes[0]);if(directionsProps.measureSize==="offsetHeight"){value=childNodes[0].getBoundingClientRect().height}else if(directionsProps.measureSize==="offsetWidth"){value=childNodes[0].getBoundingClientRect().width}dom.setDisplayOnAllParents(childNodes[0],true);tweenProperties[directionsProps.side]=(direction==="next"?"-":"+")+"="+(value+gapWidth)*step;slideAnimation=window.TweenLite.to(childNodes,durationParam,tweenProperties)}return tweenProperties}function updateProperties(config,styles){var carouselWidget=styles.carouselWidget||{};gapWidth=0;if(carouselWidget.gapWidth!==undefined){gapWidth=carouselWidget.gapWidth}else{gapWidth=config.carouselWidget.gapWidth||0}fixedWidth=carouselWidget.fixedWidth||config.carouselWidget.fixedWidth||false;visibleSlideCount=carouselWidget.visibleSlideCount||config.carouselWidget.visibleSlideCount||0;slideDirection=carouselWidget.slideDirection||config.carouselWidget.slideDirection||0;duration=carouselWidget.duration||config.carouselWidget.duration||.5;loops=config.carouselWidget.loops===false?false:true;pauseOnHover=config.carouselWidget.pauseOnHover||false;if(config.carouselWidget.pauseVideosOnSlideChange!=undefined){pauseVideosOnSlideChange=config.carouselWidget.pauseVideosOnSlideChange}}function updated(){if(slideAnimation){slideAnimation.pause(0)}if(slideAnimationCurrent){slideAnimationCurrent.pause(0)}var styles=context.getElementStyles(config.id);updateProperties(config,styles);var children=getSlides();var visibleSlideIndex=getVisibleSlideIndex();if(slideDirection==="vertical"){directionsProps={side:"top",point:"y",measureSize:"offsetHeight",size:"height"}}else{directionsProps={side:"left",point:"x",measureSize:"offsetWidth",size:"width",direction:"next"};if(!swipeLeftListenerDestroy&&!swipeRightListenerDestroy){swipeLeftListenerDestroy=dom.addEventListener(div,"swiped-left",nextSlide);swipeRightListenerDestroy=dom.addEventListener(div,"swiped-right",previousSlide)}}if(pauseOnHover){if(!mouseEnterListenerDestroy&&!mouseLeaveListenerDestroy){mouseEnterListenerDestroy=dom.addEventListener(div,"mouseenter",pause);mouseLeaveListenerDestroy=dom.addEventListener(div,"mouseleave",function(){if(pausedCarouselAfterSlideChange){return}resume()})}}if(loops){bringElementToFirstPosition(visibleSlideIndex,children)}positionSlides(children);var oldIndex=visibleSlideIndex;if(!loops&&visibleSlideCount!=-1){moveToSlideIndex(oldIndex)}else{animateToSlideIndex(visibleSlideIndex)}if(pauseVideosOnSlideChange){setUpPauseCarouselOnVideoPlay()}}function onRender(carouselId,defs,styles,wasCreated){updateProperties(config,styles);if(wasCreated&&!context.getMergedContent().inEditor&&config.dataSource&&config.dataSource.type==="feed"){elementDataSource.getTotalRows(function(err,totalRows){var elementDefinitions=context.getActiveConfig().elements;context.getActiveConfig().mediaqueries.forEach(function(mediaquery,mediaqueryIndex){var templateSlideId="";var mqEls=mediaquery.elements;for(var mqElId in mqEls){var el=mqEls[mqElId];if(el.parentId===carouselId){if(!templateSlideId){templateSlideId=mqElId}mqEls[mqElId].visible=false}}if(!templateSlideId){log.warn("Carousel element has no slides to use with datasource");return}var templateStyles=mediaquery.elements[templateSlideId];var templateDefs=elementDefinitions[templateSlideId];var templateElementIds=null;var minNumberOfSlides=Math.min(visibleSlideCount+1,totalRows);var loadRows=Math.max(minNumberOfSlides,visibleSlideCount);for(var i=0;i<loadRows;i++){var slideDef=Object.assign({},templateDefs,{dataSource:{type:"parentFeedRow",row:i%totalRows}});var slideStyles=Object.assign({},templateStyles,{visible:true});var newSlideId=carouselId+"-mq-"+mediaqueryIndex+"-dynslide-"+i;elementDefinitions[newSlideId]=slideDef;mediaquery.elements[newSlideId]=slideStyles;var duplicates=duplicateTree(templateSlideId,newSlideId);if(!templateElementIds){templateElementIds=duplicates.map(function(d){return d._templateElementId})}var duplicatesByTemplate={};duplicates.forEach(function(d){duplicatesByTemplate[d._templateElementId]=d});duplicates.forEach(function(el){for(var propName in el){if(!Array.isArray(el[propName])){continue}el[propName].forEach(function(evData){if(!evData.data||templateElementIds.indexOf(evData.data.targetElementId)===-1){return}var remappedTarget=duplicatesByTemplate[evData.data.targetElementId];evData.data.targetElementId=remappedTarget._elementId})}})}function duplicateTree(rootId,newParentId){var newElements=[];for(var elId in mediaquery.elements){if(mediaquery.elements[elId].parentId===rootId){var newId=newParentId+"-"+elId;var elDefinition=dom.Object.clone(elementDefinitions[elId]);elDefinition._elementId=newId;elDefinition._templateElementId=elId;elementDefinitions[newId]=elDefinition;mediaquery.elements[newId]=Object.assign({},dom.Object.clone(mediaquery.elements[elId]),{parentId:newParentId});newElements.push(elDefinition);newElements.push.apply(newElements,duplicateTree(elId,newId))}}return newElements}});context.renderTree(carouselId)})}updated()}function setVisibleSlide(id){visibleSlideId=id;updated()}function removeSlide(id){context.setElementStyles(id,{visible:false})}function setVisibleSlideIndex(vIndex){var children=getSlides();var id=children[vIndex].id;visibleSlideId=id;updated()}function animateToSlide(id,durationParam){if(!context.getElementStyles(id).visible){context.setElementStyles(id,{visible:true})}var oldVisibleSlideIndex=getVisibleSlideIndex();var children=getSlides();var vIndex=children.findIndex(function(child){return child.id===id});var direction="next";var step=vIndex-oldVisibleSlideIndex;if(step<0){direction="previous";step=Math.abs(step)}if(visibleSlideCount===-1){animateFadeToSlideId(id)}else{for(var i=0;i<step;i++){animateSlide(direction,1,durationParam)}}}function animateToSlideIndex(vIndex){var oldVisibleSlideIndex=getVisibleSlideIndex();var children=getSlides();if(!children.length){return}var id=children[vIndex].id;var direction="next";var step=vIndex-oldVisibleSlideIndex;if(step<0){direction="previous";step=Math.abs(step)}if(step!=0){if(visibleSlideCount===-1){animateFadeToSlideId(id)}else{for(var i=0;i<step;i++){animateSlide(direction,1)}}}}function moveToSlideIndex(vIndex){var oldVisibleSlideIndex=getVisibleSlideIndex();var direction="next";var step=vIndex-oldVisibleSlideIndex;if(step<0){direction="previous";step=Math.abs(step)}for(var i=0;i<step;i++){animateSlide(direction,1,0)}}function moveToSlide(slideId){if(!loops){setVisibleSlide(slideId)}else{var children=getSlides();var vIndex=children.findIndex(function(child){return child.id===slideId});moveToSlideIndex(vIndex)}}function bringElementToFirstPosition(index,slides){if(slides.length>=1){for(var i=0;i<index;i++){slides.push(slides.shift())}}}function positionSlides(children){children.forEach(positionSingleSlide);if(children&&children.length>0){var index=0;visibleSlideId=children[index].id;events.emitGlobal("carouselFirstSlide",{domEvent:{target:div},carouselId:config.id,context:context,slideIndex:index,slideId:visibleSlideId})}}function positionSingleSlide(slide,index){var layout=sideBySide;if(visibleSlideCount===-1){layout=stacked}layout(slide.domNode,index);function sideBySide(childNode,index){var box=getBox(index);var sideStyle={anchor:{x:"left",y:"top"},visible:true,y:{value:0,unit:"px"},x:{value:0,unit:"px"},width:{value:100,unit:"%"},height:{value:100,unit:"%"},opacity:1,css:{overflow:"hidden",visibility:"inherit"}};sideStyle[directionsProps.point]=box[directionsProps.point];sideStyle[directionsProps.size]=box[directionsProps.size];context.setElementStyles(childNode.id,sideStyle)}function stacked(childNode,index){context.setElementStyles(childNode.id,{anchor:{x:"left",y:"top"},x:{value:0,unit:"px"},y:{value:0,unit:"px"},width:{value:100,unit:"%"},height:{value:100,unit:"%"},visible:true,opacity:childNode.id===visibleSlideId?1:0,css:{overflow:"hidden",visibility:childNode.id===visibleSlideId?"inherit":"hidden"}})}}function getBox(index){var gap=gapWidth;var domEl=context.getElementById(config.id).domNode;dom.setDisplayOnAllParents(domEl);var carouselWidth=domEl.offsetWidth;var carouselHeight=domEl.offsetHeight;dom.setDisplayOnAllParents(domEl,true);var gapWidthCalculated=(visibleSlideCount-1)*gap;var slideWidth=Math.round((carouselWidth-gapWidthCalculated)/visibleSlideCount);var slideHeight=Math.round((carouselHeight-gapWidthCalculated)/visibleSlideCount);if(fixedWidth){slideWidth=fixedWidth;slideHeight=fixedWidth}var widthValue={value:slideWidth,unit:"px"};var heightValue={value:slideHeight,unit:"px"};var x=slideWidth*index+index*gap;var y=slideHeight*index+index*gap;return{x:{value:x,unit:"px"},y:{value:y,unit:"px"},width:widthValue,height:heightValue}}}function createSlide(container,context,config){var document=container.getAdDocument();var div=document.createElement("div");var elementDataSource=undefined;if(config.dataSource&&config.dataSource.type==="parentFeedRow"){var parentFeed=findParentFeed(config.id);if(parentFeed){elementDataSource=dataSource.feedRow(parentFeed,config.dataSource.row)}}return{domNode:div,getElementDataSource:function(){return elementDataSource}};function findParentFeed(elId){var p=context.getElementParent(elId);if(!p){return null}var ds=p.getElementDataSource?p.getElementDataSource():null;if(ds){return ds}return findParentFeed(p.id)}}module.exports={create:create,createSlide:createSlide}},{"../dataSource":30,"../dom":32,"../events":52,"../log":65}],36:[function(require,module,exports){const dom=require("../dom");const log=require("../log");const events=require("../events");const fonts=require("../fonts");const countdownCSS=`
	.rad-countdown {
		font-family: Arial;
	}

	.rad-countdown-number {
		font-size: 55px;
		text-align: center;
		padding: 0.35em;
		background: white;
	}

	.rad-countdown-label {
		font-size: 20px;
		text-align: center;
		padding-top: 0.5em;
		text-transform: capitalize;
	}
`;const defaultNumbersFontSettings={letterSpacing:{value:0,unit:"px"},lineHeight:"1.0",fontStyle:"normal",fontSize:{value:55,unit:"px"},textAlign:"center",textVerticalAlign:"middle",color:"black"};const defaultLabelsFontSettings={letterSpacing:{value:0,unit:"px"},lineHeight:"1.0",fontStyle:"normal",fontSize:{value:20,unit:"px"},textAlign:"center",textVerticalAlign:"middle",color:"black"};function create(container,context,config){container.addCSS(countdownCSS,"rad-countdown");const document=container.getAdDocument();const root=document.createElement("div");root.className="rad-countdown";const flexContainer=document.createElement("div");flexContainer.style.height="100%";flexContainer.style.display="flex";flexContainer.style.alignItems="center";flexContainer.style.justifyContent="space-between";root.appendChild(flexContainer);let durationElement=null;const displayMode=config.countdown.displayMode||"days:hours:minutes:seconds";const fields={};if(displayMode.indexOf("days")!==-1){fields.days=createField("days");flexContainer.appendChild(fields.days.root)}if(displayMode.indexOf("hours")!==-1){fields.hours=createField("hours");flexContainer.appendChild(fields.hours.root)}if(displayMode.indexOf("minutes")!==-1){fields.minutes=createField("minutes");flexContainer.appendChild(fields.minutes.root)}if(displayMode.indexOf("seconds")!==-1){fields.seconds=createField("seconds");flexContainer.appendChild(fields.seconds.root)}const timerEndTime=new Date(config.countdown.endTime);let timerHandle;return{domNode:root,destroy:function(){clearTimeout(timerHandle);timerHandle=null},onRender:function(elId,elementDefs,styles){const labelFont=styles.fonts&&styles.fonts.labels?styles.fonts.labels:defaultLabelsFontSettings;const numberFont=styles.fonts&&styles.fonts.numbers?styles.fonts.numbers:defaultNumbersFontSettings;for(let k in fields){const field=fields[k];dom.setInlineStyles(field.label,fonts.fontSettingsToCSSProperties(labelFont));dom.setInlineStyles(field.number,fonts.fontSettingsToCSSProperties(numberFont))}},rendered:function(){if(!timerHandle){update()}function update(){const timeLeft=timerEndTime-new Date;const seconds=Math.max(0,Math.floor(timeLeft/1e3))||0;const minutes=Math.max(0,Math.floor(seconds/60))||0;const hours=Math.max(0,Math.floor(minutes/60))||0;const days=Math.max(0,Math.floor(hours/24))||0;if(fields.seconds){fields.seconds.number.innerHTML=String(seconds-minutes*60).padStart(2,0)}if(fields.minutes){fields.minutes.number.innerHTML=String(minutes-hours*60).padStart(2,0)}if(fields.hours){fields.hours.number.innerHTML=String(hours-days*24).padStart(2,0)}if(fields.days){fields.days.number.innerHTML=String(days).padStart(2,0)}if(timeLeft>0){timerHandle=setTimeout(update,1e3)}else{timerHandle=null;events.emitGlobal("countdownFinished",{domEvent:{target:root},context:context})}}}}}function createField(labelText){const root=document.createElement("div");const number=document.createElement("div");number.className="rad-countdown-number";root.appendChild(number);const label=document.createElement("div");label.className="rad-countdown-label";label.innerHTML=labelText;root.appendChild(label);return{root:root,number:number,label:label}}module.exports={create:create,getDefaultNumbersFontSettings:()=>fonts.copyFontSettings(defaultNumbersFontSettings),getDefaultLabelsFontSettings:()=>fonts.copyFontSettings(defaultLabelsFontSettings)}},{"../dom":32,"../events":52,"../fonts":59,"../log":65}],37:[function(require,module,exports){var dom=require("../dom");var device=require("../device");function create(document,content){var elContainer=document.createElement("div");elContainer.className="shrinkableText-container";var elTable=document.createElement("div");elTable.className="shrinkableText-table";elContainer.appendChild(elTable);var elContent=document.createElement("div");elContent.className="shrinkableText-content";elContent.innerHTML=content;elTable.appendChild(elContent);return{callAfterFirstRenderingForSafari:callAfterFirstRenderingForSafari,domNode:elContainer,initialized:false,onRender:onRender,styles:null,timerFirstRender:null,updateShrink:updateShrink,getShrunkenFontSize:getShrunkenFontSize,updateContent:function(newContent){elContent.innerHTML=newContent;this.updateShrink()}}}function onRender(elId,defs,styles){this.styles=styles;if(!styles.fontSettings){return}convertOldData(elId,defs,styles);this.domNode.style.visibility="hidden";forceRerender(this.domNode);this.updateShrink()}function convertOldData(elId,defs,styles){if("shrinkableText"in styles){styles.textContaining=styles.shrinkableText?"shrink":"wrap";delete styles.shrinkableText}if(styles.textContaining==="contain"){styles.textContaining="shrink"}}function updateShrink(options){var styles=this.styles;var elContainer=this.domNode;this.callAfterFirstRenderingForSafari(function(){if(!styles){throw new Error("Styles must have been set")}if(!options){options={}}elContainer.style.visibility="";functions.updateContent(elContainer,styles,options)})}function callAfterFirstRenderingForSafari(callback){var deviceProperties=device.getDeviceProperties(window);if(!deviceProperties.isSafari){callback()}else if(this.initialized){callback()}else if(this.timerFirstRender){}else{this.timerFirstRender=window.setTimeout(function(){callback();this.initialized=true}.bind(this),150)}}function updateContent(elContainer,styles,options){functions.adjustToLetterSpacing(elContainer,styles);if(styles.autoHeight){functions.setWrapStyle(elContainer,styles)}else if(styles.textContaining==="wrap-shrink"){functions.setShrinkWrapStyle(elContainer,styles,options)}else if(styles.textContaining==="shrink"){functions.setShrinkStyle(elContainer,styles,options)}else{functions.setWrapStyle(elContainer,styles)}}function clearStyles(elContainer){var elTable=findTableElement(elContainer);var elContent=findContentElement(elContainer);if(!elTable||!elContent){throw createUnexpectedDomStructureError()}elTable.style.display="";elTable.style.height="";elContent.style.bottom="";elContent.style.display="";elContent.style.left="";elContent.style.position="";elContent.style.right="";elContent.style.textAlign="";elContent.style.top="";elContent.style.transform="";elContent.style.transformOrigin="";elContent.style.verticalAlign="";elContent.style.whiteSpace="";elContent.style.width=""}function setShrinkWrapStyle(elContainer,styles,options){functions.clearStyles(elContainer);var elTable=findTableElement(elContainer);if(!elTable){throw createUnexpectedDomStructureError()}var locatorCss={display:"table",height:"100%",width:"100%"};dom.setInlineStyles(elTable,locatorCss);var elContent=findContentElement(elContainer);if(!elContent){throw createUnexpectedDomStructureError()}var containerRect=measureRectangle(elContainer,options.containerUpdated);var fontSize1=styles.fontSettings.fontSize.value;dom.setInlineStyles(elContainer,{"font-size":fontSize1+"px"});var contentRect1=measureRectangle(elContent,options.contentUpdated);var ratio1=calculateRatio(containerRect,contentRect1);if(ratio1>1){var fontSize2=fontSize1/ratio1;dom.setInlineStyles(elContainer,{"font-size":fontSize2+"px"});var contentRect2=measureRectangle(elContent,options.contentUpdated);var ratio2=calculateRatio(containerRect,contentRect2);var bestFontSize=findBestFontSize(elContainer,containerRect,elContent,options.contentUpdated,fontSize1,ratio1,fontSize2,ratio2);if(Number.isNaN(bestFontSize)){console.warn("Font size not found for "+styles.id)}var fontSize=bestFontSize||fontSize2;dom.setInlineStyles(elContainer,{"font-size":fontSize+"px"});elContainer.setAttribute("data-shrunken-font-size",String(fontSize))}else{var enoughFontSize=styles.fontSettings.fontSize.value;elContainer.setAttribute("data-shrunken-font-size",String(enoughFontSize))}var contentCss={display:"table-cell","text-align":styles.fontSettings.textAlign,"vertical-align":styles.fontSettings.textVerticalAlign};dom.setInlineStyles(elContent,contentCss)}function findBestFontSize(elContainer,containerRect,elContent,contentUpdated,fontSize1,ratio1,fontSize2,ratio2){var log={};log[fontSize1]=ratio1;log[fontSize2]=ratio2;var left=Math.floor(fontSize2);var right=Math.floor(fontSize1);while(left<=right){var center=left+Math.floor((right-left)/2);dom.setInlineStyles(elContainer,{"font-size":center+"px"});var contentRect=measureRectangle(elContent,contentUpdated);var ratio=calculateRatio(containerRect,contentRect);log[center]=ratio;if(ratio>1){if(log[center-1]<1){return center-1}right=center-1}else{if(log[center+1]>=1){return center}left=center+1}}if(log[left-1]>=1){return left-1}return NaN}function setShrinkStyle(elContainer,styles,options){functions.clearStyles(elContainer);var elContent=findContentElement(elContainer);if(!elContent){throw createUnexpectedDomStructureError()}setInitialStyles(elContent);var containerRect=measureRectangle(elContainer,options.containerUpdated);var firstFontSize=100;dom.setInlineStyles(elContainer,{"font-size":firstFontSize+"px"});var firstContentRect=measureRectangle(elContent,options.contentUpdated);var firstScale=functions.calculateBestScale(containerRect,firstContentRect);var approxFontSize=Math.floor(firstFontSize*firstScale);elContainer.setAttribute("data-shrunken-font-size",String(approxFontSize));var contentRect=measureRectangle(elContent,options.contentUpdated);var css=Object.assign({},functions.buildPositionStyleValues(containerRect,styles),functions.buildTransformValue(containerRect,contentRect,styles),functions.buildTransformOriginValue(styles));dom.setInlineStyles(elContent,css)}function findTableElement(elContainer){var elTable=elContainer.querySelector(".shrinkableText-table");return elTable}function findContentElement(elContainer){var elContent=elContainer.querySelector(".shrinkableText-content");return elContent}function setInitialStyles(elContent){dom.setInlineStyles(elContent,{display:"inline-block",position:"absolute","white-space":"nowrap"})}function buildPositionStyleValues(containerRect,styles){var css={};var horizontal=styles.fontSettings.textAlign;var vertical=styles.fontSettings.textVerticalAlign;if(horizontal==="left"||horizontal==="justify"){css.left=containerRect.paddingLeft+"px";css.right=""}else if(horizontal==="right"){css.left="";css.right=containerRect.paddingRight+"px"}else if(horizontal==="center"){css.left="50%";css.right=""}if(vertical==="top"){css.top=containerRect.paddingTop+"px";css.bottom=""}else if(vertical==="bottom"){css.top="";css.bottom=containerRect.paddingBottom+"px"}else if(vertical==="middle"){css.top="50%";css.bottom=""}return css}function buildTransformValue(containerRect,contentRect,styles){var transforms=[];var horizontal=styles.fontSettings.textAlign;if(horizontal==="center"){transforms.push("translateX(-50%)")}var vertical=styles.fontSettings.textVerticalAlign;if(vertical==="middle"){transforms.push("translateY(-50%)")}var scale=functions.calculateBestScale(containerRect,contentRect);transforms.push("scale("+scale+")");return{transform:transforms.join(" ")}}function buildTransformOriginValue(styles){var horizontalAlign=styles.fontSettings.textAlign;if(horizontalAlign==="justify"){horizontalAlign="left"}var verticalAlign=styles.fontSettings.textVerticalAlign;if(verticalAlign==="middle"){verticalAlign="center"}return{"transform-origin":horizontalAlign+" "+verticalAlign}}function calculateRatio(containerRect,contentRect){var vScale=contentRect.height/containerRect.height;var hScale=contentRect.width/containerRect.width;var ratio=Math.max(vScale===Infinity?0:vScale,hScale===Infinity?0:hScale)||0;return ratio}function calculateBestScale(containerRect,contentRect){var vScale=containerRect.height/contentRect.height;var hScale=containerRect.width/contentRect.width;var scale=Math.min(vScale===Infinity?0:vScale,hScale===Infinity?0:hScale)||0;return scale}function measureRectangle(domNode,updated){var rect={};if(updated===undefined){updated=true}if(!updated){rect={height:Number(domNode.getAttribute("data-last-height")),paddingBottom:Number(domNode.getAttribute("data-last-padding-bottom")),paddingLeft:Number(domNode.getAttribute("data-last-padding-left")),paddingRight:Number(domNode.getAttribute("data-last-padding-right")),paddingTop:Number(domNode.getAttribute("data-last-padding-top")),width:Number(domNode.getAttribute("data-last-width"))}}var valid=rect.height>0&&rect.width>0&&rect.paddingTop>0&&rect.paddingRight>0&&rect.paddingBottom>0&&rect.paddingLeft>0;if(!valid){var domStyle=window.getComputedStyle(domNode);rect.paddingTop=parseInt(domStyle.paddingTop,10)||0;rect.paddingRight=parseInt(domStyle.paddingRight,10)||0;rect.paddingBottom=parseInt(domStyle.paddingBottom,10)||0;rect.paddingLeft=parseInt(domStyle.paddingLeft,10)||0;rect.height=domNode.clientHeight-rect.paddingTop-rect.paddingBottom;rect.width=domNode.clientWidth-rect.paddingRight-rect.paddingLeft;domNode.setAttribute("data-last-height",String(rect.height));domNode.setAttribute("data-last-width",String(rect.width));domNode.setAttribute("data-last-padding-top",String(rect.paddingTop));domNode.setAttribute("data-last-padding-right",String(rect.paddingRight));domNode.setAttribute("data-last-padding-bottom",String(rect.paddingBottom));domNode.setAttribute("data-last-padding-left",String(rect.paddingLeft))}return rect}function setWrapStyle(elContainer,styles){functions.clearStyles(elContainer);var elTable=findTableElement(elContainer);if(!elTable){throw createUnexpectedDomStructureError()}var locatorCss={display:"table",height:"100%",width:"100%"};dom.setInlineStyles(elTable,locatorCss);var elContent=findContentElement(elContainer);if(!elContent){throw createUnexpectedDomStructureError()}var contentCss={display:"table-cell","text-align":styles.fontSettings.textAlign,"vertical-align":styles.fontSettings.textVerticalAlign};dom.setInlineStyles(elContent,contentCss)}function adjustToLetterSpacing(elContainer,styles){var letterSpacing=styles.fontSettings.letterSpacing;if(letterSpacing){var elContent=findContentElement(elContainer);if(!elContent){throw createUnexpectedDomStructureError()}var value;if(letterSpacing.value>0){value=letterSpacing.value+letterSpacing.unit;elContent.style.paddingRight="";elContent.style.paddingLeft=value}else{value=-letterSpacing.value+letterSpacing.unit;elContent.style.paddingRight=value;elContent.style.paddingLeft=""}}}function getShrunkenFontSize(){var styles=this.styles;if(!styles){throw new Error("Styles must have been set")}if(styles.textContaining==="wrap-shrink"||styles.textContaining==="shrink"){var elContainer=this.domNode;var fontSize=Number(elContainer.getAttribute("data-shrunken-font-size"));return fontSize}return styles.fontSettings.fontSize.value}function forceRerender(domNode){domNode.offsetHeight}function createUnexpectedDomStructureError(){return new Error("Unexpected DOM structure (The custom JS broke it? Please use `radEl.updateContent()` instead of `radEl.domNode.innerHTML`.)")}var functions={adjustToLetterSpacing:adjustToLetterSpacing,buildPositionStyleValues:buildPositionStyleValues,buildTransformOriginValue:buildTransformOriginValue,buildTransformValue:buildTransformValue,calculateBestScale:calculateBestScale,clearStyles:clearStyles,measureRectangle:measureRectangle,setShrinkWrapStyle:setShrinkWrapStyle,setShrinkStyle:setShrinkStyle,setWrapStyle:setWrapStyle,updateContent:updateContent,updateShrink:updateShrink};create.functions=functions;module.exports=create},{"../device":31,"../dom":32}],38:[function(require,module,exports){var dom=require("../dom");var url=require("../url");var device=require("../device");function create(container,context,config){var document=container.getAdDocument();var img=document.createElement("img");var deviceProps=device.getDeviceProperties(container.getAdWindow());var elemConfig=getElemConfig(config);elemConfig.image=url.toFullUrl(elemConfig.image,context.adContent);if(elemConfig.toggleImage){elemConfig.toggleImage=url.toFullUrl(elemConfig.toggleImage,context.adContent)}img.src=elemConfig.image;return{domNode:img,rendered:rendered,onRender:onRender};function onRender(){if(context.adContent.screenshot){return}var videoEl=context.getElementById(elemConfig.videoId);var s=context.getElementStyles(config.id);var displayValue=s.visible?"":"none";if(videoEl&&videoEl.autoHideEnabled()&&!deviceProps.isMobileOrTablet){displayValue="none"}if(deviceProps.isiPhone&&deviceProps.iosVersion<10&&elemConfig.control=="muteunmute"){displayValue="none"}if(deviceProps.isMobileOrTablet&&videoEl&&!videoEl.showControlsMobileEnabled()){displayValue="none"}context.setElementStyles(config.id,{css:{display:displayValue}})}function rendered(){if(context.adContent.screenshot){return}var videoEl=context.getElementById(elemConfig.videoId);if(elemConfig.control==="playpause"){setupPlayPause(videoEl,img,config,context,deviceProps)}if(elemConfig.control==="muteunmute"){setupMuteUnmute(videoEl,img,config,context)}if(elemConfig.control==="restart"){setupRestart(videoEl,img,config,context)}if(elemConfig.control==="fullscreen"){setupFullscreen(videoEl,img,config,context)}if(elemConfig.control==="clickthrough"){setupClickthrough(videoEl,img,config,context)}}}function setupPlayPause(videoEl,img,config,context,deviceProps){if(!videoEl){return}var triggerFullScreenOnMobile=config.videoCustomPlayMuteRestartControl.triggerFullScreenOnMobile||false;videoEl.onPlay(function(){if(!videoEl.previewRenditionPlaying()){img.src=getElemConfig(config).toggleImage}});videoEl.onPause(function(){if(!videoEl.previewRenditionPlaying()){img.src=getElemConfig(config).image}});dom.addEventListener(img,"click",function(){videoEl.event.elId=img.id;if(videoEl.paused){if(triggerFullScreenOnMobile&&deviceProps.isMobile){videoEl.requestFullscreen()}videoEl.play()}else{videoEl.pause()}});videoEl.onHideControls(hideControl.bind({},config.id,context));videoEl.onShowControls(showControl.bind({},config.id,context))}function setupMuteUnmute(videoEl,img,config,context){if(!videoEl){return}updateState();videoEl.onVolumeChange(updateState);dom.addEventListener(img,"click",function(){videoEl.event.elId=img.id;if(videoEl.muted){videoEl.unmute();return}videoEl.mute()});function updateState(){if(videoEl.muted){img.src=getElemConfig(config).toggleImage}else{img.src=getElemConfig(config).image}}videoEl.onHideControls(hideControl.bind({},config.id,context));videoEl.onShowControls(showControl.bind({},config.id,context))}function setupRestart(videoEl,img,config,context){if(!videoEl){return}dom.addEventListener(img,"click",function(){videoEl.event.elId=img.id;videoEl.restart({startedFromAutoPlay:false})});videoEl.onHideControls(hideControl.bind({},config.id,context));videoEl.onShowControls(showControl.bind({},config.id,context))}function setupFullscreen(videoEl,img,config,context){if(!videoEl){return}dom.addEventListener(img,"click",function(){videoEl.event.elId=img.id;videoEl.requestFullscreen()});videoEl.onHideControls(hideControl.bind({},config.id,context));videoEl.onShowControls(showControl.bind({},config.id,context))}function setupClickthrough(videoEl,img,config,context){if(!videoEl){return}dom.addEventListener(img,"click",function(){videoEl.event.elId=img.id});videoEl.onHideControls(hideControl.bind({},config.id,context));videoEl.onShowControls(showControl.bind({},config.id,context))}function getElemConfig(config){return config.videoCustomPlayMuteRestartControl||config.videoClickthroughControl}function hideControl(elementId,context){if(context.getElementStyles(elementId).visible){context.setElementStyles(elementId,{css:{display:"none"}})}}function showControl(elementId,context){if(context.getElementStyles(elementId).visible){context.setElementStyles(elementId,{css:{display:"block"}})}}module.exports={create:create}},{"../device":31,"../dom":32,"../url":79}],39:[function(require,module,exports){var dom=require("../dom");var events=require("../events");var url=require("../url");var device=require("../device");var preview=require("../preview");var uuid=require("../uuid");var defaultFitLayout="contain";function makeFallbackObject(el,onRenderCallback){return{domNode:el,onRender:onRenderCallback,play:function(){},pause:function(){},getCurrentTime:function(){return 0},setCurrentTime:function(){},getDuration:function(){return 0},onSeeking:function(cb){},onSeeked:function(cb){},onPlaying:function(cb){},onWaiting:function(cb){},getEnded:function(){return false},previewRenditionPlaying:function(){return false},getCurrentFrameRate:function(){return 30},onTimeUpdate:function(){},onLoadedMetadata:function(){},onPlay:function(){}}}function create(container,context,config){var document=container.getAdDocument();var el=document.createElement("div");var deviceProps=device.getDeviceProperties(container.getAdWindow());var styles=context.getElementStyles(config.id);var src;var videoPlayUUID;var firstPlay=true;var newPlay=true;var pausedByPageVisibility=false;var posterCached=false;var quartiles={first:false,second:false,third:false};var previewRenditionEnabled=false;var previewRenditionInteraction=false;var previewRenditionInitialView=true;var editorRenditionIsPreview=false;var previewGroupId=config.onPreviewVideoEnd&&config.onPreviewVideoEnd.length>0&&config.onPreviewVideoEnd[0].data.targetElementId;var emitter=events.createEmitter();var listeners=[];var skipNextPauseEvents=false;config.html5videoWidget.initialize=context.adContent.externalVideoInitialize;if(context.adContent.screenshot&&config.html5videoWidget.fallbackImage){var onRenderCallback=function(elId){var fallBackFullURL=url.toFullUrl(config.html5videoWidget.fallbackImage,context.adContent);context.setElementStyles(elId,{css:{background:"transparent no-repeat url('"+fallBackFullURL+"')center center",backgroundSize:"contain"}})};return makeFallbackObject(el,onRenderCallback)}if(context.adContent.screenshot&&!config.html5videoWidget.poster){var onRenderCallback=function(elId){if(config&&config.onVideoEnd){var oldCustomCss=context.getActiveConfig().customcss?context.getActiveConfig().customcss:"";var newCustomCss="";for(var i in config.onVideoEnd){if(config.onVideoEnd[i].action==="toggleElement"&&(config.onVideoEnd[i].data.mode==="show"||config.onVideoEnd[i].data.mode==="hide")){newCustomCss+=" #"+config.onVideoEnd[i].data.targetElementId+" {display:"+(config.onVideoEnd[i].data.mode==="show"?"block":"none")+"!important;}"}}context.updateCustomCSS(oldCustomCss+newCustomCss)}};return makeFallbackObject(el,onRenderCallback)}if(config.html5videoWidget.poster&&!posterCached){var tempPoster=new Image;tempPoster.src=url.toFullUrl(config.html5videoWidget.poster,context.adContent);posterCached=true}var videoEl=document.createElement("video");dom.setInlineStyles(videoEl,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%","min-width":"100%","min-height":"100%",opacity:"0","object-fit":styles.fit?styles.fit.layout:defaultFitLayout});if(context.adContent.https&&config.html5videoWidget.renditionBaseUrl&&!/^(https:\/\/)/.test(config.html5videoWidget.renditionBaseUrl)){config.html5videoWidget.renditionBaseUrl=config.html5videoWidget.renditionBaseUrl.replace("http","https")}var loopVideo=config.html5videoWidget.loop;var loopVideoCount=loopVideo?config.html5videoWidget.loopCount:1;var suppressMetrics=config.html5videoWidget.suppressMetrics;var previewLoop=config.html5videoWidget.previewLoop===undefined?true:config.html5videoWidget.previewLoop;var previewUnmute=config.html5videoWidget.previewUnmute===undefined?true:config.html5videoWidget.previewUnmute;var previewHideControls=config.html5videoWidget.previewHideControls===undefined?true:config.html5videoWidget.previewHideControls;var previewAlways=config.html5videoWidget.previewAlways===undefined?false:config.html5videoWidget.previewAlways;var allBrowsers=config.html5videoWidget.allBrowsers===undefined?false:config.html5videoWidget.allBrowsers;var currentFrameRate=config.html5videoWidget.frameRate||30;var currentFrameRate=config.html5videoWidget.frameRate||30;videoEl.controls=config.html5videoWidget.controls;videoEl.autoplay=config.html5videoWidget.autoplay;videoEl.muted=videoEl.autoplay||config.html5videoWidget.mute;if(videoEl||config.html5videoWidget.mute){videoEl.setAttribute("muted","")}var creativeInteraction=false;Object.values(context.getActiveConfig().elements).forEach(function(el){if(el.wasInteractedWith){creativeInteraction=true}});if(creativeInteraction&&config.html5videoWidget.clickMute&&!deviceProps.isSafari){videoEl.muted=false;videoEl.removeAttribute("muted")}if(deviceProps.isiOs){videoEl.setAttribute("playsInline","")}videoEl.setAttribute("controlsList","nodownload");if(config.html5videoWidget.poster&&deviceProps.isMobileOrTablet&&!config.html5videoWidget.showControlsMobile){emitter.emit("hideControls")}el.appendChild(videoEl);if(context.adContent.inEditor){var editorRendition=config.html5videoWidget.renditions.find(function(r){return r.editor});if(!editorRendition){editorRendition=config.html5videoWidget.renditions[config.html5videoWidget.renditions.length-1]}if(editorRendition){src=config.html5videoWidget.renditionBaseUrl+editorRendition.filePath;editorRendition.editor=true}editorRenditionIsPreview=editorRendition&&editorRendition.isPreview?true:false;if(previewGroupId&&context.isElementInLiveStyles(previewGroupId)){context.getElementStyles(previewGroupId).visible=editorRenditionIsPreview}if(!config.html5videoWidget.poster||config.html5videoWidget.autoplay){videoEl.src=src}}else{if(config.html5videoWidget.renditions.length>0){src=getSelectedVideoSource();videoEl.src=src+"?ci="+context.adContent.id}}var showControlsTimeout,fullscreen=false,fullscreenRequested=false;var elObject={domNode:el,onCanPlay:function(cb){emitter.addListener("canplay",cb)},onLoadStart:function(cb){emitter.addListener("loadstart",cb)},onPlay:function(cb){emitter.addListener("play",cb)},onPause:function(cb){emitter.addListener("pause",cb)},onHideControls:function(cb){emitter.addListener("hideControls",cb)},onShowControls:function(cb){emitter.addListener("showControls",cb)},onVolumeChange:function(cb){emitter.addListener("volumeChange",cb)},onEnded:function(cb){emitter.addListener("ended",cb)},destroy:function(){emitter.removeAllListeners();listeners.forEach(function(remove){remove()})},autoHideEnabled:function(){return!!config.html5videoWidget.autohide},previewRenditionPlaying:function(){return previewRenditionEnabled&&!previewRenditionInteraction},showControlsMobileEnabled:function(){return!!config.html5videoWidget.showControlsMobile},getDuration:function(){return isNaN(videoEl.duration)?0:videoEl.duration},getTimelineDuration:function(){return config.html5videoWidget.duration/1e3},muted:videoEl.muted,paused:videoEl.paused,getEnded:function(){return videoEl.ended},requestFullscreen:function(){fullscreenRequested=true;if(videoEl.requestFullscreen){videoEl.requestFullscreen()}else if(videoEl.msRequestFullscreen){videoEl.msRequestFullscreen()}else if(videoEl.mozRequestFullScreen){videoEl.mozRequestFullScreen()}else if(videoEl.webkitRequestFullscreen){videoEl.webkitRequestFullscreen()}else if(videoEl.webkitEnterFullscreen){videoEl.webkitEnterFullscreen()}if(config.html5videoWidget.clickMute&&elObject.event.elId!="auto"){elObject.unmute()}sendAdformAnalyticsEvent(35,"Full Screen On Button Press");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}sendAnalyticsEvent("fullscreen")},setCurrentTime:function(time){videoEl.currentTime=time},getCurrentTime:function(){return videoEl.currentTime},getCurrentFrameRate:function(){return currentFrameRate},seek:function(seconds){videoEl.currentTime+=seconds},onSeeking:function(cb){listeners.push(dom.addEventListener(videoEl,"seeking",cb))},onSeeked:function(cb){listeners.push(dom.addEventListener(videoEl,"seeked",cb))},onPlaying:function(cb){listeners.push(dom.addEventListener(videoEl,"playing",cb))},onWaiting:function(cb){listeners.push(dom.addEventListener(videoEl,"waiting",cb))},onTimeUpdate:function(cb){return dom.addEventListener(videoEl,"timeupdate",cb)},onLoadedMetadata:function(cb){return dom.addEventListener(videoEl,"loadedmetadata",cb)},editorIsPlaying:false,editorNeverPlayed:true,editorSetCurrentTime:function(timeSeconds){if(!context.adContent.inEditor){return}videoEl.currentTime=timeSeconds;if(timeSeconds>=videoEl.duration&&!videoEl.ended){videoEl.play()}if((timeSeconds===0||timeSeconds>=videoEl.duration)&&this.editorIsPlaying){emitter.emit("pause");this.editorIsPlaying=false;events.emitGlobal("videoPause",{videoId:config.id,domEvent:{target:el},context:context})}else if(timeSeconds!==0&&!this.editorIsPlaying){if(!videoEl.src){videoEl.src=src}emitter.emit("play");this.editorIsPlaying=true;setTimeout(function(){events.emitGlobal("videoPlay",{videoId:config.id,domEvent:{target:el},context:context})},1)}if(this.editorNeverPlayed){videoEl.play();setTimeout(function(){videoEl.pause()},1)}},editorRunPauseEvents:function(){this.editorIsPlaying=false;setTimeout(function(){runPauseEvents({target:el})},1)},restart:function(options={startedFromAutoPlay:false}){elObject.startedFromAutoPlay=options.startedFromAutoPlay;newPlay=true;videoEl.currentTime=0;quartiles.first=false;quartiles.second=false;quartiles.third=false;if(config.html5videoWidget.restartLoop){loopVideoCount=config.html5videoWidget.loopCount}if(videoEl.paused){var autoPlayPromise=videoEl.play();if(autoPlayPromise!==undefined){autoPlayPromise.catch(function(error){videoEl.play()}).then(function(){})}}if(config.html5videoWidget.clickMute&&elObject.event.elId!="auto"){elObject.unmute()}sendAdformAnalyticsEvent(39,"Replay Button Press");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}sendAnalyticsEvent("restart")},resetpause:function(){videoEl.pause();newPlay=true;videoEl.currentTime=0;quartiles.first=false;quartiles.second=false;quartiles.third=false},play:function(options={startedFromAutoPlay:false}){elObject.startedFromAutoPlay=options.startedFromAutoPlay;var autoPlayPromise=videoEl.play();if(autoPlayPromise!==undefined){autoPlayPromise.catch(function(error){if(deviceProps.isiOs){videoEl.setAttribute("playsinline","")}if(config.html5videoWidget.autoplay){videoEl.setAttribute("autoplay","");videoEl.muted=true;videoEl.setAttribute("muted","")}if(error&&error.name&&error.name==="NotAllowedError"){events.emitGlobal("videoUnableToAutoplay",{elId:el.id,videoId:config.id,domEvent:{target:el},context:context});events.emitGlobal("videoEnded",{elId:el.id,videoId:config.id,domEvent:{target:el,notAllowedError:true},context:context})}else{videoEl.play()}}).then(function(){})}},pause:function(options){if(options&&options.events===false){skipNextPauseEvents=true}videoEl.pause()},mute:function(){videoEl.muted=true;videoEl.setAttribute("muted","");events.emitGlobal("videoMuted",{videoId:config.id,domEvent:{target:el},context:context})},unmute:function(){videoEl.muted=false;videoEl.removeAttribute("muted");events.emitGlobal("videoUnMuted",{videoId:config.id,domEvent:{target:el},context:context})},load:function(){videoEl.load()},updated:function(){if(!videoEl.paused){playHandler({target:el})}else{pauseHandler({target:el})}fullscreen=false;fullscreenRequested=false},event:{elId:"auto"},getSelectedVideoSource:function(){return getSelectedVideoSource()},onRender:function(_elId,_defs,styles,elementCreated,fromSizeChange){var objectFit=styles.fit?styles.fit.layout:defaultFitLayout;var objectPosition=styles.fit&&styles.fit.position?styles.fit.position.x+" "+styles.fit.position.y:"center center";dom.setInlineStyles(videoEl,{"object-fit":objectFit,"object-position":objectPosition});if(config.html5videoWidget.poster&&videoEl.style.opacity=="0"){context.setElementStyles(config.id,{css:{background:"transparent no-repeat url('"+url.toFullUrl(config.html5videoWidget.poster,context.adContent)+"')center center",backgroundSize:"contain"}})}else{context.setElementStyles(config.id,{css:{background:"transparent",overflow:"hidden"}})}if(previewGroupId&&context.isElementInLiveStyles(previewGroupId)){if(context.adContent.inEditor){context.getElementStyles(previewGroupId).visible=editorRenditionIsPreview}else{context.getElementStyles(previewGroupId).visible=previewRenditionEnabled}}if(!elementCreated&&fromSizeChange&&config.html5videoWidget.pauseOnResize){this.pause()}if(_defs.onVideoTimeReached&&_defs.onVideoTimeReached.length>0){_defs.onVideoTimeReached.forEach(action=>{action.wasCalled=false})}}};listeners.push(dom.addEventListener(videoEl,"webkitbeginfullscreen",function(){videoEl.muted=false;videoEl.removeAttribute("muted");fullscreen=!fullscreen;fullscreenRequested=false},false));listeners.push(dom.addEventListener(videoEl,"webkitendfullscreen",function(){fullscreen=!fullscreen},false));listeners.push(dom.addEventListener(videoEl,"webkitfullscreenchange",function(){videoEl.muted=false;videoEl.removeAttribute("muted");fullscreen=!fullscreen;fullscreenRequested=false},false));listeners.push(dom.addEventListener(videoEl,"mozfullscreenchange",function(){videoEl.muted=false;videoEl.removeAttribute("muted");fullscreen=!fullscreen;fullscreenRequested=false},false));listeners.push(dom.addEventListener(videoEl,"fullscreenchange",function(){videoEl.muted=false;videoEl.removeAttribute("muted");fullscreen=!fullscreen;fullscreenRequested=false},false));function pauseHandler(ev){elObject.paused=videoEl.paused;if(skipNextPauseEvents){skipNextPauseEvents=false}else{runPauseEvents(ev)}}function runPauseEvents(ev){if(elObject.event&&elObject.event.elId&&elObject.event.elId!="auto"){sendAdformAnalyticsEvent(31,"Pause Button Press");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}}sendAnalyticsEvent("pause");emitter.emit("pause");events.emitGlobal("videoPause",{videoId:config.id,domEvent:ev,context:context})}listeners.push(dom.addEventListener(videoEl,"pause",pauseHandler));listeners.push(dom.addEventListener(videoEl,"canplay",function(){videoEl.style.background=""}));listeners.push(dom.addEventListener(videoEl,"loadstart",function(){videoEl.style["background-color"]="black";videoEl.style["background-image"]="url("+url.toFullUrl(config.html5videoWidget.initialize,context.adContent)+")";videoEl.style["background-position-x"]="center";videoEl.style["background-position-y"]="center";videoEl.style["background-repeat"]="no-repeat";videoEl.style["background-size"]="initial";videoEl.style["background-attachment"]="initial";videoEl.style["ackground-origin"]="initial";videoEl.style["background-clip"]="initial"}));function playHandler(ev){elObject.editorNeverPlayed=false;if(videoEl.style.opacity=="0"){videoEl.style.opacity="1";context.setElementStyles(config.id,{css:{background:"transparent"}})}if(!videoEl.src){videoEl.src=src;var autoPlayPromise=videoEl.play();if(autoPlayPromise!==undefined){autoPlayPromise.catch(function(error){videoEl.play()}).then(function(){})}}if(config.html5videoWidget.clickMute&&elObject.event.elId!="auto"){elObject.unmute()}if(videoEl.currentTime<1&&newPlay){newPlay=!newPlay;firstPlay=false;videoPlayUUID=uuid.generateUUID();if(!previewRenditionEnabled||previewRenditionEnabled&&previewRenditionInitialView){if(elObject.previewRenditionPlaying()){events.emitGlobal("previewVideoStarted",{videoId:config.id,domEvent:{target:el},context:context})}else{events.emitGlobal("videoStarted",{elId:el.id})}sendAdformAnalyticsEvent(25,"Video Play Start");sendAnalyticsEvent("started")}if(deviceProps.isMobileOrTablet&&!config.html5videoWidget.showControlsMobile&&(!previewRenditionEnabled||previewRenditionEnabled&&!previewHideControls)){clearTimeout(showControlsTimeout);showControlsTimeout=showControlsOnMobile()}}else{if(elObject.event&&elObject.event.elId&&elObject.event.elId!="auto"){sendAdformAnalyticsEvent(30,"Play Button Press");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}}sendAnalyticsEvent("play")}elObject.paused=videoEl.paused;emitter.emit("play");events.emitGlobal("videoPlay",{videoId:config.id,domEvent:ev,context:context});if(previewRenditionEnabled&&previewHideControls||context.adContent.inEditor&&editorRenditionIsPreview&&previewHideControls){emitter.emit("hideControls")}}listeners.push(dom.addEventListener(videoEl,"play",playHandler));listeners.push(dom.addEventListener(videoEl,"volumechange",function(){if(elObject.muted!==videoEl.muted){if(videoEl.muted){sendAdformAnalyticsEvent(34,"Sound Off Button Press");sendAnalyticsEvent("mute");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}}else{sendAdformAnalyticsEvent(33,"Sound On Button Press");sendAnalyticsEvent("unmute");if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition()}}}elObject.muted=videoEl.muted;if(videoEl.muted){videoEl.setAttribute("muted","")}else{videoEl.removeAttribute("muted")}emitter.emit("volumeChange")}));listeners.push(dom.addEventListener(videoEl,"ended",function(ev){newPlay=true;quartiles.first=false;quartiles.second=false;quartiles.third=false;elObject.editorIsPlaying=false;if(!previewRenditionEnabled||previewRenditionEnabled&&previewRenditionInitialView){sendAdformAnalyticsEvent(29,"Video Complete");sendAnalyticsEvent("ended");emitter.emit("ended");previewRenditionInitialView=false}if(loopVideo){loopVideoCount--}if(loopVideo&&loopVideoCount>0||previewRenditionEnabled&&!previewRenditionInteraction&&previewLoop||context.adContent.inEditor&&editorRenditionIsPreview&&previewLoop){elObject.play();if(deviceProps.isIE){newPlay=!newPlay;firstPlay=false;videoPlayUUID=uuid.generateUUID();sendAdformAnalyticsEvent(25,"Video Play Start");events.emitGlobal("videoStarted",{elId:el.id});sendAnalyticsEvent("started")}}else{if(config.html5videoWidget.poster){videoEl.style.opacity="0";if(config.html5videoWidget.poster){context.setElementStyles(config.id,{css:{background:"transparent no-repeat url('"+url.toFullUrl(config.html5videoWidget.poster,context.adContent)+"')center center",backgroundSize:"contain"}})}}events.emitGlobal("videoEnded",{elId:el.id,videoId:config.id,domEvent:ev,context:context})}}));listeners.push(dom.addEventListener(videoEl,"timeupdate",function(){events.emitGlobal("videoTimeUpdate",{videoId:config.id,domEvent:{target:el},context:context});if(!previewRenditionEnabled||previewRenditionEnabled&&previewRenditionInitialView){var currentTime=Math.floor(videoEl.currentTime/videoEl.duration*100);if(currentTime>=25&&!quartiles.first){quartiles.first=true;sendAdformAnalyticsEvent(26,"25% of Video Play");sendAnalyticsEvent("25")}else if(currentTime>=50&&!quartiles.second){quartiles.second=true;sendAdformAnalyticsEvent(27,"50% of Video Play");sendAnalyticsEvent("50")}else if(currentTime>=75&&!quartiles.third){quartiles.third=true;sendAdformAnalyticsEvent(28,"75% of Video Play");sendAnalyticsEvent("75")}}}));listeners.push(dom.addEventListener(videoEl,"click",function(ev){if((videoEl.paused||videoEl.ended)&&hasAction(config.onClick,"clickthrough")){ev.stopPropagation()}if(previewRenditionEnabled&&!previewRenditionInteraction){disablePreviewRendition();return}if(config.html5videoWidget.desktopPause&&!deviceProps.isMobileOrTablet&&!fullscreen&&!fullscreenRequested&&!videoEl.paused&&!videoEl.ended){videoEl.pause()}if(config.html5videoWidget.mobilePause&&deviceProps.isMobileOrTablet&&!fullscreen&&!fullscreenRequested&&!videoEl.paused&&!videoEl.ended){videoEl.pause()}if(config.html5videoWidget.poster&&newPlay){var autoPlayPromise=videoEl.play();if(autoPlayPromise!==undefined){autoPlayPromise.catch(function(error){videoEl.play()}).then(function(){})}}if(deviceProps.isMobileOrTablet&&!config.html5videoWidget.showControlsMobile&&(!previewRenditionEnabled||previewRenditionEnabled&&!previewHideControls)){clearTimeout(showControlsTimeout);showControlsTimeout=showControlsOnMobile()}elObject.event.elId=el.id}));if(!context.adContent.inEditor&&!config.html5videoWidget.ignorePageVisibilityOnPause){events.addGlobalListener("pagevisibility",pageVisibility)}function pageVisibility(hidden){if(hidden){if(deviceProps.isChrome){if(!videoEl.paused&&!fullscreenRequested&&!fullscreen){pausedByPageVisibility=true;elObject.pause()}}else{if(!videoEl.paused){pausedByPageVisibility=true;elObject.pause()}}}else{if(videoEl.pause&&pausedByPageVisibility){pausedByPageVisibility=false;elObject.play()}}}events.addGlobalListener("hideAd",hideAd);function hideAd(){if(!videoEl.paused){elObject.pause()}videoEl.muted=true;videoEl.autoplay=false;config.html5videoWidget.playOnVisibility=false;config.html5videoWidget.keepPlayingWhenNotInView=false}events.addGlobalListener("previewPageForceRender",previewPageForceRender);function previewPageForceRender(){previewRenditionInteraction=false;creativeInteraction=false;Object.values(context.getActiveConfig().elements).forEach(function(el){if(el.wasInteractedWith){el.wasInteractedWith=false}});events.removeGlobalListener("previewPageForceRender",previewPageForceRender);events.removeGlobalListener("hideAd",hideAd);if(!config.html5videoWidget.ignorePageVisibilityOnPause){events.removeGlobalListener("pagevisibility",pageVisibility)}}if(!deviceProps.isMobileOrTablet){if(config.html5videoWidget.hoverMute){listeners.push(dom.addEventListener(el,"mouseover",function(){if(videoEl.muted){elObject.unmute();emitter.emit("volumeChange")}}));listeners.push(dom.addEventListener(el,"mouseleave",function(){if(!videoEl.muted){elObject.mute();emitter.emit("volumeChange")}}))}if(config.html5videoWidget.hoverPlayPause){listeners.push(dom.addEventListener(el,"mouseover",function(){if(videoEl.paused){elObject.play()}}));listeners.push(dom.addEventListener(el,"mouseleave",function(){elObject.pause()}))}if(config.html5videoWidget.autohide){listeners.push(dom.addEventListener(el,"mouseover",function(){if(config.html5videoWidget.autohide&&(!previewRenditionEnabled||previewRenditionEnabled&&!previewHideControls)){emitter.emit("showControls")}}));listeners.push(dom.addEventListener(el,"mouseleave",function(){if(config.html5videoWidget.autohide){emitter.emit("hideControls")}}))}}if(!context.adContent.inEditor&&!context.adContent.screenshot){var startStop;if(context.adContent.customVideoInViewPercetage){startStop=context.adContent.customVideoInViewPercetage}listeners.push(container.onVisibilityChange(function(visibility){if(visibility){if(firstPlay&&videoEl.autoplay){elObject.play({startedFromAutoPlay:true})}else if(!firstPlay&&config.html5videoWidget.playOnVisibility){if(!config.html5videoWidget.keepPlayingWhenNotInView){if(!videoEl.muted){elObject.mute()}}if(videoEl.paused){elObject.play()}}}else{if(!config.html5videoWidget.keepPlayingWhenNotInView){elObject.pause()}if(config.html5videoWidget.autoplayWhenNotInView&&firstPlay&&videoEl.autoplay){elObject.play({startedFromAutoPlay:true})}if(config.html5videoWidget.muteWhenNotInView){if(!videoEl.muted){elObject.mute()}}}},startStop))}function showControlsOnMobile(){emitter.emit("showControls");return setTimeout(function(){emitter.emit("hideControls")},5e3)}function sendAnalyticsEvent(eventName){if(!suppressMetrics){context.sendAnalyticsEvent({e:previewRenditionEnabled?"interact.videopreview":"interact.video",v:eventName,sId:videoPlayUUID,av:videoEl.muted?"muted":"unmuted",elId:elObject.event.elId,parentelementId:el.id});elObject.event.elId="auto";elObject.event.name=null}}function sendAdformAnalyticsEvent(eventID,eventName){if(context.adContent.aft&&!suppressMetrics){context.sendAdformAnalyticsEvent(eventID,eventName)}}function disablePreviewRendition(){events.emitGlobal("previewVideoEnded",{videoId:config.id,domEvent:{target:el},context:context});previewRenditionInteraction=true;previewRenditionEnabled=false;newPlay=true;src=getSelectedVideoSource();videoEl.src=src+"?ci="+context.adContent.id;if(videoEl.muted&&previewUnmute){elObject.unmute();emitter.emit("volumeChange")}if(previewHideControls){emitter.emit("showControls")}}function getSelectedVideoSource(){var rendition=getOptimalRendition();if(!rendition){return""}if(previewGroupId&&context.isElementInLiveStyles(previewGroupId)){context.getElementStyles(previewGroupId).visible=rendition.isPreview?true:false}if(videoEl.autoplay&&rendition.disableAutoplay){videoEl.autoplay=false}var renditionBaseUrl=config.html5videoWidget.renditionBaseUrl.replace("video.","video2.");return renditionBaseUrl+rendition.filePath}function getOptimalRendition(){var renditions=config.html5videoWidget.renditions;var screenSize=dom.getScreenSize();var matchingBrowser=!allBrowsers?deviceProps.isChrome:true;var autoplayRendition=!previewRenditionInteraction&&matchingBrowser&&config.html5videoWidget.autoplay&&!context.getOpenStateAdObj();var previewProps;var previewDevice=false;var previewMobileOrTablet=false;var previewDeviceDimensions;var previewRendition=null;if(context.adContent.preview){previewProps=preview.getPreviewProperties(container.getAdWindow());previewDevice=previewProps.isPreviewDevice?true:false;previewMobileOrTablet=previewProps.isMobileOrTablet?true:false;if(previewDevice){previewDeviceDimensions=previewProps.deviceDimensions}}var possibleRenditions=renditions.filter(function(r){if(r.isPreview&&r.used){previewRendition=r;previewRendition.previewRendition=true;return false}return r.used});var fitsWithSizeExceeding=false;var renditionsFittingScreen=possibleRenditions.filter(function(r){var fitsScreenOrContainer;if(!deviceProps.isMobileOrTablet&&!previewMobileOrTablet){if(previewDevice){fitsScreenOrContainer=r.width>=previewDeviceDimensions.width&&r.height>=previewDeviceDimensions.height}else{if(container.getAdDocument().body.clientWidth==0||container.getAdDocument().body.clientHeight==0){return false}fitsScreenOrContainer=r.width>=container.getAdDocument().body.clientWidth&&r.height>=container.getAdDocument().body.clientHeight}}else if(previewMobileOrTablet){fitsScreenOrContainer=r.width>=previewDeviceDimensions.width&&r.width>=previewDeviceDimensions.height}else{fitsScreenOrContainer=r.width>=screenSize.width&&r.width>=screenSize.height}if(autoplayRendition&&fitsScreenOrContainer){if(!fitsWithSizeExceeding){fitsWithSizeExceeding=r.size>3.36&&previewRendition}fitsScreenOrContainer=r.size<=3.36}return fitsScreenOrContainer});var previewAlwaysEnabled=previewRendition&&previewAlways;if(renditionsFittingScreen.length>0&&!previewAlwaysEnabled){return getBestQualityRendition(renditionsFittingScreen,autoplayRendition,false)}else if(autoplayRendition&&(fitsWithSizeExceeding||previewRendition)){previewRenditionEnabled=true;return previewRendition}var bestRendition=getBestQualityRendition(possibleRenditions,autoplayRendition,true);if(bestRendition.disableAutoplay&&previewRendition){bestRendition=previewRendition;previewRenditionEnabled=true}return bestRendition;function getBestQualityRendition(renditions,autoplayRendition,bestQuality){return renditions.reduce(function(previousBest,rendition){var comparison=compareBitrates(rendition,previousBest,bestQuality);if(comparison){if(bestQuality&&autoplayRendition){if(rendition.size<=3.36){return rendition}}else{return rendition}}if(autoplayRendition&&previousBest.size>3.36){previousBest.disableAutoplay=true}return previousBest},renditions[0])}function compareBitrates(a,b,bestQuality){if(bestQuality){if(parseInt(a.bitRate,10)>parseInt(b.bitRate,10)){return true}}else{if(parseInt(a.bitRate,10)<parseInt(b.bitRate,10)){return true}}return false}}return elObject}function hasAction(actions,actionType){if(!actions){return false}return actions.some(function(a){return a.action===actionType})}module.exports={create:create}},{"../device":31,"../dom":32,"../events":52,"../preview":73,"../url":79,"../uuid":81}],40:[function(require,module,exports){var eventHandlers=require("../eventHandlers");var url=require("../url");var visibility=require("../visibility");var emptyPng="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2P4////fwAJ+wP9BUNFygAAAABJRU5ErkJggg==";module.exports={create:function(container,context,config){var window=container.getAdWindow();var ad=window.Radical.getAdByWindow(window);var document=container.getAdDocument();var domNode=document.createElement("div");var content=document.createElement("div");content.style.width="100%";content.style.height="100%";domNode.appendChild(content);loadExternals(document,config).then(function(pannellum){visibility.onVisibilityChange(container,function(visible){if(visible){initializeInstances(domNode,pannellum,config,ad,context)}else{destroyInstances(domNode)}})});return{domNode:domNode,onRender:debounce(window,function(elId){var map=getPannellumViewerMap(window);var viewer=map.get(elId);if(!viewer){return}viewer.resize()},100)}}};function loadExternals(document,config){return Promise.all([loadScript(document,config.image360.version||"2.5.6"),loadStylesheet(document,config.image360.version||"2.5.6")]).then(function(results){var pannellum=results[0];return pannellum})}function loadScript(document,version){var url="https://cdn.jsdelivr.net/npm/pannellum@"+version+"/build/pannellum.js";return new Promise(function(resolve,reject){var el=document.createElement("script");el.src=url;el.onerror=reject;el.onload=function(){var window=document.defaultView;var pannellum=window&&window.pannellum;if(pannellum){resolve(pannellum)}else{reject(new Error("Failed to load Pannellum for 360 image"))}};document.head.appendChild(el)})}function loadStylesheet(document,version){var url="https://cdn.jsdelivr.net/npm/pannellum@"+version+"/build/pannellum.css";return new Promise(function(resolve,reject){var el=document.createElement("link");el.rel="stylesheet";el.href=url;el.onerror=reject;el.onload=function(){resolve()};document.head.appendChild(el)})}function initializeInstances(domNode,pannellum,def,ad,context){var window=domNode.ownerDocument.defaultView;var id=domNode.id;var inEditor=ad.getMergedContent().inEditor;var el=domNode.firstChild;if(!window||!el||!(el instanceof window.HTMLElement)){throw new Error("Something went wrong")}var scenesOption={};def.image360.scenes.forEach(function(scene){scenesOption[scene.id]=createSceneOption(def,ad,context,scene)});var viewer=pannellum.viewer(el,{autoLoad:true,firstScene:def.image360.initialSceneId,friction:.5,keyboardZoom:false,mouseZoom:false,preview:emptyPng,sceneFadeDuration:1e3,scenes:scenesOption,showControls:!inEditor});viewer.on("error",function(){if(!window||!el||!(el instanceof window.HTMLElement)){throw new Error("Something went wrong")}errorFunc(el)});var map=getPannellumViewerMap(window);map.set(id,viewer)}function createSceneOption(def,ad,context,scene){var hotSpots=scene.hotspots.map(function(hotspot){var data={ad:ad,context:context,element:def,hotspot:hotspot};return{clickHandlerArgs:data,clickHandlerFunc:clickHandlerFunc,createTooltipArgs:data,createTooltipFunc:createTooltipFunc,pitch:hotspot.pitch,type:"info",yaw:hotspot.yaw}});var src=url.toFullUrl(scene.src,context.adContent);var srcXhr=src+"?xhr=1";var pannellumScene={hfov:scene.hfov,hotSpots:hotSpots,panorama:srcXhr,pitch:scene.pitch,type:"equirectangular",yaw:scene.yaw};return pannellumScene}function destroyInstances(domNode){var window=domNode.ownerDocument.defaultView;if(!window){return}var map=getPannellumViewerMap(window);var viewer=map.get(domNode.id);if(!viewer){return}viewer.destroy();map.delete(domNode.id)}function getPannellumViewerMap(window){if(!window.RAD){window.RAD={}}if(!window.RAD.image360ViewerMap){window.RAD.image360ViewerMap=new Map}return window.RAD.image360ViewerMap}function errorFunc(el){var elError=el.querySelector(".pnlm-error-msg");if(!elError){return}var elLinks=elError.querySelectorAll("a");elLinks.forEach(function(elLink){elLink.target="_blank"})}function createTooltipFunc(hotSpotDiv,data){var document=hotSpotDiv.ownerDocument;var src=data.hotspot.src||data.element.image360.defaultHotspotIcon;hotSpotDiv.classList.remove("pnlm-sprite");if(data.ad.getMergedContent().inEditor){hotSpotDiv.style.pointerEvents="none"}var el=document.createElement("img");el.src=url.toFullUrl(src,data.context.adContent);el.style.width="30px";el.style.height="30px";el.style.objectFit="contain";el.onerror=function(event){var elImage360=hotSpotDiv.closest(".rad-element");var id=elImage360?elImage360.id:"unknown";var message="[Radical] image360 ("+id+"): "+'Failed to load image: "'+src+'"';console.error(message,event)};hotSpotDiv.appendChild(el)}function clickHandlerFunc(event,data){var ad=data.ad;var hotspot=data.hotspot;ad.domEventHandler(event,"click",function(ev){eventHandlers.handleInteraction(ad,ev,hotspot.clickActions)})}function debounce(window,callback,wait){var lastArgs=[];var tmExec=0;return function(){lastArgs=arguments;if(tmExec){window.clearTimeout(tmExec)}tmExec=window.setTimeout(function(){callback.apply(window,lastArgs)},wait)}}},{"../eventHandlers":51,"../url":79,"../visibility":82}],41:[function(require,module,exports){var dom=require("../dom");var url=require("../url");function create(container,context,config){var document=container.getAdDocument();var img=document.createElement("img");img.src=url.toFullUrl(config.imageButtonWidget.image,context.adContent);var events=[];events.push(dom.addEventListener(img,"mouseover",function(){img.src=url.toFullUrl(config.imageButtonWidget.hoverImage,context.adContent)}));events.push(dom.addEventListener(img,"mouseout",function(){img.src=url.toFullUrl(config.imageButtonWidget.image,context.adContent)}));events.push(dom.addEventListener(img,"mousedown",function(){img.src=url.toFullUrl(config.imageButtonWidget.activeImage,context.adContent)}));events.push(dom.addEventListener(img,"mouseup",function(){img.src=url.toFullUrl(config.imageButtonWidget.image,context.adContent)}));return{domNode:img,destroy:function(){events.forEach(function(remove){remove()})}}}module.exports={create:create}},{"../dom":32,"../url":79}],42:[function(require,module,exports){var dom=require("../dom");var url=require("../url");function create(container,context,config){var wrapper=document.createElement("div");if(!config.omnivirt.videoId){wrapper.innerHTML='<div style="text-align: center; background: silver; height: 100%">No video selected</div>';return{domNode:wrapper}}if(context.adContent.screenshot){if(config.omnivirt.fallbackImage){var screenshot=document.createElement("img");dom.setInlineStyles(screenshot,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%","min-width":"100%","min-height":"100%"});screenshot.src=url.toFullUrl(config.omnivirt.fallbackImage,context.adContent);wrapper.appendChild(screenshot)}return{domNode:wrapper}}var options={autoplay:config.omnivirt.autoplay,videoId:config.omnivirt.videoId};var iframe=document.createElement("iframe");iframe.width="100%";iframe.height="100%";iframe.style.width="100%";iframe.style.height="100%";iframe.frameBorder=0;iframe.scrolling="no";iframe.setAttribute("msallowfullscreen","");iframe.setAttribute("webkitAllowFullScreen","");iframe.setAttribute("mozallowfullscreen","");iframe.setAttribute("allowFullScreen","");iframe.setAttribute("allowTransparency","true");wrapper.appendChild(iframe);iframe.src=url.toFullUrl("//cdn.omnivirt.com/content/"+options.videoId+"?player=true&autoplay="+options.autoplay+"&referer=",context.adContent);return{domNode:wrapper}}module.exports={create:create}},{"../dom":32,"../url":79}],43:[function(require,module,exports){const dom=require("../dom");const url=require("../url");const log=require("../log");const eventHandlers=require("../eventHandlers");const uuid=require("../uuid");const eventNameMap={correct:"onCorrectAnswer",incorrect:"onIncorrectAnswer",complete:"onComplete",incomplete:"onIncomplete"};const analyticsEventMap={hover:"interact.hover",click:"interact.click"};const gameEventNames=["correct","incorrect","complete","incomplete"];eventHandlers.registerHandler("playinWidget.restart",function(ad,ev,evConfig){const widget=ad.getElementById(evConfig.data.playinWidgetId);if(!widget){log.warn("Could not find widget with id "+evConfig.data.playinWidgetId);return}widget.restart()});module.exports={create(container,context,config){const iframe=container.getAdDocument().createElement("iframe");dom.setupIframe(iframe);if(config.playinWidget&&config.playinWidget.widgetAdSourceUrl){iframe.src=url.toFullUrl(config.playinWidget.widgetAdSourceUrl,context.adContent)}const gameSessionId=uuid.generateUUID();container.getAdWindow().addEventListener("message",handleMessage);const elObject={domNode:iframe,destroy:function(){container.getAdWindow().removeEventListener("message",handleMessage)},restart:function(){iframe.src=iframe.src}};return elObject;function handleMessage(event){if(event.source!==iframe.contentWindow){return}if(!event.data.gameEvent||!event.data.gameEvent.eventName){log.warn("Received malformed event from Playin widget");log.warn(event);return}const gameEvent=event.data.gameEvent;const radEvent=eventNameMap[gameEvent.eventName];if(radEvent){triggerEvent(radEvent)}if(gameEvent.eventName==="correct"){triggerEvent(`onWordCompleted_${gameEvent.value}`)}const analyticsEventName=getAnalyticsEventName(gameEvent.eventName);if(analyticsEventName!==null){sendAnalyticsEvent(analyticsEventName,collectWidgetAnalytics(gameEvent))}}function triggerEvent(eventName){if(!config.elementEvents||!config.elementEvents[eventName]){return}const ev={element:elObject,elementConfig:config};eventHandlers.handleEvent(context.getAdObject(),ev,config.elementEvents[eventName])}function sendAnalyticsEvent(eventName,data){context.sendAnalyticsEvent({e:eventName,elId:config.id,...data})}function getAnalyticsEventName(eventName){if(["hover","click","touch","drag","input"].indexOf(eventName)!==-1){return`interact.${eventName}`}if(gameEventNames.indexOf(eventName)!==-1){return"interact.gameevent"}return null}function collectWidgetAnalytics(event){if(gameEventNames.indexOf(event.eventName)!==-1){return{rtype:event.eventName,v:event.value,sId:gameSessionId}}if(event.eventName==="input"){return{v:event.value,sId:gameSessionId}}return{}}}}},{"../dom":32,"../eventHandlers":51,"../log":65,"../url":79,"../uuid":81}],44:[function(require,module,exports){const dom=require("../dom");const log=require("../log");const math=require("../math");function createRangeStyles(rangeId,trackColor,thumbColor){return`
		#${rangeId}.rad-seekbar input[type=range] {
			width: 100%;
			margin: 4.5px 0;
			background-color: transparent;
			-webkit-appearance: none;
		}
		#${rangeId}.rad-seekbar input[type=range]:focus {
			outline: none;
		}
		#${rangeId}.rad-seekbar input[type=range]::-webkit-slider-runnable-track {
			background: rgba(0, 0, 0, 0);
			border: 1px solid ${trackColor};
			border-radius: 1px;
			width: 100%;
			height: 1px;
			cursor: pointer;
		}
		#${rangeId}.rad-seekbar input[type=range]::-webkit-slider-thumb {
			margin-top: -5.5px;
			width: 10px;
			height: 10px;
			background: ${thumbColor};
			border: 1px solid rgba(0, 0, 0, 0);
			border-radius: 50px;
			cursor: pointer;
			-webkit-appearance: none;
		}
		#${rangeId}.rad-seekbar input[type=range]:focus::-webkit-slider-runnable-track {
			background: ${trackColor};
		}
		#${rangeId}.rad-seekbar input[type=range]::-moz-range-track {
			background: rgba(0, 0, 0, 0);
			border: 1px solid ${trackColor};
			border-radius: 1px;
			width: 100%;
			height: 1px;
			cursor: pointer;
		}
		#${rangeId}.rad-seekbar input[type=range]::-moz-range-thumb {
			width: 10px;
			height: 10px;
			background: ${thumbColor};
			border: 1px solid rgba(0, 0, 0, 0);
			border-radius: 50px;
			cursor: pointer;
		}
		#${rangeId}.rad-seekbar input[type=range]::-ms-track {
			background: transparent;
			border-color: transparent;
			border-width: 4.5px 0;
			color: transparent;
			width: 100%;
			height: 1px;
			cursor: pointer;
		}
		#${rangeId}.rad-seekbar input[type=range]::-ms-fill-lower {
			background: #f2f2f2;
			border: 1px solid #FFFFFF;
			border-radius: 2px;
		}
		#${rangeId}.rad-seekbar input[type=range]::-ms-fill-upper {
			background: rgba(0, 0, 0, 0);
			border: 1px solid #FFFFFF;
			border-radius: 2px;
		}
		#${rangeId}.rad-seekbar input[type=range]::-ms-thumb {
			width: 10px;
			height: 10px;
			background: #ffffff;
			border: 1px solid rgba(0, 0, 0, 0);
			border-radius: 50px;
			cursor: pointer;
			margin-top: 0px;
		}
		#${rangeId}.rad-seekbar input[type=range]:focus::-ms-fill-lower {
			background: rgba(0, 0, 0, 0);
		}
		#${rangeId}.rad-seekbar input[type=range]:focus::-ms-fill-upper {
			background: #FFFFFF;
		}
	`}function create(container,context,config){const document=container.getAdDocument();const root=document.createElement("div");root.className="rad-seekbar";if(config.seekbar.showProgressBar===undefined){config.seekbar.showProgressBar=true}const flexContainer=document.createElement("div");flexContainer.style.height="100%";flexContainer.style.display="flex";flexContainer.style.alignItems="center";flexContainer.style.justifyContent="space-around";flexContainer.style.fontVariantNumeric="tabular-nums";root.appendChild(flexContainer);if(config.seekbar.showParentheses){const leftParenthesis=document.createElement("span");leftParenthesis.innerHTML="(";leftParenthesis.style.width="1em";leftParenthesis.style.textAlign="center";flexContainer.appendChild(leftParenthesis)}let currentTimeElement=null;if(config.seekbar.showCurrentTime){currentTimeElement=document.createElement("span");currentTimeElement.innerHTML="00:00";currentTimeElement.style.width="5em";currentTimeElement.style.textAlign="center";flexContainer.appendChild(currentTimeElement)}const input=document.createElement("input");input.addEventListener("touchstart",function(e){e.stopPropagation()},true);if(config.seekbar.showProgressBar){input.min=0;input.max=1e3;input.type="range";flexContainer.appendChild(input)}else{const slash=document.createElement("span");slash.innerHTML="/";flexContainer.appendChild(slash)}let durationElement=null;if(config.seekbar.showDuration){durationElement=document.createElement("span");durationElement.innerHTML="00:00";durationElement.style.width="5em";durationElement.style.textAlign="center";flexContainer.appendChild(durationElement)}if(config.seekbar.showParentheses){const RightParenthesis=document.createElement("span");RightParenthesis.innerHTML=")";RightParenthesis.style.width="1em";RightParenthesis.style.textAlign="center";flexContainer.appendChild(RightParenthesis)}const styleId=`rad-seekbar-${config.id}`;container.replaceNamedCSS(styleId,createRangeStyles(config.id,config.seekbar.trackColor,config.seekbar.thumbColor));const events=[];return{domNode:root,destroy:function(){events.forEach(function(remove){remove()});container.removeNamedCSS(styleId)},rendered:function(){if(!config.seekbar.linkedVideoId){return}const video=context.getElementById(config.seekbar.linkedVideoId);if(!video){log.warn(`Cannot set up seekbar, video ${config.seekbar.linkedVideoId} is missing`);return}updateView();events.push(video.onTimeUpdate(updateView));if(video.getDuration()===0){events.push(video.onLoadedMetadata(updateView))}events.push(dom.addEventListener(input,"input",function(){var frameLength=1/video.getCurrentFrameRate();var endTime=video.getDuration()-frameLength*2;video.setCurrentTime(math.lerp(input.value/input.max,0,endTime))}));video.onHideControls(hideControl.bind({},config.id,context));video.onShowControls(showControl.bind({},config.id,context));function updateView(){const duration=video.getDuration();if(duration===0){input.value=0}else{const currentTime=video.getCurrentTime();input.value=input.max*math.inverseLerp(currentTime,0,duration);if(currentTimeElement){const minutes=String(Math.floor(currentTime/60)).padStart(2,"0");const seconds=String(Math.floor(currentTime)-minutes*60).padStart(2,"0");currentTimeElement.innerHTML=`${minutes}:${seconds}`}if(durationElement){const minutes=String(Math.floor(duration/60)).padStart(2,"0");const seconds=String(Math.floor(duration)-minutes*60).padStart(2,"0");durationElement.innerHTML=`${minutes}:${seconds}`}}}}};function hideControl(elementId,context){if(context.getElementStyles(elementId).visible){context.setElementStyles(elementId,{css:{display:"none"}})}}function showControl(elementId,context){if(context.getElementStyles(elementId).visible){context.setElementStyles(elementId,{css:{display:"block"}})}}}module.exports={create:create}},{"../dom":32,"../log":65,"../math":66}],45:[function(require,module,exports){var dom=require("../dom");var element=require("../../element");function create(container,context,config){var document=container.getAdDocument();var skin=document.createElement("div");return{domNode:skin,onRender:onRender,updated:onRender};function onRender(){var styles=context.getElementStyles(config.id);context.setElementStyles(config.id,{css:{display:styles.visible?"table":"none"}});forceChildStyles()}function forceChildStyles(){context.getElementChildren(config.id).forEach(function(child){var baseStyles={height:{value:100,unit:"%"},css:{display:"table-cell",position:"static"}};if(child.type===element.types.SKIN_COMPARTMENT_WIDGET){baseStyles.width={value:"auto",unit:""}}context.setElementStyles(child.id,baseStyles)})}}function createCompartment(container){var document=container.getAdDocument();var compartment=document.createElement("div");var childRoot=document.createElement("div");dom.setInlineStyles(childRoot,{position:"relative",height:"100%",width:"100%",overflow:"hidden"});compartment.appendChild(childRoot);return{domNode:compartment,childRoot:childRoot}}module.exports={create:create,createCompartment:createCompartment}},{"../../element":6,"../dom":32}],46:[function(require,module,exports){var ruleToText=require("../../element").ruleToText;var createShrinkableText=require("./createShrinkableText");var conditionsTable=require("../conditionsTable");function create(container,context,config){var content=config.textboxWidget.text;setupDataSource(config.dataSource,function(err,value){if(!value){value=""}content=value;if(element){element.updateContent(content)}});setupDataSource(config.textColorDataSource,function(err,value){if(value&&!err){context.setElementStyles(config.id,{fontSettings:{color:value}})}});var document=container.getAdDocument();var element=createShrinkableText(document,content);const shrinkableOnRender=element.onRender;element.onRender=function(elementId,defs,styles,wasCreated){this.styles=styles;const activeConfig=context.getActiveConfig();if(activeConfig.conditionsTable&&activeConfig.activeConditionsTableRow){if(config.dataSource&&config.dataSource.type==="conditionsTable"){const textCol=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.dataSource.property);if(textCol&&textCol.value){config.textboxWidget.text=textCol.value;content=config.textboxWidget.text;element.updateContent(content)}}if(config.textColorDataSource&&config.textColorDataSource.type==="conditionsTable"){const textColorCol=conditionsTable.getValueColumnByName(activeConfig.conditionsTable,activeConfig.activeConditionsTableRow,config.textColorDataSource.property);if(textColorCol&&textColorCol.value){context.setElementStyles(config.id,{fontSettings:{color:textColorCol.value}})}}}shrinkableOnRender.call(element,elementId,defs,styles,wasCreated)};element.domNode.className="textbox-widget";var css=ruleToText({margin:"0 0 0 0"});container.addCSS(".textbox-widget p { "+css+" }","element-textbox-styles");return element;function setupDataSource(dataSource,feedUpdateFn){if(!dataSource){return}if(dataSource.type==="parentDataSource"){const source=findParentDataSource(config.id);if(source&&source.getData){feedUpdateFn(null,null);updateDataSource(source,dataSource.property,feedUpdateFn);source.onDataUpdated(function(){updateDataSource(source,dataSource.property,feedUpdateFn)})}}}function setupDataSource(dataSource,feedUpdateFn){if(!dataSource){return}if(dataSource.type==="parentDataSource"){const source=findParentDataSource(config.id);if(source&&source.getDataByProperty){feedUpdateFn(null,null);updateDataSource(source,dataSource.property,feedUpdateFn);source.onDataUpdated(function(){updateDataSource(source,dataSource.property,feedUpdateFn)})}}}function findParentDataSource(elId){var p=context.getElementParent(elId);if(!p){return null}var s=p.getElementDataSource?p.getElementDataSource():null;if(s){return s}return findParentDataSource(p.id)}function updateDataSource(source,property,callback){source.getDataByProperty(property,function(err,value,data){if(err){return callback(err)}callback(null,value,data)})}}module.exports={create:create}},{"../../element":6,"../conditionsTable":25,"./createShrinkableText":37}],47:[function(require,module,exports){var dom=require("../dom");var animation=require("../animation");var time=require("../time");var async=require("../async");var mraidHandler=require("../mraid");function constructTwitterHTMLtext(text,entities){if(!entities||!entities.urls){return text}for(var i=entities.urls.length-1;i>=0;i--){var item=entities.urls[0];text=text.replace(item.url,'<a target="_blank" style="position:initial;display:inline" href="'+item.url+'" title="'+item.expanded_url+'">'+item.display_url+"</a>")}return text}function create(container,context,config){var window=container.getAdWindow();var document=container.getAdDocument();var feedContainer=document.createElement("div");createFeed();return{domNode:feedContainer,updated:function(){context.setElementStyles(config.id,{css:{overflow:config.twitterFeedWidget.enableScroll?"auto":"hidden"}})}};function createFeed(){var widgetConfig=config.twitterFeedWidget;if(!widgetConfig.url){feedContainer.innerHTML="No feed selected. Select a feed in the element properties";return}var padding=(widgetConfig.tweetPaddingTop||0)+" 0 "+(widgetConfig.tweetPaddingBottom||0)+" 0";var separator=widgetConfig.tweetSeparatorBorder||"1px solid black";container.replaceNamedCSS("twitter-feed-tweet",".tweet { border-bottom: "+separator+"; padding: "+padding+";}");dom.addEventListener(feedContainer,"click",function(ev){if(context.adContent.clicks===false){return}if(ev.target.href){if(mraidHandler.isMraidCreative()){mraidHandler.open(ev.target.href)}else{window.open(ev.target.href,"_blank")}}else if(widgetConfig.linkToTweets&&ev.target.getAttribute("data-tweet-id")){var tweetId=ev.target.getAttribute("data-tweet-id");var sn=ev.target.getAttribute("data-tweet-screenname");if(mraidHandler.isMraidCreative()){mraidHandler.open("https://twitter.com/"+sn+"/status/"+tweetId)}else{window.open("https://twitter.com/"+sn+"/status/"+tweetId,"_blank")}}});dom.ajax("GET",widgetConfig.url,function(err,data){var feed=JSON.parse(data);var renderCount=feed.length;if(widgetConfig.loadAnimation==module.exports.ANIMATION_TYPE_ONE_BY_ONE){renderCount=5}var tweets=feed.map(createTweet);tweets.reverse();var immediateRender=tweets.slice(0,renderCount);var laterRender=tweets.slice(renderCount);immediateRender.forEach(function(tweetEl){feedContainer.insertBefore(tweetEl,feedContainer.firstChild)});async.forEach(laterRender,function(cb,tweetEl){setTimeout(function(){feedContainer.insertBefore(tweetEl,feedContainer.firstChild);animateElement(tweetEl,cb)},5e3)},function(){if(widgetConfig.loadAnimation!=module.exports.ANIMATION_TYPE_ONE_BY_ONE){return}setInterval(function(){var last=feedContainer.lastChild;feedContainer.insertBefore(last,feedContainer.firstChild);animateElement(last,function(){})},5e3)})})}function createTweet(item){var t=document.createElement("div");t.className="tweet";t.style.position="static";t.style.overflow="hidden";t.setAttribute("data-tweet-id",item.id_str);t.setAttribute("data-tweet-screenname",item.user_screen_name);t.innerHTML='<span class="text" style="position:static">'+constructTwitterHTMLtext(item.text,item.entities)+'</span><span class="date" style="position:static;text-transform:uppercase:font-size:70%;margin-top:3px">'+time.getRelativeTime(time.diff(new Date,new Date(item.created_at)))+"</span>";return t}function animateElement(el,callback){var elHeight=el.offsetHeight;animation.transitionProperty(el,"height",{from:"0px",to:elHeight+"px",duration:1e3,easing:"cubic-bezier(0.420, 0, 1, 1)"},callback)}}module.exports={ANIMATION_TYPE_ONE_BY_ONE:"onebyone",create:create}},{"../animation":19,"../async":23,"../dom":32,"../mraid":70,"../time":78}],48:[function(require,module,exports){var defer=require("../async").defer;var dom=require("../dom");var style=null;var pTwitterAPI=null;var prepareTwitterAPI=function(){if(!pTwitterAPI){pTwitterAPI=defer(function(done){var el=document.createElement("script");el.src="https://platform.twitter.com/widgets.js";el.onload=function(){window.twttr.ready(function(twttr){done(twttr)})};document.body.appendChild(el)})}return pTwitterAPI};var prepareStyleSheet=function(doc){if(style){return}var cssText=[".rad-twitterTimeline {","  max-width: 1200px;","}"].join("\n");style=dom.createStylesheet(doc,cssText);doc.head.appendChild(style)};var createDomNode=function(doc){var domNode=doc.createElement("div");dom.addClass(domNode,"rad-twitterTimeline");return domNode};var renderWhenReady=function(domNode,config){prepareTwitterAPI().then(function(twttr){render(twttr,domNode,config)})};var render=function(twttr,domNode,config){var settings={sourceType:"profile",screenName:config.twitterTimelineWidget.screenName};var options={chrome:["noscrollbar",config.twitterTimelineWidget.hasFooter?"":"nofooter",config.twitterTimelineWidget.hasHeader?"":"noheader",config.twitterTimelineWidget.isTransparent?"transparent":""],height:"100%",theme:config.twitterTimelineWidget.isDarkTheme?"dark":"light",width:"100%"};domNode.innerHTML="";twttr.widgets.createTimeline(settings,domNode,options).catch(function(error){console.error("Error in Twitter timeline widget:",error)})};module.exports={create:function(container,context,config){var doc=container.getAdDocument();prepareStyleSheet(doc);var domNode=createDomNode(doc);var el={domNode:domNode,updated:function(){renderWhenReady(domNode,config)}};return el}}},{"../async":23,"../dom":32}],49:[function(require,module,exports){var dom=require("../dom");var url=require("../url");var scriptLoader=require("../scriptLoader");var events=require("../events");var VIMEO_API_URL="https://player.vimeo.com/api/player.js";function create(container,context,config){var document=container.getAdDocument();var wrapper=document.createElement("div");var adWindow=container.getAdWindow();var options={loop:config.vimeovideoWidget.loop,id:config.vimeovideoWidget.videoid||59777392,volume:config.vimeovideoWidget.mute?0:1,autoplay:config.vimeovideoWidget.autoplay};var videoUrl="https://www.vimeo.com/"+options.id;var endpoint="https://www.vimeo.com/api/oembed.json";var callback="embedVideo"+config.id;var vimeoApiLoading=false;var emitter=events.createEmitter();var listeners=[];var embedOptions={id:options.id};if(options.autoplay){embedOptions.autoplay=options.autoplay}var player={};player.id=config.id;player.newplay=true;player.quartiles={first:false,second:false,third:false};player.poster=!!config.vimeovideoWidget.poster;player.wrapper=wrapper;if(context.adContent.screenshot){if(!config.vimeovideoWidget.fallbackImage){return{domNode:wrapper}}var screenshot=document.createElement("img");dom.setInlineStyles(screenshot,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%","min-width":"100%","min-height":"100%"});screenshot.src=url.toFullUrl(config.vimeovideoWidget.fallbackImage,context.adContent);wrapper.appendChild(screenshot);return{domNode:wrapper}}adWindow[callback]=function(video){player.wrapper.innerHTML=unescape(video.html);player.wrapper.getElementsByTagName("iframe")[0].height="100%";player.wrapper.getElementsByTagName("iframe")[0].width="100%";player.muted=options.volume==0;player.player=new adWindow.Vimeo.Player(player.wrapper.getElementsByTagName("iframe")[0],embedOptions);player.player.setVolume(options.volume);if(player.poster&&!options.autoplay){player.wrapper.getElementsByTagName("iframe")[0].style.visibility="hidden"}listeners.push(player.player.on("play",function(){context.sendAnalyticsEvent({e:"interact.video",v:"play",elId:player.id,parentelementId:player.id});emitter.emit("play",player.player)}));listeners.push(player.player.on("pause",function(){context.sendAnalyticsEvent({e:"interact.video",v:"pause",elId:player.id,parentelementId:player.id});emitter.emit("pause",player.player)}));listeners.push(player.player.on("loaded",function(){emitter.emit("loaded",player.player)}));listeners.push(player.player.on("ended",function(){player.newplay=true;player.quartiles.first=false;player.quartiles.second=false;player.quartiles.third=false;context.sendAnalyticsEvent({e:"interact.video",v:"ended",elId:player.id,parentelementId:player.id});if(options.loop){player.player.unload().then(function(){player.player.loadVideo(options.id).then(function(){player.player.play()}).catch(function(error){console.log(error)})})}if(player.poster&&!options.loop){wrapper.getElementsByTagName("iframe")[0].style.visibility="hidden"}emitter.emit("ended",player.player)}));player.player.on("volumechange",function(data){if(player.muted&&data.volume!=0){player.muted=false;context.sendAnalyticsEvent({e:"interact.video",v:"unmute",elId:player.id,parentelementId:player.id})}else if(!player.muted&&data.volume==0){player.muted=true;context.sendAnalyticsEvent({e:"interact.video",v:"mute",elId:player.id,parentelementId:player.id})}});player.player.on("timeupdate",function(data){if(player.newplay&&data.seconds<1){if(context.adContent.customtracker&&context.adContent.customtracker.hasOwnProperty("vimeostarted")){var trackerImg=new Image;trackerImg.src=context.adContent.customtracker["vimeostarted"]}player.newplay=false;context.sendAnalyticsEvent({e:"interact.video",v:"started",elId:player.id,parentelementId:player.id})}if(data.percent>=.25&&!player.quartiles.first){player.quartiles.first=true;context.sendAnalyticsEvent({e:"interact.video",v:"25",elId:player.id,parentelementId:player.id})}else if(data.percent>=.5&&!player.quartiles.second){player.quartiles.second=true;context.sendAnalyticsEvent({e:"interact.video",v:"50",elId:player.id,parentelementId:player.id})}else if(data.percent>=.75&&!player.quartiles.third){player.quartiles.third=true;context.sendAnalyticsEvent({e:"interact.video",v:"75",elId:player.id,parentelementId:player.id})}});if(player.poster){listeners.push(dom.addEventListener(player.wrapper,"click",function(){wrapper.getElementsByTagName("iframe")[0].style.visibility="visible";player.player.play()}))}};var videourl=endpoint+"?url="+encodeURIComponent(videoUrl)+"&callback="+callback;if(options.autoplay){videourl=videourl+"&autoplay=1"}if(adWindow.Vimeo&&adWindow.Vimeo.Player){scriptLoader.load(url.toFullUrl(videourl,config),adWindow.document,function(){})}else if(!vimeoApiLoading){vimeoApiLoading=true;scriptLoader.load(url.toFullUrl(VIMEO_API_URL,config),adWindow.document,function(){vimeoApiLoading=false;scriptLoader.load(url.toFullUrl(videourl,config),adWindow.document,function(){})})}return{domNode:wrapper,destroy:function(){emitter.removeAllListeners()},updated:function(){if(config.vimeovideoWidget.poster){context.setElementStyles(config.id,{css:{background:"transparent no-repeat url('"+url.toFullUrl(config.vimeovideoWidget.poster,context.adContent)+"')center center",backgroundSize:"contain"}})}else{context.setElementStyles(config.id,{css:{background:"none"}})}},onLoaded:function(cb){emitter.addListener("loaded",cb)},onPause:function(cb){emitter.addListener("pause",cb)},onPlay:function(cb){emitter.addListener("play",cb)},onEnded:function(cb){emitter.addListener("ended",cb)}}}module.exports={create:create}},{"../dom":32,"../events":52,"../scriptLoader":74,"../url":79}],50:[function(require,module,exports){var dom=require("../dom");var url=require("../url");var events=require("../events");function create(container,context,config){var analyticsId=config.id;var document=container.getAdDocument();var wrapper=document.createElement("div");var emitter=events.createEmitter();if(context.adContent.screenshot){if(!config.youtubeWidget.poster){return{domNode:wrapper}}var screenshot=document.createElement("div");dom.setInlineStyles(screenshot,{top:0,left:0,right:0,bottom:0,"max-width":"100%","max-height":"100%","min-width":"100%","min-height":"100%",background:"transparent no-repeat url('"+url.toFullUrl(config.youtubeWidget.poster,context.adContent)+"')center center","background-size":"contain"});wrapper.appendChild(screenshot);return{domNode:wrapper}}if(hasAction(config.onClick,"clickthrough")){var clickthrough=document.createElement("div");wrapper.appendChild(clickthrough);clickthrough.className="clickthrough";clickthrough.style.width="100%";clickthrough.style.height="100%";clickthrough.style.maxHeight="100%";clickthrough.style.position="absolute";clickthrough.style.top="-40px";clickthrough.style.left="0";clickthrough.style.display="none"}var el=document.createElement("iframe");dom.setupIframe(el);el.frameBorder=0;var src="https://www.youtube.com/embed/"+config.youtubeWidget.videoId+"?rel=0&autoplay="+(config.youtubeWidget.autoplay||0)+"&showinfo="+(config.youtubeWidget.showinfo||0)+"&autohide="+(config.youtubeWidget.autohide||0)+"&loop="+(config.youtubeWidget.loop||0);el.src=config.youtubeWidget.loop?src+"&playlist="+config.youtubeWidget.videoId+"&enablejsapi=1&playsinline=1":src+"&enablejsapi=1&playsinline=1";var startEventSent=false;var playbackTimer;var quarterSent=false;var halfSent=false;var lastQuarterSent=false;var player;YT.ready(function(){player=new YT.Player(el,{events:{onReady:function(){onPlayerReady()},onStateChange:function(ev){onPlayerStateChange(ev)}}})});wrapper.appendChild(el);var listeners=[];events.addGlobalListener("hideAd",function(){if(player.getPlayerState()!==2){player.pauseVideo()}config.youtubeWidget.autoplay=false});events.addGlobalListener("closeLightbox",function(hidden){if(player.getPlayerState()!==2){player.pauseVideo()}});return{domNode:wrapper,destroy:function(){if(player){player.destroy();clearInterval(playbackTimer);playbackTimer=null;listeners.forEach(function(remove){remove()});emitter.removeAllListeners()}},updated:function(){if(config.youtubeWidget.poster){dom.setInlineStyles(this.domNode,{background:"transparent no-repeat url('"+url.toFullUrl(config.youtubeWidget.poster,context.adContent)+"')center center","background-size":"contain"})}else{dom.setInlineStyles(this.domNode,{background:"none"})}},YTPlayer:player,loadNewVideoById:function(videoId,newAnalyticsId){player.stopVideo();player.loadVideoById(videoId);if(newAnalyticsId){clearInterval(playbackTimer);playbackTimer=null;analyticsId=newAnalyticsId;onPlayerReady()}}};function onPlayerReady(){if(config.youtubeWidget.poster){if(!config.youtubeWidget.autoplay){wrapper.getElementsByTagName("iframe")[0].style.visibility="hidden"}listeners.push(dom.addEventListener(wrapper,"click",function(ev){if(["clickthrough"].indexOf(ev.target.className)==-1){ev.stopPropagation()}if(player.getPlayerState()!=1){if(wrapper.getElementsByTagName("iframe")[0].style.visibility=="hidden"){wrapper.getElementsByTagName("iframe")[0].style.visibility="visible"}player.playVideo()}}))}if(config.youtubeWidget.mute){player.mute()}else{player.unMute()}if(config.youtubeWidget.autoplay){sendEvent("started",analyticsId);startEventSent=true}trackPlaybackPosition()}function onPlayerStateChange(ev){switch(ev.data){case YT.PlayerState.PLAYING:sendEvent("play",analyticsId);if(!startEventSent){if(context.adContent.customtracker&&context.adContent.customtracker.hasOwnProperty("ytstarted")){var trackerImg=new Image;trackerImg.src=context.adContent.customtracker["ytstarted"]}sendEvent("started",analyticsId);startEventSent=true;if(!playbackTimer){trackPlaybackPosition()}}if(config.youtubeWidget.poster){wrapper.getElementsByTagName("iframe")[0].style.visibility="visible"}if(clickthrough){clickthrough.style.display="block"}break;case YT.PlayerState.PAUSED:sendEvent("pause",analyticsId);if(clickthrough){clickthrough.style.display="none"}break;case YT.PlayerState.ENDED:sendEvent("ended",analyticsId);startEventSent=false;quarterSent=false;halfSent=false;lastQuarterSent=false;if(!config.youtubeWidget.loop){if(config.youtubeWidget.poster){wrapper.getElementsByTagName("iframe")[0].style.visibility="hidden"}if(clickthrough){clickthrough.style.display="none"}}break}}function trackPlaybackPosition(){playbackTimer=setInterval(function(){if(player.getDuration()<=0){return}var percentPlayed=Math.floor(player.getCurrentTime()/player.getDuration()*100);if(percentPlayed>=25&&!quarterSent){quarterSent=true;sendEvent("25",analyticsId)}if(percentPlayed>=50&&!halfSent){halfSent=true;sendEvent("50",analyticsId)}if(percentPlayed>=75&&!lastQuarterSent){lastQuarterSent=true;sendEvent("75",analyticsId);clearInterval(playbackTimer);playbackTimer=null}},500)}function sendEvent(evName,elementId){context.sendAnalyticsEvent({e:"interact.video",v:evName,elId:elementId,parentelementId:elementId})}function hasAction(actions,actionType){if(!actions){return false}return actions.some(function(a){return a.action===actionType})}}module.exports={create:create}},{"../dom":32,"../events":52,"../url":79}],51:[function(require,module,exports){var expandv=require("./extensions/expandv");var lightbox=require("./extensions/lightbox");var lightboxNew=require("./extensions/lightboxNew");var sidekick=require("./extensions/sidekick");var analyticsSender=require("./analyticsSender.js");var mraidHandler=require("./mraid");var log=require("./log");var adsonica=require("./adsonica2");var dom=require("./dom");var handlers={carouselNavigation:handleCarouselNav,image360Navigation:handleImage360Navigation,expandv:expandv.handleToggleEvent,lightbox:lightbox.handleToggleEvent,sidekick:sidekick.handleToggleEvent,clickthrough:handleClickthrough,hide:handleHide,hidecondenast:handleHideCondeNast,autoOpen:{lightbox:lightbox.autoOpen,expandv:expandv.autoOpen},autoClose:{lightbox:lightbox.autoClose,expandv:expandv.autoClose},restartanimation:handleAnimationRestart,playanimation:handlePlayAnimation,pauseanimation:handlePauseAnimation,seekanimation:handleSeekAnimation,microanimation:handleMicroAnimation,toggleElement:handleToggleElement,playvideo:handlePlayVideo,pausevideo:handlePauseVideo,restartvideo:handleRestartVideo,resetpausevideo:handleResetPauseVideo,mutevideo:handleMuteVideo,unmutevideo:handleUnmuteVideo,fullscreenvideo:handleFullScreenVideo,skipvideo:handleSkipVideo,setfeedparameter:setFeedParameter,nbcaddtocart:handleNbcAddToCart,clicktocall:handleClicktocall,addToCalendar:handleAddToCalendar,playmedia:handlePlayMedia,pausemedia:handlePauseMedia,restartmedia:handleRestartMedia,resetpausemedia:handleResetPauseMedia,seekmedia:handleSeekMedia};function setFeedParameter(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var parameter=evConfig.data.parameter;var value=evConfig.data.value;var element=ad.getElementById(targetId);var ds=element.getElementDataSource?element.getElementDataSource():null;if(!ds){log.warn("Element "+targetId+" has no data source");return}if(!ds.setParameter){log.warn("Element "+targetId+" has wrong kind of data source");return}ds.setParameter(parameter,value)}function handleHide(ad,ev,evConfig){ad.hideCreative(ad,ev,evConfig)}function handleHideCondeNast(ad,ev,evConfig){ad.getContainer().getIframeContainerNode().style.setProperty("visibility","hidden","important");ad.getContainer().getIframeContainerNode().parentNode.style.setProperty("height","0vh","important");ad.condeHideAd()}function handlePlayAnimation(ad){ad.playAnimation()}function handlePauseAnimation(ad){ad.pauseAnimation()}function handleSeekAnimation(ad,ev,evConfig){ad.seekAnimation((evConfig.data.direction==="backward"?-1:1)*evConfig.data.seconds)}function handleMicroAnimation(ad,ev,evConfig){if(ad.getAdTagOptions().inEditor){log.warn("Micro animation are not running in the editor");return}if(!evConfig.data){log.warn("Micro animation event data is not set");return}var targetId=evConfig.data.targetElementId;var animationClass=evConfig.data.type;if(!targetId){log.warn("Micro animation target element ID was not set");return}if(!animationClass){log.warn("Micro animation class name not set");return}var el=ad.getElementById(targetId);if(!el){log.warn("Element `"+targetId+"` cannot be animated: not rendered");return}if(animationClass.includes("in")&&el.domNode.style.opacity==="1"){return}if(animationClass.includes("out")&&(el.domNode.style.opacity==="0"||el.domNode.style.display==="none")){return}el.domNode.style.display="block";var shrinkableElementsIds=[];var isShrinkable=function(elStyles){if(elStyles.updateShrink){shrinkableElementsIds.push(elStyles.id)}ad.getElementChildren(elStyles.id).forEach(function(elStyles){isShrinkable(elStyles)})};isShrinkable(el);if(shrinkableElementsIds&&shrinkableElementsIds.length>=1){shrinkableElementsIds.forEach(function(elId){var el=ad.getElementById(elId);el.updateShrink({contentUpdated:false})})}el.domNode.addEventListener("animationend",()=>{if(animationClass.includes("in")){el.domNode.style.opacity=1}else if(animationClass.includes("out")){el.domNode.style.opacity=0;el.domNode.style.display="none"}dom.removeClass(el.domNode,animationClass)},{once:true});dom.addClass(el.domNode,animationClass)}function handleSkipVideo(ad,ev,evConfig){const video=ad.getElementById(evConfig.data.videoId);video.setCurrentTime(video.getDuration())}function handlePlayVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.play()}function handlePauseVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.pause()}function handleRestartVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.restart()}function handleResetPauseVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.resetpause()}function handleMuteVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.mute()}function handleUnmuteVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.unmute()}function handleFullScreenVideo(ad,ev,evConfig){var targetId=evConfig.data.targetElementId;var videoEl=ad.getElementById(targetId);videoEl.requestFullscreen()}function handleToggleElement(ad,ev,evConfig){if(!evConfig.data){log.warn("handleToggleElement event data is not set");return}var targetId=evConfig.data.targetElementId;var mode=evConfig.data.mode;var el=ad.getElementById(targetId);if(!el){log.warn("Element `"+targetId+"` cannot be toggled: not rendered");return}var styles=ad.getElementStyles(targetId);var visible=true;if(mode==="hide"){visible=false}else if(mode==="toggle"){visible=!styles.visible}styles.visible=visible;if(styles.css&&styles.css.hasOwnProperty("display")){delete styles.css.display}ad.updateElementStyles(targetId,styles)}function handleAnimationRestart(ad){ad.restartAnimation()}function handleCarouselNav(ad,ev,evConfig){var carousel=ad.getElementById(evConfig.data.carouselId);if(!carousel){log.warn("Could not find carousel with id "+evConfig.data.carouselId);return}if(evConfig.data.mode==="next"){carousel.nextSlide()}else if(evConfig.data.mode==="previous"){carousel.previousSlide()}else if(evConfig.data.mode==="setvisibleslide"){carousel.moveToSlide(evConfig.data.goToSlideId)}else if(evConfig.data.mode==="animatetoslide"){carousel.animateToSlide(evConfig.data.goToSlideId)}else if(evConfig.data.mode==="removeslide"){carousel.removeSlide(evConfig.data.goToSlideId)}else if(evConfig.data.mode==="pauseAutoplay"){carousel.pause()}else if(evConfig.data.mode==="resumeAutoplay"){carousel.resume()}}function handleImage360Navigation(ad,ev,evConfig){var window=ad.getContainer().getAdWindow();var elId=evConfig.data.targetElementId;var sceneId=evConfig.data.targetSceneId;var viewer=window.RAD.image360ViewerMap.get(elId);viewer.loadScene(sceneId)}function handleClickthrough(ad,ev,evConfig){var adContent=ad.getMergedContent();var url=evConfig.data.url;var feedUrl=url.match(/^feed:\/\/(.+)$/);if(feedUrl){var ds=findParentDataSource(ad,ev.element.id);if(ds){url=ds.getCurrentData()[feedUrl[1]]}}if(adContent.export&&!feedUrl){if(adContent.exportType==="html5"){url=window[evConfig.data.clickTag]?window[evConfig.data.clickTag]:evConfig.data.url}else if(adContent.exportType==="adbutler"){url=window.clickTag1+evConfig.data.url}else{url=window.clickTag1}}openClickthrough(url,ad,adContent.mraid)}function findParentDataSource(ad,elId){var styles=ad.getElementStyles(elId);var p=ad.getElementById(styles.parentId);if(!p){return null}var s=p.getElementDataSource?p.getElementDataSource():null;if(s){return s}return findParentDataSource(ad,p.id)}function handleNbcAddToCart(ad,ev,evConfig){var productKey=evConfig.data.productKey;var productChannel=evConfig.data.productChannel;var feedProductKey=productKey.match(/^feed:\/\/(.+)$/);if(feedProductKey){var ds=findParentDataSource(ad,ev.element.id);if(ds){productKey=ds.getCurrentData()[feedProductKey[1]]}}var feedProductChannel=productChannel.match(/^feed:\/\/(.+)$/);if(feedProductChannel){var dsc=findParentDataSource(ad,ev.element.id);if(dsc){productChannel=ds.getCurrentData()[feedProductChannel[1]]}}var adContent=ad.getMergedContent();var message={usc:{type:"product",data:{product:{key:productKey},channel:{key:productChannel},adDetails:{eaid:adContent.asid,eadv:adContent.asadv,ebuy:adContent.asbid,ecid:adContent.ascid,eenv:adContent.asenv,epid:adContent.aspla,vendor:"responsiveads.com"}}}};window.top.postMessage(message);ad.sendAnalyticsEvent({e:"interact.addtocart",elId:ev.element.id,v:productKey+"#"+productChannel})}function handleClicktocall(ad,ev,evConfig){ad.sendAnalyticsEvent({e:"interact.clicktocall",elId:ev.element.id,v:evConfig.data.phoneNumber});document.location.href="tel:"+evConfig.data.phoneNumber}function handleAddToCalendar(ad,ev,evConfig){window.open(evConfig.data.url,"_blank")}function openClickthrough(url,ad,mraid){var adContent=ad.getMergedContent();if(adContent.clickthrough&&/^https?:\/\/\S+/i.test(adContent.clickthrough)){if(url.indexOf(adContent.clickthrough)<0){url=adContent.clickthrough+url}}url=analyticsSender.addCacheBuster(url,adContent.dfpcb,ad);if(mraid){mraidHandler.open(url)}else{var target=adContent.ctaTargetParameter||"_blank";if(window.navigator&&window.navigator.userAgent==="SocastIAB"){target="_system"}window.open(url,target)}}function handlePlayMedia(ad,ev,evConfig){var id=evConfig.data.targetElementId;var el=ad.getElementById(id);if(!el){throw new Error('Element ID "'+id+'" not found')}var w=el.domNode.ownerDocument.defaultView;if(!w){throw new Error("Failed to get window object")}if(el.type==="adsonicaComponent"){var domAdsonica=el.domNode.querySelector(".adsonica-image");if(!(domAdsonica instanceof w.HTMLImageElement)){throw new Error("Adsonica image element not found")}adsonica.playAdsonica(domAdsonica)}else{throw new Error('Unsupported event "'+evConfig.action+'" for "'+el.type+'"')}}function handlePauseMedia(ad,ev,evConfig){var id=evConfig.data.targetElementId;var el=ad.getElementById(id);if(!el){throw new Error('Element ID "'+id+'" not found')}var w=el.domNode.ownerDocument.defaultView;if(!w){throw new Error("Failed to get window object")}if(el.type==="adsonicaComponent"){var domAdsonica=el.domNode.querySelector(".adsonica-image");if(!(domAdsonica instanceof w.HTMLImageElement)){throw new Error("Adsonica image element not found")}adsonica.pauseAdsonica(domAdsonica)}else{throw new Error('Unsupported event "'+evConfig.action+'" for "'+el.type+'"')}}function handleRestartMedia(ad,ev,evConfig){var id=evConfig.data.targetElementId;var el=ad.getElementById(id);if(!el){throw new Error('Element ID "'+id+'" not found')}var w=el.domNode.ownerDocument.defaultView;if(!w){throw new Error("Failed to get window object")}if(el.type==="adsonicaComponent"){var domAdsonica=el.domNode.querySelector(".adsonica-image");if(!(domAdsonica instanceof w.HTMLImageElement)){throw new Error("Adsonica image element not found")}adsonica.stopAdsonica(domAdsonica).then(function(){adsonica.playAdsonica(domAdsonica)})}else{throw new Error('Unsupported event "'+evConfig.action+'" for "'+el.type+'"')}}function handleResetPauseMedia(ad,ev,evConfig){var id=evConfig.data.targetElementId;var el=ad.getElementById(id);if(!el){throw new Error('Element ID "'+id+'" not found')}var w=el.domNode.ownerDocument.defaultView;if(!w){throw new Error("Failed to get window object")}if(el.type==="adsonicaComponent"){var domAdsonica=el.domNode.querySelector(".adsonica-image");if(!(domAdsonica instanceof w.HTMLImageElement)){throw new Error("Adsonica image element not found")}adsonica.stopAdsonica(domAdsonica)}else{throw new Error('Unsupported event "'+evConfig.action+'" for "'+el.type+'"')}}function handleSeekMedia(ad,ev,evConfig){var id=evConfig.data.targetElementId;var el=ad.getElementById(id);if(!el){throw new Error('Element ID "'+id+'" not found')}var w=el.domNode.ownerDocument.defaultView;if(!w){throw new Error("Failed to get window object")}if(el.type==="adsonicaComponent"){var domAdsonica=el.domNode.querySelector(".adsonica-image");if(!(domAdsonica instanceof w.HTMLImageElement)){throw new Error("Adsonica image element not found")}adsonica.stepAdsonica(domAdsonica,evConfig.data.amount)}else{throw new Error('Unsupported event "'+evConfig.action+'" for "'+el.type+'"')}}function handleInteraction(ad,ev,evConfig){ev.elementConfig.wasInteractedWith=true;handleEvent(ad,ev,evConfig)}function handleEvent(ad,ev,evConfig){for(var key in evConfig){var actionItem=evConfig[key];(function(actionItem){if(actionItem.data&&(actionItem.data.timeSecondsDelay!=null&&actionItem.data.timeSecondsDelay!==0)){var timeOutId=setTimeout(()=>{handlers[actionItem.action](ad,ev,actionItem)},actionItem.data.timeSecondsDelay*1e3);actionItem.data.timeOutId=timeOutId}else{handlers[actionItem.action](ad,ev,actionItem)}})(actionItem)}}module.exports={registerHandler:function(eventType,func){if(handlers[eventType]){throw new Error(`Handler for event type '${eventType}' already registered`)}handlers[eventType]=func},setUpAutoOpenClose:function(ad,openState){if(!ad){return}var adContent=ad.getMergedContent();if(adContent.adVersion>10){handlers.lightbox=lightboxNew.handleToggleEvent;if(!openState){handlers.autoOpen.lightbox=lightboxNew.autoOpen}else{handlers.autoClose.lightbox=lightboxNew.autoClose}}if(adContent.activeConfig.lightbox&&adContent.activeConfig.lightbox.autoOpen){if(adContent.adVersion>10){if(!openState){handlers.autoOpen.lightbox(ad)}else{handlers.autoClose.lightbox(ad)}}else{handlers.autoOpen.lightbox(ad);handlers.autoClose.lightbox(ad)}}if(adContent.activeConfig.expandv&&adContent.activeConfig.expandv.autoOpen){handlers.autoOpen.expandv(ad);handlers.autoClose.expandv(ad)}},setup:function(ad){ad.onClick(function(ev){ad.creativeTimeSpent();ad.refreshInteractionDisable();var adContent=ad.getMergedContent();if(adContent.clicks===false){return}if(ev.elementConfig&&ev.elementConfig.onClick&&ev.elementConfig.onClick.length>0){handleInteraction(ad,ev,ev.elementConfig.onClick)}else if(!ad.getActiveConfig().clickthroughUrl&&!adContent.export){return}else{var ignoreTypes=["html5videoWidget","videoCustomPlayMuteRestartControl","seekbar"];if(!ev.elementConfig||ignoreTypes.indexOf(ev.elementConfig.type)==-1){var clickthroughURL=ad.getActiveConfig().clickthroughUrl;if(adContent.export&&window.clickTag1){clickthroughURL=window.clickTag1}openClickthrough(clickthroughURL,ad,adContent.mraid)}}});ad.onElementHover(function(ev){ad.creativeTimeSpent();if(ad.getMergedContent().clicks===false){return}if(ev.elementConfig&&ev.elementConfig.onHover){handleInteraction(ad,ev,ev.elementConfig.onHover)}if(ev.elementConfig&&ev.elementConfig.onMouseInOut){handleInteraction(ad,ev,ev.elementConfig.onMouseInOut)}});ad.onElementMouseOut(function(ev){ad.creativeTimeSpent();if(ad.getMergedContent().clicks===false){return}if(ev.elementConfig&&ev.elementConfig.onMouseOut){handleInteraction(ad,ev,ev.elementConfig.onMouseOut)}if(ev.elementConfig&&ev.elementConfig.onMouseInOut){handleInteraction(ad,ev,ev.elementConfig.onMouseInOut)}});ad.onVideoPlay(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoUnableToAutoplay){const eventsArray=ev.elementConfig.onVideoUnableToAutoplay;for(let key in eventsArray){const videoEndItem=eventsArray[key];if(videoEndItem.data.timeOutId){clearTimeout(videoEndItem.data.timeOutId)}}}if(ev.elementConfig&&ev.elementConfig.onVideoPlay){handleEvent(ad,ev,ev.elementConfig.onVideoPlay)}});ad.onVideoUnableToAutoplay(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoUnableToAutoplay){handleEvent(ad,ev,ev.elementConfig.onVideoUnableToAutoplay)}});ad.onVideoTimeUpdate(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoTimeReached){const element=ev.element;const currentTime=element.getCurrentTime();const currentTimePlaybackPercentage=Math.floor(currentTime/element.getDuration()*100);const evConfig=ev.elementConfig.onVideoTimeReached;for(let key in evConfig){const actionItem=evConfig[key];if(actionItem.data.whenMode==="onlyonautoplay"&&ev.element.startedFromAutoPlay!==true){continue}if(actionItem.data.whenMode==="onlyonautoplay"&&ev.element.previewRenditionPlaying()===true){continue}if(actionItem.data.timeSecondsDelay<=currentTime&&actionItem.wasCalled!==true){actionItem.wasCalled=true;handlers[actionItem.action](ad,ev,actionItem)}if(actionItem.data.percentageValueDelay<=currentTimePlaybackPercentage&&actionItem.wasCalled!==true){actionItem.wasCalled=true;handlers[actionItem.action](ad,ev,actionItem)}}}});ad.onVideoPause(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoPause){handleEvent(ad,ev,ev.elementConfig.onVideoPause)}});ad.onVideoEnd(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoTimeReached){const evConfigVideoTimeReached=ev.elementConfig.onVideoTimeReached;for(let onVideoVideoTimeReachedKey in evConfigVideoTimeReached){const videoEndItem=evConfigVideoTimeReached[onVideoVideoTimeReachedKey];if(videoEndItem.data.whenMode!="firsttimeplay"){videoEndItem.wasCalled=false}}}if(ev.elementConfig&&ev.elementConfig.onVideoEnd){const evConfigOnVideoUnableToAutoplay=ev.elementConfig.onVideoUnableToAutoplay;if(ev.domEvent.notAllowedError&&evConfigOnVideoUnableToAutoplay){const evConfigOnVideoEnd=ev.elementConfig.onVideoEnd;const evConfigOnVideoUnableToAutoplay=ev.elementConfig.onVideoUnableToAutoplay;for(let onVideoEndKey in evConfigOnVideoEnd){const videoEndItem=evConfigOnVideoEnd[onVideoEndKey];let overrideEvent=false;for(let onVideoUnableToPlayKey in evConfigOnVideoUnableToAutoplay){const unableToAutoplayItem=evConfigOnVideoUnableToAutoplay[onVideoUnableToPlayKey];overrideEvent=overrideEvent?true:videoEndItem.action===unableToAutoplayItem.action&&videoEndItem.data.targetElementId===unableToAutoplayItem.data.targetElementId;if(overrideEvent){break}}if(!overrideEvent){handlers[videoEndItem.action](ad,ev,videoEndItem)}}}else{handleEvent(ad,ev,ev.elementConfig.onVideoEnd)}}});ad.onVideoMuted(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoMuted){handleEvent(ad,ev,ev.elementConfig.onVideoMuted)}});ad.onVideoUnMuted(function(ev){if(ev.elementConfig&&ev.elementConfig.onVideoUnMuted){handleEvent(ad,ev,ev.elementConfig.onVideoUnMuted)}});ad.onPreviewVideoEnd(function(ev){if(ev.elementConfig&&ev.elementConfig.onPreviewVideoEnd){handleEvent(ad,ev,ev.elementConfig.onPreviewVideoEnd)}});ad.onPreviewVideoStart(function(ev){if(ev.elementConfig&&ev.elementConfig.onPreviewVideoStart){handleEvent(ad,ev,ev.elementConfig.onPreviewVideoStart)}});ad.onCarouselFirstSlide(function(ev){if(ev.elementConfig&&ev.elementConfig.onCarouselFirstSlide){handleEvent(ad,ev,ev.elementConfig.onCarouselFirstSlide)}});ad.onCarouselLastSlide(function(ev){if(ev.elementConfig&&ev.elementConfig.onCarouselLastSlide){handleEvent(ad,ev,ev.elementConfig.onCarouselLastSlide)}});ad.onCarouselMiddleSlide(function(ev){if(ev.elementConfig&&ev.elementConfig.onCarouselMiddleSlide){handleEvent(ad,ev,ev.elementConfig.onCarouselMiddleSlide)}});ad.onMediaPlaying(function(ev){if(ev.elementConfig&&ev.elementConfig.onMediaPlaying){handleEvent(ad,ev,ev.elementConfig.onMediaPlaying)}});ad.onMediaPause(function(ev){if(ev.elementConfig&&ev.elementConfig.onMediaPause){handleEvent(ad,ev,ev.elementConfig.onMediaPause)}});ad.onMediaEnded(function(ev){if(ev.elementConfig&&ev.elementConfig.onMediaEnded){handleEvent(ad,ev,ev.elementConfig.onMediaEnded)}});ad.onCountdownFinished(function(ev){if(ev.elementConfig&&ev.elementConfig.onCountdownFinished){handleEvent(ad,ev,ev.elementConfig.onCountdownFinished)}});ad.onLoad(function(ev){if(ev.config&&ev.config.elements&&ev.mq&&ev.mq.elements){for(var elId in ev.config.elements){if(ev.mq.elements[elId]&&ev.mq.elements[elId].visible&&ev.config.elements[elId].onCreativeRender){handleEvent(ad,ev,ev.config.elements[elId].onCreativeRender)}}}})},handleInteraction:handleInteraction,handleEvent:handleEvent}},{"./adsonica2":12,"./analyticsSender.js":18,"./dom":32,"./extensions/expandv":53,"./extensions/lightbox":54,"./extensions/lightboxNew":55,"./extensions/sidekick":56,"./log":65,"./mraid":70}],52:[function(require,module,exports){var events=require("events");var globalEmitter=new events.EventEmitter;module.exports={createEmitter:function(){var emitter=new events.EventEmitter;return{addListener:function(ev,listener){return emitter.addListener(ev,listener)},emit:function(ev,options){return emitter.emit(ev,options)},removeListener:function(ev,listener){return emitter.removeListener(ev,listener)},removeAllListeners:function(){emitter.removeAllListeners()}}},addGlobalListener:function(ev,listener){return globalEmitter.addListener(ev,listener)},removeGlobalListener:function(ev,listener){return globalEmitter.removeListener(ev,listener)},emitGlobal:function(ev,options){return globalEmitter.emit(ev,options)}}},{events:3}],53:[function(require,module,exports){var dom=require("../dom");var anim=require("../animation");var autoOpenClose=require("../frequencyCappingHandler");var preview=require("../preview");function getHighestMatchingSizes(baseSizes,availableSizes){var sizesByWidth=baseSizes.reduce(function(byWidth,size){byWidth[size.width]=dom.merge({},size);return byWidth},{});for(var i=0;i<availableSizes.length;i++){var s=availableSizes[i];if(!sizesByWidth[s.maxWidth.value]){continue}if(s.maxHeight.value>sizesByWidth[s.maxWidth.value].height){sizesByWidth[s.maxWidth.value].height=s.maxHeight.value}}var highest=Object.keys(sizesByWidth).map(function(k){return sizesByWidth[k]});return highest}function getClosedHeight(adOwnSizes,currentWidth){var height;for(var i in adOwnSizes){if(adOwnSizes[i].width==currentWidth){height=adOwnSizes[i].height}}return height}var ads=[];var extensions=[];function forAd(ad){var ext=extensions[ads.indexOf(ad)];if(!ext){ext=init(ad);ads.push(ad);extensions.push(ext)}return ext}function init(ad){var adContent=ad.getMergedContent();var container=ad.getContainer();var mqs=ad.getActiveConfig().mediaqueries;var highestSizes=getHighestMatchingSizes(adContent.sizes,mqs);var ownSizes=adContent.sizes;var expanded=false;var extensionClassName="rad-ext-expand";var expandvStateCallback;var autoOpen=false;var firstTimeOpen=true;var transitionHeight=adContent.activeConfig["expandv"]&&adContent.activeConfig["expandv"].transitionHeight||false;ad.onBeforeRender(function(){dom.setInlineStyles(container.getAdDocument().body,{opacity:1})});container.onPageResize(function(){if(!expanded){return}resize(true)});function resize(onPageResize){var adSize=container.getAdSize();var matchedIndex=highestSizes.findIndex(function(size){if(adSize.width<=size.width){return true}});var match=highestSizes[matchedIndex];if(!match){match=highestSizes[highestSizes.length-1]}else if(!match.height||match.height==adSize.height){return}container.setAutoOpen(autoOpen);var noFadeOut=false;if(transitionHeight){noFadeOut=true}if(onPageResize){dom.forceInlineStyles(container.getAdWindow().frameElement.parentNode,{height:match.height+"px"})}else{anim.transitionContainerSize(container,{height:match.height},transitionHeight,noFadeOut,function(){ad.setSizeFilter(highestSizes);dom.addClass(container.getAdDocument().body,extensionClassName)},function(){})}}return{toggle:toggle,open:open,close:close,autoOpen:autoopen,autoClose:autoclose,isOpen:function(){return expanded},expandvStateCallback:function(callback){expandvStateCallback=callback}};function autoopen(ad){return autoOpenClose.autoOpen(ad.getMergedContent(),"expandv",ad.getContainer().getAdWindow(),ad.getContainer().isCrossOrigin(),preview.getPreviewProperties(ad.getContainer().getAdWindow()).isBreakOut,function(){autoOpen=true;open()})}function autoclose(ad){return autoOpenClose.autoClose(ad.getMergedContent(),"expandv",ad.getContainer().getAdWindow(),function(){close()})}function toggle(el){expanded?close():open(el)}function open(el){if(expanded){return}if(expandvStateCallback){expandvStateCallback(true)}if(firstTimeOpen){if(adContent.aft){ad.sendAdformAnalyticsEvent(21,"First Expand")}}else{if(adContent.aft){ad.sendAdformAnalyticsEvent(22,"Other Expands")}}expanded=true;firstTimeOpen=false;if(adContent.activeConfig.pushdownOpenTracker){ad.callTrackerURL(adContent.activeConfig.pushdownOpenTracker)}if(!transitionHeight){dom.setInlineStyles(container.getAdDocument().body,{opacity:0})}resize();if(el){ad.sendAnalyticsEvent({e:"interact.expand",elId:el.id})}}function close(){if(!expanded){return}if(expandvStateCallback){expandvStateCallback(false)}if(adContent.aft){ad.sendAdformAnalyticsEvent(23,"Close Button Press")}autoOpen=false;container.setAutoOpen(autoOpen);expanded=false;var noFadeOut=false;var dimensions={};if(transitionHeight){var height=getClosedHeight(ownSizes,container.getAdSize().width);dimensions={height:height};noFadeOut=true}else{dom.setInlineStyles(container.getAdDocument().body,{opacity:0})}anim.transitionContainerSize(container,dimensions,false,noFadeOut,function(){ad.setSizeFilter(ownSizes);dom.removeClass(container.getAdDocument().body,extensionClassName)},function(){})}}module.exports={handleToggleEvent:function(ad,ev){forAd(ad).toggle(ev.element)},forAd:forAd,autoOpen:function(ad){forAd(ad).autoOpen(ad)},autoClose:function(ad){forAd(ad).autoClose(ad)},isEnabledFor:function(ad){return ads.indexOf(ad)!==-1}}},{"../animation":19,"../dom":32,"../frequencyCappingHandler":60,"../preview":73}],54:[function(require,module,exports){var dom=require("../dom");var animation=require("../animation");var autoOpenClose=require("../frequencyCappingHandler");var preview=require("../preview");var mraidHandler=require("../mraid");var ads=[];var extensions=[];function forAd(ad){var ext=extensions[ads.indexOf(ad)];if(!ext){ext=init(ad);ads.push(ad);extensions.push(ext)}return ext}module.exports={handleToggleEvent:function(ad,ev){forAd(ad).elementHandler(ev.element)},autoOpen:function(ad){forAd(ad).autoOpen(ad)},autoClose:function(ad){forAd(ad).autoClose(ad)},forAd:forAd,isEnabledFor:function(ad){return ads.indexOf(ad)!==-1}};function init(ad){var container=ad.getContainer();var adContent=ad.getMergedContent();var lightboxOpen=false;var mraidLightBoxClosed=false;var autoOpen=false;var ownSizes=ad.getMergedContent().sizes;var extensionClassName="rad-ext-lightbox";var lightboxStateCallback;var lightboxAfterStateChangeCallback;container.onPageResize(function(){if(!lightboxOpen){return}var dimensions=calculateLightboxDimensions();resizeLightbox(dimensions)});ad.onBeforeRender(function(){if(adContent.mraid&&!mraidLightBoxClosed){dom.setInlineStyles(container.getAdDocument().body,{display:"block"})}dom.setInlineStyles(container.getAdDocument().body,{opacity:1})});return{elementHandler:elementHandler,open:open,close:close,autoOpen:autoopen,autoClose:autoclose,isOpen:function(){return lightboxOpen},lightboxStateCallback:function(callback){lightboxStateCallback=callback},lightboxAfterStateChangeCallback:function(callback){lightboxAfterStateChangeCallback=callback},setMraidLightboxClosed:function(){mraidLightBoxClosed=true}};function elementHandler(element){ad.sendAnalyticsEvent({e:"interact.lightbox",v:lightboxOpen?"close":"open",elId:element?element.id:"auto"});toggle()}function toggle(){if(!lightboxOpen){open()}else{close()}}function open(){if(adContent.activeConfig.lightboxOpenTracker){ad.callTrackerURL(adContent.activeConfig.lightboxOpenTracker)}if(lightboxStateCallback){lightboxStateCallback(true)}if(adContent.mraid){mraidHandler.expand()}else{var dimensions=calculateLightboxDimensions();updateLightbox(dimensions);dom.addClass(container.getAdWindow().frameElement.parentNode,extensionClassName)}}function close(){if(lightboxStateCallback){lightboxStateCallback(false)}autoOpen=false;container.setAutoOpen(autoOpen);dom.setInlineStyles(container.getAdDocument().body,{opacity:0});animation.transitionAdSize(container,{},function(){ad.setSizeFilter(ownSizes);dom.removeClass(container.getAdWindow().frameElement.parentNode,extensionClassName);container.disableOverlay();container.resetCentering();lightboxOpen=false;if(lightboxAfterStateChangeCallback){lightboxAfterStateChangeCallback(lightboxOpen)}},function(){})}function autoopen(ad){return autoOpenClose.autoOpen(ad.getMergedContent(),"lightbox",ad.getContainer().getAdWindow(),ad.getContainer().isCrossOrigin(),preview.getPreviewProperties(ad.getContainer().getAdWindow()).isBreakOut,function(){autoOpen=true;open()})}function autoclose(ad){return autoOpenClose.autoClose(ad.getMergedContent(),"lightbox",ad.getContainer().getAdWindow(),function(){close()})}function calculateLightboxDimensions(){var viewport=container.getPageSize();var mqs=ad.getActiveConfig().mediaqueries;var availableSizes=mqs.filter(function(item){var found=ownSizes.find(function(size){if(item.maxWidth.value===size.width&&item.maxHeight.value===size.height){return true}});return found?false:true});var largestFittingSize=availableSizes.reduce(function(largest,current){var fitsInViewport=current.maxWidth.value<viewport.width&&current.maxHeight.value<viewport.height;var area=current.maxWidth.value*current.maxHeight.value;if(fitsInViewport&&area>largest.area){return{area:area,size:{width:current.maxWidth.value,height:current.maxHeight.value}}}return largest},{area:0,size:{width:0,height:0}}).size;return largestFittingSize}function updateLightboxDimensions(dimensions){ad.setSizeFilter([dimensions]);container.centerForSize(dimensions)}function resizeLightbox(dimensions){animation.transitionAdSize(container,dimensions,function(){updateLightboxDimensions(dimensions)},function(){})}function updateLightbox(dimensions){dom.setInlineStyles(container.getAdDocument().body,{opacity:0});animation.transitionAdSize(container,dimensions,function(){container.enableOverlay();container.setAutoOpen(autoOpen);updateLightboxDimensions(dimensions);lightboxOpen=true;if(lightboxAfterStateChangeCallback){lightboxAfterStateChangeCallback(lightboxOpen)}},function(){})}}},{"../animation":19,"../dom":32,"../frequencyCappingHandler":60,"../mraid":70,"../preview":73}],55:[function(require,module,exports){var dom=require("../dom");var animation=require("../animation");var autoOpenClose=require("../frequencyCappingHandler");var preview=require("../preview");var scriptLoader=require("../scriptLoader");var events=require("../events");var messaging=require("../messaging");var uuid=require("../uuid");var ads=[];var extensions=[];function forAd(ad){var ext=extensions[ads.indexOf(ad)];if(!ext){ext=init(ad);ads.push(ad);extensions.push(ext)}return ext}module.exports={handleToggleEvent:function(ad,ev){forAd(ad).elementHandler(ev.element)},autoOpen:function(ad){forAd(ad).autoOpen(ad)},autoClose:function(ad){forAd(ad).autoClose(ad)},forAd:forAd,isEnabledFor:function(ad){return ads.indexOf(ad)!==-1}};function init(ad){var container=ad.getContainer();var adContent=ad.getMergedContent();var lightboxOpen=false;var autoOpen=false;var firstTimeOpen=true;var openStateContainerId;var ownSizes=ad.getMergedContent().sizes;var extensionClassName="rad-ext-lightbox";var lightboxStateCallback;var lightboxStateCallbackPostMessage;var lightboxAfterStateChangeCallback;var customOpenStateZindex;if(ad.getState().customOpenStateZindex){customOpenStateZindex=ad.getState().customOpenStateZindex}if(ad.isOpenStateAdObj()){if(ad.getState().excludeOpenStateSizes){ownSizes=ad.getState().excludeOpenStateSizes}else{ownSizes=[];var tagSizes=ad.getAdTagOptions().sizes;if(tagSizes.length>0){for(var i in tagSizes){if(typeof tagSizes[i]==="object"&&tagSizes[i]!==null){ownSizes.push({width:tagSizes[i].width,height:tagSizes[i].height})}else{var temp=tagSizes[i].split("x");ownSizes.push({width:parseInt(temp[0],10),height:parseInt(temp[1],10)})}}}}openLightbox(ad.isOpenStateAdObj());container.onPageResize(function(){var dimensions=calculateLightboxDimensions();resizeLightbox(dimensions)})}events.addGlobalListener("postMessage",function(event){if(ad.isOpenStateAdObj()&&event.data.type==="openState"){if(event.data.action=="openLightbox"){openLightbox(event.data.data.dimensions);if(lightboxStateCallbackPostMessage){lightboxStateCallbackPostMessage(true)}}}else if(!ad.isOpenStateAdObj()&&event.data.type==="closedState"){if(event.data.action=="closeLightbox"){if(!adContent.activeConfig.lightbox||adContent.activeConfig.lightbox&&!adContent.activeConfig.lightbox.showClosed){dom.setInlineStyles(container.getAdDocument().body,{opacity:1})}if(lightboxStateCallbackPostMessage){lightboxStateCallbackPostMessage(false)}}}});return{elementHandler:elementHandler,open:open,close:close,autoOpen:autoopen,autoClose:autoclose,isOpen:function(){return ad.isOpenStateAdObj()},lightboxStateCallback:function(callback){lightboxStateCallback=callback},lightboxAfterStateChangeCallback:function(callback){lightboxAfterStateChangeCallback=callback},lightboxStateCallbackPostMessage:function(callback){lightboxStateCallbackPostMessage=callback}};function createOpenStateContainer(callback){var lbNro=1;var searchString="[id^='rad-lb-container-"+uuid.creativeUUID+"']";var test=container.getAdWindow().parent.document.querySelectorAll(searchString);if(test){lbNro=test.length+1}ad.setLbNro(lbNro);var parentElement=ad.getContainer().getAdWindow().frameElement.parentElement;parentElement.classList.add("rad-container-"+uuid.creativeUUID+"-"+lbNro);var parentPageDoc=ad.getContainer().getAdWindow().parent.document;var openStateDiv=parentPageDoc.createElement("div");openStateContainerId="rad-lb-container-"+uuid.creativeUUID+"-"+lbNro;openStateDiv.id=openStateContainerId;openStateDiv.style.opacity=0;var openFrame=parentPageDoc.createElement("iframe");openFrame.onload=function(){var radicalUrl=ad.getContainer().getAdDocument().getElementById("rad-lib-script");if(!radicalUrl){radicalUrl=parentPageDoc.getElementById("rad-lib-script")}radicalUrl=radicalUrl?radicalUrl.src:"https://publish.responsiveads.com/libs/radical.r7.min.js";scriptLoader.load(radicalUrl,openFrame.contentWindow.document,function(){var openFrameWindow=openFrame.contentWindow||openFrame;var dimensions=calculateLightboxDimensions();openFrameWindow.Radical.createLightBoxOpenContainer(openFrame.contentWindow,dom.Object.clone(ad.getConfig()),dom.Object.clone(ad.getAdTagOptions()),dom.Object.clone(ad.getAdContent()),dom.Object.clone(dimensions),dom.Object.clone(ad.getState()),uuid.creativeUUID,lbNro);callback()})};dom.setupIframe(openFrame);openStateDiv.appendChild(openFrame);parentPageDoc.body.appendChild(openStateDiv)}function elementHandler(element){ad.sendAnalyticsEvent({e:"interact.lightbox",v:ad.isOpenStateAdObj()?"close":"open",elId:element?element.id:"auto"});toggle()}function toggle(){if(!ad.isOpenStateAdObj()){open()}else{close()}}function open(){if(adContent.activeConfig.lightboxOpenTracker){ad.callTrackerURL(adContent.activeConfig.lightboxOpenTracker)}if(firstTimeOpen){if(adContent.aft){ad.sendAdformAnalyticsEvent(21,"First Expand")}if(ad.getState().excludeOpenStateSizes){ownSizes=ad.getState().excludeOpenStateSizes}createOpenStateContainer(function(){updateDimensions()})}else{if(adContent.aft){ad.sendAdformAnalyticsEvent(22,"Other Expands")}updateDimensions()}}function updateDimensions(){if(lightboxStateCallback){lightboxStateCallback(true)}lightboxOpen=true;var dimensions=calculateLightboxDimensions();updateLightbox(dimensions);var openStateDiv=ad.getContainer().getAdWindow().parent.document.getElementById(openStateContainerId);dom.addClass(openStateDiv,extensionClassName)}function close(){if(lightboxStateCallback){lightboxStateCallback(false)}events.emitGlobal("closeLightbox",{});if(adContent.aft){ad.sendAdformAnalyticsEvent(23,"Close Button Press")}lightboxOpen=false;autoOpen=false;container.setAutoOpen(autoOpen);var closeStateDiv=container.getAdWindow().parent.document.getElementsByClassName("rad-container-"+uuid.creativeUUID+"-"+ad.getLbNro())[0];if(closeStateDiv){var closedFrame=closeStateDiv.getElementsByTagName("iframe")[0];if(closedFrame){var target=closedFrame.contentWindow||closedFrame;if(target){messaging.sendMessage(target,"closedState","closeLightbox",{})}}}dom.setInlineStyles(container.getAdDocument().body,{opacity:0});dom.setInlineStyles(container.getAdWindow().frameElement.parentNode,{display:"none",opacity:0,position:"fixed","z-index":0,top:"0px",bottom:"0px",right:"0px",left:"0px"});animation.transitionAdSize(container,{},function(){dom.removeClass(container.getAdWindow().frameElement.parentNode,extensionClassName);container.disableOverlay();container.resetCentering()},function(){})}function autoopen(ad){if(ad.isOpenStateAdObj()){return}return autoOpenClose.autoOpen(ad.getMergedContent(),"lightbox",ad.getContainer().getAdWindow(),ad.getContainer().isCrossOrigin(),preview.getPreviewProperties(ad.getContainer().getAdWindow()).isBreakOut,function(){autoOpen=true;open()})}function autoclose(ad){return autoOpenClose.autoClose(ad.getMergedContent(),"lightbox",ad.getContainer().getAdWindow(),function(){close()})}function calculateLightboxDimensions(){var viewport=container.getPageSize();var mqs=ad.getActiveConfig().mediaqueries;var availableSizes=mqs.filter(function(item){var found=ownSizes.find(function(size){if(item.maxWidth.value===size.width&&item.maxHeight.value===size.height){return true}});return found?false:true});var largestFittingSize=availableSizes.reduce(function(largest,current){var fitsInViewport=current.maxWidth.value<viewport.width&&current.maxHeight.value<viewport.height;var area=current.maxWidth.value*current.maxHeight.value;if(fitsInViewport&&area>largest.area){return{area:area,size:{width:current.maxWidth.value,height:current.maxHeight.value}}}return largest},{area:0,size:{width:0,height:0}}).size;return largestFittingSize}function updateLightboxDimensions(dimensions){ad.setSizeFilter([dimensions]);container.centerForSize(dimensions,adContent.noLightBoxTopCenter,customOpenStateZindex,ad.getState().lightBoxTopCenterOverride)}function resizeLightbox(dimensions){animation.transitionAdSize(container,dimensions,function(){updateLightboxDimensions(dimensions)},function(){})}function updateLightbox(dimensions){var openStateDiv=container.getAdWindow().parent.document.getElementById(openStateContainerId);dom.forceInlineStyles(openStateDiv,{display:"block",position:"fixed","z-index":2147483646,top:"0px",bottom:"0px",right:"0px",left:"0px"});var openFrame=openStateDiv.getElementsByTagName("iframe")[0];var openFrameWindow=openFrame.contentWindow||openFrame;if(!firstTimeOpen){messaging.sendMessage(openFrameWindow,"openState","openLightbox",{dimensions:dimensions})}firstTimeOpen=false;if(!adContent.activeConfig.lightbox||adContent.activeConfig.lightbox&&!adContent.activeConfig.lightbox.showClosed){dom.setInlineStyles(container.getAdDocument().body,{opacity:0})}}function openLightbox(dimensions){animation.transitionAdSize(container,dimensions,function(){container.enableOverlay();container.setAutoOpen(autoOpen);updateLightboxDimensions(dimensions);lightboxOpen=true;if(lightboxAfterStateChangeCallback){lightboxAfterStateChangeCallback(lightboxOpen)}dom.setInlineStyles(ad.getContainer().getAdWindow().frameElement.parentElement,{opacity:1})},function(){dom.setInlineStyles(container.getAdDocument().body,{opacity:1})})}}},{"../animation":19,"../dom":32,"../events":52,"../frequencyCappingHandler":60,"../messaging":68,"../preview":73,"../scriptLoader":74,"../uuid":81}],56:[function(require,module,exports){var dom=require("../dom");var anim=require("../animation");var autoOpenClose=require("../frequencyCappingHandler");function getOpenSize(baseSizes,availableSizes){var foundSize={width:availableSizes[availableSizes.length-1].maxWidth.value,height:availableSizes[availableSizes.length-1].maxHeight.value};var baseSize=baseSizes[0];var openSizes=availableSizes.filter(function(item){return item.maxHeight.value===baseSize.height});openSizes.sort(function(a,b){return a.maxWidth.value-b.maxWidth.value});for(var i=0;i<openSizes.length;i++){var s=openSizes[i];if(s.maxWidth.value<=baseSize.width){continue}foundSize={width:openSizes[i].maxWidth.value,height:openSizes[i].maxHeight.value}}return foundSize}var ads=[];var extensions=[];var config={data:{mode:"center"}};function forAd(ad,evConfig){var ext=extensions[ads.indexOf(ad)];config=evConfig||config;if(!ext){ext=init(ad);ads.push(ad);extensions.push(ext)}return ext}function init(ad){var adContent=ad.getMergedContent();var container=ad.getContainer();var mqs=ad.getActiveConfig().mediaqueries;var openSize=getOpenSize(adContent.sizes,mqs);var ownSizes=adContent.sizes;var expanded=false;var extensionClassName="rad-ext-sidekick";var autoOpen=false;ad.onBeforeRender(function(){dom.setInlineStyles(container.getAdDocument().body,{opacity:1})});return{toggle:toggle,open:open,close:close,autoOpen:autoopen,autoClose:autoclose,isOpen:function(){return expanded}};function autoopen(ad){return autoOpenClose.autoOpen(ad.getMergedContent(),"skidekick",ad.getContainer().getAdWindow(),ad.getContainer().isCrossOrigin(),function(){autoOpen=true;open()})}function autoclose(ad){return autoOpenClose.autoClose(ad.getMergedContent(),"skidekick",ad.getContainer().getAdWindow(),function(){close()})}function toggle(el,elConfig){expanded?close():open(el,elConfig)}function open(el,elConfig){if(expanded){return}var direction=config.data.mode;if(elConfig&&elConfig.data){direction=elConfig.data.mode}expanded=true;dom.setInlineStyles(container.getAdDocument().body,{opacity:0});container.setAutoOpen(autoOpen);var oldWidth=container.getAdWindow().frameElement.getBoundingClientRect().width;anim.transitionContainerSize(container,{width:oldWidth},false,false,function(){ad.setSizeFilter([openSize]);dom.addClass(container.getAdDocument().body,extensionClassName);container.setSideKickPosition(ownSizes[0],openSize,direction)},function(){});if(el){ad.sendAnalyticsEvent({e:"interact.sidekick",elId:el.id})}}function close(){if(!expanded){return}autoOpen=false;container.setAutoOpen(autoOpen);expanded=false;dom.setInlineStyles(container.getAdDocument().body,{opacity:0});anim.transitionContainerSize(container,{},false,false,function(){ad.setSizeFilter(ownSizes);dom.removeClass(container.getAdDocument().body,extensionClassName);container.resetSideKickPosition()},function(){})}}module.exports={handleToggleEvent:function(ad,ev,evConfig){forAd(ad,evConfig).toggle(ev.element,evConfig)},forAd:forAd,autoOpen:function(ad){forAd(ad).autoOpen(ad)},autoClose:function(ad){forAd(ad).autoClose(ad)},isEnabledFor:function(ad){return ads.indexOf(ad)!==-1}}},{"../animation":19,"../dom":32,"../frequencyCappingHandler":60}],57:[function(require,module,exports){function generateImageUrl(contentObj,size){return contentObj.adSource+contentObj.id+"/fallbacks/fallback-"+size.width+"x"+size.height+".png"}module.exports={replaceContent:function(contentObj){if(contentObj.activeConfig.ieFallbackLink){contentObj.activeConfig.clickthroughUrl=contentObj.activeConfig.ieFallbackLink}contentObj.activeConfig.elements={};contentObj.activeConfig.mediaqueries.forEach(function(mq,index){var imageId="fallback"+index;var img={type:"image",image:{src:generateImageUrl(contentObj,{width:mq.maxWidth.value,height:mq.maxHeight.value})}};contentObj.activeConfig.elements[imageId]=img;mq.elements={};mq.elements[imageId]={visible:true,anchor:{x:"left",y:"top"},x:{value:0,unit:"px"},y:{value:0,unit:"px"},width:{value:100,unit:"%"},height:{value:100,unit:"%"},lockProportions:true}})}}},{}],58:[function(require,module,exports){var ajaxLoader=require("./ajaxLoader");module.exports={load:function(container,flowlineUrl,callback){var adOptions=container.getAdOptions();if(!flowlineUrl||container.isCrossOrigin()||adOptions.applenews||adOptions.mraid){callback();return}ajaxLoader.load(flowlineUrl,function(err,css){var styleTag=container.insertStylesToPage(css);if(!styleTag){console.warn("styleTag in undefined. Radical will not finish loading flowline");return}var adjustmentValue=adjustScrollbar(container,styleTag,0);container.onResize(function(){adjustmentValue=adjustScrollbar(container,styleTag,adjustmentValue)});callback()})}};function adjustScrollbar(container,styleTag,activeValue){var scrollbar=container.getScrollbarSize();if(scrollbar===activeValue){return scrollbar}var adjustment=scrollbar;if(adjustment===0&&activeValue>0){adjustment=activeValue*-1}for(var i=0;i<styleTag.sheet.cssRules.length;i++){var rule=styleTag.sheet.cssRules[i];if(rule.type!==4){continue}rule.media.mediaText=rule.media.mediaText.replace(/\(max-width:\s*([0-9.]+)px\)/g,function(media,width){width=+width;return media.replace(width,width+adjustment)})}return scrollbar}},{"./ajaxLoader":14}],59:[function(require,module,exports){const dom=require("./dom");function fontSettingsToCSSProperties(fontSettings){const rules={};if(fontSettings.fontFamily){rules["font-family"]='"'+fontSettings.fontFamily+'"'}rules["letter-spacing"]=dom.vuToString(fontSettings.letterSpacing);rules["line-height"]=fontSettings.lineHeight;rules["font-style"]=fontSettings.fontStyle;rules["font-size"]=dom.vuToString(fontSettings.fontSize);rules["text-align"]=fontSettings.textAlign;rules["vertical-align"]=fontSettings.textVerticalAlign;rules["font-weight"]=fontSettings.fontWeight;rules.color=fontSettings.color;return rules}function copyFontSettings(f){return Object.assign({},{...f,letterSpacing:Object.assign({},f.letterSpacing),fontSize:Object.assign({},f.fontSize)})}module.exports={copyFontSettings:copyFontSettings,fontSettingsToCSSProperties:fontSettingsToCSSProperties}},{"./dom":32}],60:[function(require,module,exports){var storage;var events=require("./events");var device=require("./device");var dom=require("./dom");var PER_USER_CAP_PREFIX="___rdfcpu_";var RESET_INTERVAL_PREFIX="___rdfcri_";module.exports={autoOpen:function(adConfig,extensionName,windowRef,crossOrigin,previewBreakout,callback){if(!adConfig||!adConfig.activeConfig||adConfig.inEditor||adConfig.screenshot||previewBreakout){return}var extensionConfig=adConfig.activeConfig[extensionName];if(!extensionConfig||!extensionConfig.autoOpen){return}if(!storage){storage=require("./storage")}var store=storage.open(windowRef,adConfig);var perUserCapCookie=Number(store.get(PER_USER_CAP_PREFIX+extensionName+"_"+adConfig.deployment)||0);var resetIntervalCapCookie=Number(store.get(RESET_INTERVAL_PREFIX+extensionName+"_"+adConfig.deployment)||0);var shouldCallCallback=(!extensionConfig.perUserFrequencyCap||perUserCapCookie<extensionConfig.perUserFrequencyCap)&&!isDisabledForDevice();function isDisabledForDevice(){if(!extensionConfig.autoOpenDisable){return false}var mobile=device.getDeviceProperties(windowRef).isMobile;return mobile&&extensionConfig.autoOpenDisable.mobile}if(extensionConfig.perUserFrequencyCap){var currentTimestamp=(new Date).getTime();var whenToReset=resetIntervalCapCookie+extensionConfig.resetIntervalFrequecyCap*1e3;if(resetIntervalCapCookie&&currentTimestamp>=whenToReset){shouldCallCallback=true;perUserCapCookie=0;resetIntervalCapCookie=0}if(extensionConfig.resetIntervalFrequecyCap&&!resetIntervalCapCookie){store.set(crossOrigin,RESET_INTERVAL_PREFIX+extensionName+"_"+adConfig.deployment,currentTimestamp,365)}store.set(crossOrigin,PER_USER_CAP_PREFIX+extensionName+"_"+adConfig.deployment,perUserCapCookie+1,365)}if(shouldCallCallback){callback()}},autoClose:function(adConfig,extensionName,adWindow,callback){if(!adConfig||!adConfig.activeConfig||adConfig.inEditor){return}var extensionConfig=adConfig.activeConfig[extensionName];if(!extensionConfig||!extensionConfig.autoCloseMode||!extensionConfig.closeAfterSeconds){return}var autoCloseTimer;var closeCanceled=false;if(extensionConfig.autoCloseMode=="afterOpen"){events.addGlobalListener("initialLoad",function(){autoCloseTimer=setTimeout(function(){callback()},extensionConfig.closeAfterSeconds*1e3)})}if(extensionConfig.autoCloseMode=="videoFinish"){events.addGlobalListener("videoEnded",function(data){if(data.elId==extensionConfig.videoReference&&closeCanceled!=true){autoCloseTimer=setTimeout(function(){callback()},extensionConfig.closeAfterSeconds*1e3)}})}if(extensionConfig.autoCloseDisable&&extensionConfig.autoCloseDisable.onInteraction){var stopAutoClose=function(){clearTimeout(autoCloseTimer);closeCanceled=true;removeMouseEnter();removeTouchStart()};var removeMouseEnter=dom.addEventListener(adWindow.document.body,"mouseenter",stopAutoClose);var removeTouchStart=dom.addEventListener(adWindow.document.body,"touchstart",stopAutoClose)}}}},{"./device":31,"./dom":32,"./events":52,"./storage":75}],61:[function(require,module,exports){var dom=require("./dom");module.exports={load:function(url,document,callback){var img=document.createElement("img");dom.addEventListener(img,"load",function(){if(callback){return callback(null)}});img.addEventListener("error",function(){if(callback){callback(new Error("Failed loading image: "+url))}},false);img.src=url;return img}}},{"./dom":32}],62:[function(require,module,exports){(function(global){(function(){var radical=require("../radical");var globalThis=typeof global==="undefined"?window:global;if(typeof Radical!=="undefined"&&Radical.getAdByWindow){return}radical.window=globalThis;if(globalThis.Radical&&globalThis.Radical[0]){radical.push.apply(radical,globalThis.Radical)}Radical=radical}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../radical":7}],63:[function(require,module,exports){var dom=require("./dom");module.exports={addListeners:function(ad){var container=ad.getContainer();ad.onClick(function(ev){if(!ev.element){return}if(ev.elementConfig&&ev.elementConfig.type==="videoCustomPlayMuteRestartControl"){return}var pos=dom.getMousePosition(ev.domEvent,container.getAdWindow());pos=pos.posx+"x"+pos.posy;var eventData={e:"interact.click",elId:ev.element.id,pos:pos};var adClickthrough=ad.getActiveConfig().clickthroughUrl;if(adClickthrough&&!dom.path(ev,"elementConfig.onClick")){eventData.e="click";eventData.lu=adClickthrough}if(dom.path(ev,"elementConfig.onClick")){ev.elementConfig.onClick.map(function(action){if(action.action==="clickthrough"){eventData.e="click";eventData.lu=action.data.url}})}if(!eventData.lu){if(dom.path(ev,"elementConfig.onClick")){ev.elementConfig.onClick.map(function(action){if(action.action==="hidecondenast"){eventData.rtype="skip"}})}}ad.sendAnalyticsEvent(eventData)});if(ad.getActiveConfig().trackAdHovers){ad.onElementHover(function(ev){if(!ev.element){return}var pos=dom.getMousePosition(ev.domEvent,container.getAdWindow());pos=pos.posx+"x"+pos.posy;ad.sendAnalyticsEvent({e:"interact.hover",elId:ev.element.id,pos:pos})})}}}},{"./dom":32}],64:[function(require,module,exports){function getCoverImageSize(containerSize,imageSize){var imageAspect=imageSize.width/imageSize.height;var elAspect=containerSize.width/containerSize.height;if(imageAspect>elAspect){imageSize={height:containerSize.height,width:containerSize.height*imageAspect}}else if(imageAspect<elAspect){imageSize={width:containerSize.width,height:containerSize.width/imageAspect}}else{imageSize={width:containerSize.width,height:containerSize.height}}return imageSize}module.exports={calculateFocalPointOffset:function(focalPoint,containerSize,imageSize){imageSize=getCoverImageSize(containerSize,imageSize);var focalPointX=imageSize.width*(focalPoint.x/100);var xOffset=-1*focalPointX+containerSize.width/2;var maxX=-imageSize.width+containerSize.width;var clampedX=Math.min(0,Math.max(maxX,xOffset));var focalPointY=imageSize.height*(focalPoint.y/100);var yOffset=-1*focalPointY+containerSize.height/2;var maxY=-imageSize.height+containerSize.height;var clampedY=Math.min(0,Math.max(maxY,yOffset));return{x:clampedX,y:clampedY}},getCoverImageSize:getCoverImageSize}},{}],65:[function(require,module,exports){var errorHandler=function(){};module.exports={log:function(message){if(!console||!console.log){return}console.log(message)},warn:function(message){if(!console||!console.warn){return}console.warn(message)},error:function(message,data){if(console.log){console.log(message,data)}errorHandler(message,data)},setErrorHandler:function(handler){errorHandler=handler}}},{}],66:[function(require,module,exports){const log=require("./log");const unitConversions={"mph-ms":function(mph){return mph*.44704},"ms-mph":function(ms){return ms*2.236936},"f-c":function(f){return 5/9*(f-32)},"c-f":function(c){return 1.8*c+32},"inches-cm":function(inches){return inches*2.54},"cm-inches":function(cm){return cm*.3937}};module.exports={lerp:function(alpha,rangeStart,rangeEnd){return rangeStart+alpha*(rangeEnd-rangeStart)},inverseLerp:function(value,rangeStart,rangeEnd){return(value-rangeStart)/(rangeEnd-rangeStart)},isValueInRange:function(value,range){if(range.min!==""&&range.max!==""){return value>=range.min&&value<=range.max}if(range.min===""){return value<=range.max}else{return value>=range.min}},unitConvertRange:function(range,targetUnit){return{min:this.convertUnit({value:range.min,unit:range.unit},targetUnit),max:this.convertUnit({value:range.max,unit:range.unit},targetUnit)}},convertUnit:function(valueUnit,targetUnit){if(valueUnit.unit===targetUnit){return valueUnit.value}const wantedConversion=`${valueUnit.unit}-${targetUnit}`;const converter=unitConversions[wantedConversion];if(!converter){log.error(`Cannot convert units ${wantedConversion}`);return valueUnit.value}return converter(valueUnit.value)}}},{"./log":65}],67:[function(require,module,exports){var dom=require("./dom");module.exports.findLargestFitting=function(mqs,windowSize){return mqs.reduce(function(biggest,mq){var mh=mq.maxHeight.value;var mw=mq.maxWidth.value;var fitsInWindow=windowSize.width<=mw&&windowSize.height<=mh;if(biggest===null){return fitsInWindow?mq:biggest}var smaller=mw*mh<=biggest.maxWidth.value*biggest.maxHeight.value;if(fitsInWindow&&smaller){return mq}return biggest},null)};module.exports.findExact=function(mqs,size){if(!size){throw new Error("Size must be set")}return mqs.find(function(mq){return mq.maxWidth.value===size.width&&mq.maxHeight.value===size.height})};module.exports.findBestByAspectRatio=function(mqs,size){return findBestAspectRatio(size,mqs,Infinity)};module.exports.findBestByAspectAndSize=function(mqs,size){var exact=module.exports.findExact(mqs,size);if(exact){return exact}var sizeTolerance=.3;var best=findBestAspectRatio(size,mqs.filter(function(mq){return percentDiff(mq.maxWidth.value,size.width)<=sizeTolerance&&percentDiff(mq.maxHeight.value,size.height)<=sizeTolerance}),Infinity);if(!best){best=findBestAspectRatio(size,mqs,Infinity)}return best};function findBestAspectRatio(size,mqs,aspectRatioTolerance){var sizeAspect=aspectRatio(size.width,size.height);var initial={mq:null,difference:Infinity};var differences=mqs.map(function(mq){var mqAspect=aspectRatio(mq.maxWidth.value,mq.maxHeight.value);var diff=percentDiff(sizeAspect,mqAspect);return{mq:mq,difference:diff}});var mqWithBestAspect=differences.reduce(function(best,difference){var mqWithinTolerance=difference.difference<aspectRatioTolerance;if(!mqWithinTolerance||difference.difference>best.difference){return best}return difference},initial);var choices=differences.filter(function(mq){return mq.difference===mqWithBestAspect.difference});if(choices.length===1){return choices[0].mq}var sizeDiffInitial={mq:null,diffX:Infinity,diffY:Infinity};return choices.reduce(function(best,choice){var x=percentDiff(choice.mq.maxWidth.value,size.width);var y=percentDiff(choice.mq.maxHeight.value,size.height);if(x<best.diffX&&y<best.diffY){return{mq:choice.mq,diffX:x,diffY:y}}return best},sizeDiffInitial).mq}function aspectRatio(w,h){return w/h}function percentDiff(a,b){return Math.abs(a-b)/((a+b)/2)}},{"./dom":32}],68:[function(require,module,exports){var events=require("./events");var supportedEventTypes=["openState","closedState"];var supportedEventActions=["closeLightbox","openLightbox","updateState"];function receiveMessage(event){if(event.data.from==="RAD"){if(supportedEventTypes.indexOf(event.data.type)>-1){if(supportedEventActions.indexOf(event.data.action)>-1){events.emitGlobal("postMessage",event)}}}}module.exports={sendMessage:function(target,type,action,data){if(target){target.postMessage({from:"RAD",type:type,action:action,data:data},"*")}else{return}},init:function(container){container.getAdWindow().addEventListener("message",receiveMessage,false)}}},{"./events":52}],69:[function(require,module,exports){var dom=require("./dom");var log=require("./log");function createTimer(){var timers={};var logEvents=false;return{logEvents:function(){logEvents=true},start:function(eventName){timers[eventName]={started:(new Date).getTime(),ended:0}},stop:function(eventName){timers[eventName].ended=(new Date).getTime();if(logEvents){log.log("Metrics: `"+eventName+"` took "+(timers[eventName].ended-timers[eventName].started)+"ms")}},collect:function(){return Object.keys(timers).map(function(eventName){var t=timers[eventName];return{name:eventName,duration:Math.max(0,t.started-t.ended)}}).filter(function(ev){return ev.duration>0})}}}module.exports={createTimer:createTimer}},{"./dom":32,"./log":65}],70:[function(require,module,exports){var dom=require("./dom");var events=require("./events");var isMraidCreative=false;var mraid;var impressionSent=false;var previousState;module.exports={initialize:function(doc,adOptions){var mraidLoaded=false;mraid=window.mraid;if(mraid===undefined){var head=doc.getElementsByTagName("head").item(0);var mraid_script=doc.createElement("script");mraid_script.src="mraid.js";head.appendChild(mraid_script);mraid_script.addEventListener("load",function(){mraid=window.mraid});mraid_script.addEventListener("error",function(){console.log("MRAID DYNAMIC INCLUDE FAILED")})}if(typeof mraid!=="undefined"){mraid.addEventListener("stateChange",this.stateChanged);if(!adOptions.applenews){mraid.addEventListener("sizeChange",this.sizeChanged)}mraid.addEventListener("viewableChange",this.viewableChanged);mraid.addEventListener("error",this.errorEvent);if(mraid.getState()==="loading"){mraid.addEventListener("ready",this.displayAd)}else if(mraid.getState()==="default"){this.displayAd()}mraidLoaded=true}return mraidLoaded},isMraidCreative:function(){return isMraidCreative},stateChanged:function(state){if(previousState==="expanded"&&previousState!=state){events.emitGlobal("mraid-closed",true);mraid.unload()}previousState=state},sizeChanged:function(width,height){},viewableChanged:function(viewable){},exposureChanged:function(exposedPercentage,visibleRectangle,occlusionRectangles){if(!impressionSent){if(exposedPercentage&&exposedPercentage>0||visibleRectangle&&visibleRectangle.height>0){impressionSent=true;events.emitGlobal("mraid-impression",true);this.removeExposureChanged()}}},removeExposureChanged:function(){mraid.removeEventListener("exposureChange",this.exposureChanged)},errorEvent:function(message,action){console.log("mraidHandler.errorEvent "+message+" "+action)},displayAd:function(){isMraidCreative=true},expand:function(url){var size=mraid.getScreenSize();this.setExpandProperties({width:size.width,height:size.height,useCustomClose:false});if(!url){mraid.expand()}else{mraid.expand(url)}},close:function(){mraid.close()},getExpandProperties:function(){var properties=mraid.getExpandProperties();return properties},setExpandProperties:function(properties){mraid.setExpandProperties(properties)},getPlacementType:function(){var placementType=mraid.getPlacementType();return placementType},getState:function(){var state=mraid.getState();return state},getVersion:function(){var version=mraid.getVersion();return version},isViewable:function(){var viewable=mraid.isViewable();return viewable},open:function(url){mraid.open(url)}}},{"./dom":32,"./events":52}],71:[function(require,module,exports){var dom=require("./dom");var url=require("./url");var dataSource=require("./dataSource");var log=require("./log");const math=require("./math");const ApiError=require("./ApiError");module.exports={parseAdContent:function(adContent,options,userInfo,callback){var adVersion=9;if(typeof options.isFluid==="string"){options.isFluid=options.isFluid!=="false"}var activeConfig=dom.merge({},adContent.config._default);if(options.config&&options.config._default){dom.merge(activeConfig,options.config._default)}if(adContent.config.deployment){dom.merge(activeConfig,adContent.config.deployment)}activeConfig=filterElementsByUserConstraints(activeConfig,userInfo,options.screenshot);processConditionsTable(activeConfig,options,userInfo,function(err){if(err){callback(err);return}var parsedResult=dom.merge({sizes:[],adVersion:adVersion,activeConfig:activeConfig},adContent,options);if(parsedResult.sizes.length&&typeof parsedResult.sizes[0]=="string"){var fixedFilter=[];for(var i=0;i<parsedResult.sizes.length;i++){var sz=parsedResult.sizes[i].split(/x/);fixedFilter.push({width:parseInt(sz[0],10),height:parseInt(sz[1],10)})}parsedResult.sizes=fixedFilter}if(!activeConfig.disableVariants&&activeConfig.selectedVariant){var variantData=activeConfig.variants.find(function(v){return v.name===activeConfig.selectedVariant});var toggles=variantData.elementToggles;if(toggles){activeConfig.mediaqueries=activeConfig.mediaqueries.map(function(mq){var elementStyles=Object.assign({},mq.elements);toggles.forEach(function(elToggle){elementStyles[elToggle.id]=Object.assign({},elementStyles[elToggle.id],{visible:elToggle.visible})});return Object.assign({},mq,{elements:elementStyles})})}}preloadFeeds(activeConfig,function(err){if(err){callback(err);return}callback(null,parsedResult)})})}};function preloadFeeds(activeConfig,callback){var taskCount=0;for(var elId in activeConfig.elements){var el=activeConfig.elements[elId];if(el.dataSource&&el.dataSource.type==="feed"){taskCount++;dataSource.feed(el.dataSource.url).load(done)}}if(taskCount===0){callback()}function done(err){if(err){log.warn("Error preloading feed: "+JSON.stringify(err))}taskCount--;if(taskCount===0){callback()}}}function processConditionsTable(activeConfig,options,userInfo,callback){if(activeConfig.useDynamicVariant&&activeConfig.variants&&activeConfig.conditionsTable&&!options.inEditor){prepareConditionsTableContext(options.id,activeConfig.conditionsTable,userInfo,function(err,context){if(err instanceof ApiError){log.warn("Received API error, falling back to default variant");log.warn(err);callback(null);return}if(err){callback(err);return}applyConditionsTable(activeConfig,options,context);callback(null)});return}callback(null)}function prepareConditionsTableContext(creativeId,conditionsTable,userInfo,callback){let queue=Promise.resolve({userInfo:userInfo});const needsWeatherPrerequisites=needsWeatherInfo(conditionsTable)&&!userInfo.hasZipCode();const needsCountryPrerequisites=needsCountryInfo(conditionsTable)&&!userInfo.hasCountryCode();const needsZipCodePreqrequisites=needsZipCode(conditionsTable)&&!userInfo.hasZipCode();if(needsZipCodePreqrequisites||needsCountryPrerequisites||needsWeatherPrerequisites){if(userInfo.hasFetchedLocationData()){callback("userInfo has fetched location data, but data is not valid");return}queue=new Promise(function(resolve,reject){userInfo.updateLocationFromAPI(function(err){if(err){reject(err);return}resolve({userInfo:userInfo})})})}if(needsWeatherInfo(conditionsTable)){queue=queue.then(({userInfo})=>new Promise(function(resolve,reject){userInfo.updateWeatherFromAPI(creativeId,function(err,weatherData){if(err){reject(err);return}resolve({userInfo:userInfo})})}))}queue.then(context=>callback(null,context)).catch(err=>callback(err))}function applyConditionsTable(activeConfig,options,conditionsTableContext){const userInfo=conditionsTableContext.userInfo;const weather=conditionsTableContext.userInfo.getWeatherData();var queryParams=url.getQueryParams(location.href);var now=new Date;var testDate=queryParams.rad_variant_param_date;if(testDate){var dateParts=testDate.split("-");now=new Date(dateParts[2],parseInt(dateParts[1],10)-1,dateParts[0])}else if(activeConfig.environmentOverrides){if(activeConfig.environmentOverrides.date){now=new Date(activeConfig.environmentOverrides.date)}}var currentHour=now.getHours();var currentMinute=now.getMinutes();var testTime=queryParams.rad_variant_param_time||activeConfig.environmentOverrides&&activeConfig.environmentOverrides.time;if(testTime){const timeParts=testTime.split(":");currentHour=parseInt(timeParts[0],10);currentMinute=parseInt(timeParts[1],10)}var currentDay=now.getDay();var testDay=queryParams.rad_variant_param_day;if(testDay){currentDay=parseInt(testDay,10)}else if(activeConfig.environmentOverrides&&activeConfig.environmentOverrides.day){currentDay=activeConfig.environmentOverrides.day}var language=navigator.language;var testLang=queryParams.rad_variant_param_language;if(testLang){language=testLang}else if(activeConfig.environmentOverrides&&activeConfig.environmentOverrides.language){language=activeConfig.environmentOverrides.language}var locationData=userInfo.getLocationData();var country=locationData.countryCode;var testCountry=queryParams.rad_variant_param_country;if(testCountry){country=testCountry}else if(activeConfig.environmentOverrides&&activeConfig.environmentOverrides.country){country=activeConfig.environmentOverrides.country}country=country.toLowerCase();var zipCode=locationData.zipCode;var testZipCode=queryParams.rad_variant_param_zipCode;if(testZipCode){zipCode=testZipCode}else if(activeConfig.environmentOverrides&&activeConfig.environmentOverrides.zipCode){zipCode=activeConfig.environmentOverrides.zipCode}zipCode=zipCode.toLowerCase();var pageUrl=location.href;var testUrl=queryParams.rad_variant_param_url;if(testUrl){pageUrl=testUrl}else if(activeConfig.environmentOverrides&&activeConfig.environmentOverrides.url){pageUrl=activeConfig.environmentOverrides.url}const weatherFields=["weatherCondition","precipitationChance1Hour","precipitationChance6Hour","snowChance1Hour","snowChance6Hour","temperature","windSpeed","uvIndex"];weatherFields.forEach(function(propertyName){const queryValue=queryParams[`rad_variant_param_${propertyName}`];const envValue=activeConfig.environmentOverrides?activeConfig.environmentOverrides[propertyName]:null;if(queryValue||envValue){weather[propertyName]=queryValue||envValue}});let partialMatchRows=[];let exactMatchRows=[];activeConfig.conditionsTable.rows.forEach(function(row){const testResults=row.conditions.map(function(condition,index){if(condition===null){return"wildcardMatch"}var conditionType=activeConfig.conditionsTable.conditionColumns[index].type;if(conditionType==="date"){var variantStart=new Date(condition.from);var variantEnd=new Date(condition.to);if(isNaN(variantStart)||isNaN(variantEnd)){return false}variantStart.setHours(0);variantStart.setMinutes(0);variantStart.setSeconds(0);variantStart.setMilliseconds(0);variantEnd.setDate(variantEnd.getDate()+1);variantEnd.setHours(0);variantEnd.setMinutes(0);variantEnd.setSeconds(0);variantEnd.setMilliseconds(0);return now>=variantStart&&now<variantEnd}else if(conditionType==="day"){return condition.days.indexOf(currentDay)!==-1}else if(conditionType==="time"){if(!condition.from||!condition.to){return false}const fromTotalMinutes=condition.from.hours*60+condition.from.minutes;const toTotalMinutes=condition.to.hours*60+condition.to.minutes;const currentTotalMinutes=currentHour*60+currentMinute;return fromTotalMinutes<=currentTotalMinutes&&currentTotalMinutes<=toTotalMinutes}else if(conditionType==="language"){var langParts=language.toLowerCase().split("-");if(!condition.language){return false}var condParts=condition.language.toLowerCase().split("-");return condParts.length===2&&language.toLowerCase()===condition.language.toLowerCase()||condParts.length===1&&condParts[0]===langParts[0]}else if(conditionType==="country"){return condition.country&&condition.country.toLowerCase()===country}else if(conditionType==="zipCode"){return condition.zipCodes&&condition.zipCodes.indexOf(zipCode)!==-1}else if(conditionType==="weatherCondition"){return condition.weatherConditions&&condition.weatherConditions.indexOf(weather.weatherCondition.toLowerCase())!==-1}else if(conditionType==="weatherTemperature"){return weather&&weather.temperature&&math.isValueInRange(weather.temperature.value,math.unitConvertRange(condition.temperatureRange,weather.temperature.unit))}else if(conditionType==="weatherPrecipitationChance1Hour"){return weather&&math.isValueInRange(weather.precipitationChance1Hour,condition.precipitationChanceRange)}else if(conditionType==="weatherPrecipitationChance6Hour"){return weather&&math.isValueInRange(weather.precipitationChance6Hour,condition.precipitationChanceRange)}else if(conditionType==="weatherSnowfallChance1Hour"){return weather&&math.isValueInRange(weather.snowChance1Hour,condition.snowfallChanceRange)}else if(conditionType==="weatherSnowfallChance6Hour"){return weather&&math.isValueInRange(weather.snowChance6Hour,condition.snowfallChanceRange)}else if(conditionType==="weatherWindSpeed"){return weather&&weather.windSpeed&&math.isValueInRange(weather.windSpeed.value,math.unitConvertRange(condition.windSpeedRange,weather.windSpeed.unit))}else if(conditionType==="weatherUvIndex"){return weather&&math.isValueInRange(weather.uvIndex,condition.uvIndexRange)}else if(conditionType==="url"){var urlParts=pageUrl.split("//");return urlParts[1].indexOf(condition.urlWithoutProtocol)===0}else{console.log("Unknown condition type: "+conditionType);return false}});if(testResults.every(f=>f===true)){exactMatchRows.push(row)}else if(testResults.every(f=>f===true||f==="wildcardMatch")){partialMatchRows.push(row)}});const rowSet=exactMatchRows.length===0?partialMatchRows:exactMatchRows;const activeRow=Math.floor(Math.random()*rowSet.length);if(rowSet[activeRow]){const row=rowSet[activeRow];activeConfig.activeConditionsTableRow=row;for(var conditionRow in activeConfig.conditionsTable.rows){var matchRow=row.conditions.length===activeConfig.conditionsTable.rows[conditionRow].conditions.length&&row.conditions.every(function(value,index){return value===activeConfig.conditionsTable.rows[conditionRow].conditions[index]});if(matchRow){activeConfig.activeConditionsTableRowIndex=conditionRow}}if(row.values.length>0){var databoundElements={};for(var elId in activeConfig.elements){var el=activeConfig.elements[elId];if(el.databinding){databoundElements[el.databinding]=el}}row.values.forEach(function(rowData,index){if(rowData===null){return}var valueData=activeConfig.conditionsTable.valueColumns[index];if(valueData.type==="variant"){activeConfig.selectedVariant=rowData.value}else if(valueData.type==="text"){var element=databoundElements[valueData.name];if(element&&element.dataSource){element.dataSource.url=rowData.value}}else{console.log("Unknown value type: "+rowData.type)}})}}}function needsCountryInfo(conditionsTable){return conditionsTable.conditionColumns.some(function(column){return column.type==="country"})}function needsZipCode(conditionsTable){return conditionsTable.conditionColumns.some(function(column){return column.type==="zipCode"})}function needsWeatherInfo(conditionsTable){return conditionsTable.conditionColumns.some(function(column){return column.type.indexOf("weather")===0})}function filterElementsByUserConstraints(activeConfig,userInfo,isFallbacks){var device=userInfo.getDeviceInfo();if(activeConfig.environmentOverrides){if(activeConfig.environmentOverrides.deviceCategory==="tablet"){device.isOtherTouchDevice=true;device.isMobile=false;device.isOtherDevice=false}else if(activeConfig.environmentOverrides.deviceCategory==="mobile"){device.isOtherTouchDevice=false;device.isMobile=true;device.isOtherDevice=false}else if(typeof activeConfig.environmentOverrides.deviceCategory==="string"){device.isOtherTouchDevice=false;device.isMobile=false;device.isOtherDevice=true}}var elementsToHide=[];for(var elementId in activeConfig.elements){var el=Object.assign({},activeConfig.elements[elementId]);var validOther=device.isOtherDevice&&el.visibleOther!==false;var validMobile=device.isMobile&&el.visibleMobile!==false;var validTouch=device.isOtherTouchDevice&&el.visibleTouch!==false;var unknownDeviceType=!device.isOtherDevice&&!device.isMobile&&!device.isOtherTouchDevice;var everVisible=validOther||validMobile||validTouch||unknownDeviceType;if(!everVisible||isFallbacks&&el.visibleFallbacks===false){elementsToHide.push(elementId)}}if(elementsToHide.length>0){activeConfig.mediaqueries=activeConfig.mediaqueries.map(function(mq){var elementStyles=Object.assign({},mq.elements);elementsToHide.forEach(function(elementId){var el=Object.assign({},elementStyles[elementId]);if(!el){return}el.visible=false;elementStyles[elementId]=el});return Object.assign({},mq,{elements:elementStyles})})}return activeConfig}},{"./ApiError":8,"./dataSource":30,"./dom":32,"./log":65,"./math":66,"./url":79}],72:[function(require,module,exports){function createOverride(override){var overrideType=override;var overrideFunction=function(){var oc=window.top.document.querySelectorAll("#rad-"+overrideType+"-inject")[0];if(oc&&overrideType=="nltransitional"){return false}else if(oc){oc.parentNode.removeChild(oc)}var c=document.createElement("div");c.id="rad-"+overrideType+"-inject";var w=document.createElement("div");w.id="rad-"+overrideType+"-wrapper";var i=document.createElement("ins");c.appendChild(i);c.appendChild(w);if(overrideType==="nlbackstage"){var p=window.top.document.querySelectorAll(".article-content")[0];var a=window.top.document.querySelectorAll(".article-content p:nth-of-type(3)")[0];if(p&&a){p.insertBefore(c,a.nextSibling)}}else if(overrideType==="nlfloor"){window.top.document.body.appendChild(c)}else if(overrideType==="nltransitional"){var header=document.createElement("div");header.className="rad-site-header";var skip=document.createElement("div");skip.className="rad-site-header-skip";var logo=document.createElement("img");logo.className="rad-site-header-skip-logo";var text=document.createElement("div");text.className="rad-site-header-skip-text";skip.appendChild(logo);skip.appendChild(text);header.appendChild(skip);c.insertBefore(header,c.firstChild);window.top.document.body.appendChild(c)}else{window.top.document.body.appendChild(c)}return w};return overrideFunction}module.exports={createOverride:createOverride}},{}],73:[function(require,module,exports){var preview={getPreviewProperties:function(window){return{isPreviewDevice:isPreviewDevice(window),isMobileOrTablet:isMobileOrTablet(window),deviceDimensions:deviceDimensions(window),isBreakOut:isBreakOut(window)}}};function isPreviewDevice(window){try{var queryDict={};window.top.location.search.substr(1).split("&").forEach(function(item){queryDict[item.split("=")[0]]=item.split("=")[1]});return queryDict.hasOwnProperty("device")&&!isBreakOut(window)}catch(err){return false}}function isMobileOrTablet(window){try{var queryDict={};window.top.location.search.substr(1).split("&").forEach(function(item){queryDict[item.split("=")[0]]=item.split("=")[1]});return queryDict.hasOwnProperty("device")&&(queryDict["device"]!=="hidpi"&&queryDict["device"]!=="midpi")&&!isBreakOut(window)}catch(err){return false}}function deviceDimensions(window){var dimensions;if(window.parent&&window.parent.frameElement){dimensions={width:window.parent.frameElement.offsetWidth,height:window.parent.frameElement.offsetHeight}}return dimensions}function isBreakOut(window){try{return window.top.location.href.indexOf("breakout-all")>-1}catch(err){return false}}module.exports=preview},{}],74:[function(require,module,exports){var dom=require("./dom");module.exports={load:function(src,document,callback){var callbackCalled=false;function handleEvent(){if(callbackCalled){return}callbackCalled=true;callback()}function handleStateChangeEvent(event){if(event&&(event.target.readyState==="loaded"||event.target.readyState==="complete")){handleEvent()}}var s=document.createElement("script");s.src=src;dom.addEventListener(s,"load",handleEvent);dom.addEventListener(s,"readystatechange",handleStateChangeEvent);document.getElementsByTagName("head")[0].appendChild(s)}}},{"./dom":32}],75:[function(require,module,exports){var cookie=require("cookie-monster");function noopStore(){return{get:function(){},set:function(){}}}function store(window){var cookies=cookie(window.document);return{get:function(key){return cookies.get(key)},set:function(crossOrigin,key,value,lifetimeSeconds){var options={};var protocol=crossOrigin?null:window.parent.location.protocol;if(protocol&&protocol==="https:"){options["samesite"]=true;options["secure"]=true}if(lifetimeSeconds){var expiry=new Date;expiry.setSeconds(expiry.getSeconds()+lifetimeSeconds);options.expires=expiry.toUTCString()}cookies.set(key,value,options)}}}module.exports={open:function(window,config){return config.GDN?noopStore():store(window)}}},{"cookie-monster":4}],76:[function(require,module,exports){var dom=require("./dom");module.exports={load:function(url,document,callback){var link=document.createElement("link");link.setAttribute("href",url);link.rel="stylesheet";dom.addEventListener(link,"load",function(event){callback(null,event)});document.getElementsByTagName("head")[0].appendChild(link)},remove:function(url,document,callback){var links=document.getElementsByTagName("link");var head=document.getElementsByTagName("head")[0];for(var i=0;i<links.length;i++){if(links[i].href.indexOf(url)>-1){head.removeChild(links[i]);break}}if(callback){callback()}}}},{"./dom":32}],77:[function(require,module,exports){module.exports={parse:function(tagParameters){const zipCode=getZipCode(getLocationOption(tagParameters,"zipCode"));const countryCode=getCountryCode(getLocationOption(tagParameters,"countryCode"));return{location:{zipCode:zipCode,countryCode:countryCode}}}};function getLocationOption(params,name){let value="";if(params.location&&typeof params.location[name]!=="undefined"){value=params.location[name]}let defaultValue="";if(params.locationDefault&&typeof params.locationDefault[name]!=="undefined"){defaultValue=params.locationDefault[name]}return{value:value,defaultValue:defaultValue}}function getZipCode({value,defaultValue}){return String(/^[0-9]+$/.test(value)?value:defaultValue)}function getCountryCode({value,defaultValue}){return(/^[a-z]{2}$/i.test(value)?value:defaultValue).toLowerCase()}},{}],78:[function(require,module,exports){module.exports.getRelativeTime=function(date){var ms=date.getTime();var SECOND_MS=1e3;var MINUTE_MS=60*SECOND_MS;var HOUR_MS=60*MINUTE_MS;var DAY_MS=24*HOUR_MS;var WEEK_MS=7*DAY_MS;var MONTH_MS=30*DAY_MS;var lookup=["months","weeks","days","hours","minutes","seconds"];var values=[];values.push(ms/MONTH_MS);ms%=MONTH_MS;values.push(ms/WEEK_MS);ms%=WEEK_MS;values.push(ms/DAY_MS);ms%=DAY_MS;values.push(ms/HOUR_MS);ms%=HOUR_MS;values.push(ms/MINUTE_MS);ms%=MINUTE_MS;values.push(ms/SECOND_MS);ms%=SECOND_MS;var pretty="about ";for(var i=0;i<values.length;i++){var val=Math.round(values[i]);if(val<=0)continue;pretty+=val+" "+lookup[i]+" ago";break}return pretty};module.exports.diff=function(a,b){return new Date(a-b)}},{}],79:[function(require,module,exports){var dom=require("./dom");var hasProtoRe=/^https?:/;var hasExportRe=/^assets|^libs/;module.exports={isExternal:function(url){return/^(\/|https?:\/\/)/.test(url)},toFullUrl:function(url,adConfig){if(!url){return""}if(hasProtoRe.test(url)||hasExportRe.test(url)){return url}if(/^\/\//.test(url)){return(adConfig.https===false?"http:":"https:")+url}var adSource=adConfig.adSource;if(!hasProtoRe.test(adSource)&&!adConfig.export){adSource=(adConfig.https===false?"http:":"https:")+adSource}return adSource+url},getQueryParams:function(url){var hashParts=url.split("#");var urlParts=hashParts[0].split("?");if(urlParts.length===1){return{}}var queryParams=urlParts[1].split("&");var paramMap={};queryParams.forEach(function(param){var keyVal=param.split("=");if(keyVal.length===1){paramMap[keyVal[0]]=true;return}paramMap[keyVal[0]]=keyVal[1]});return paramMap},toQueryString:function(params){var parts=[];for(var k in params){parts.push(k+"="+params[k])}return parts.join("&")},combineUrlAndQueryParams:function(url,params){var urlParams=this.getQueryParams(url);var hashParts=url.split("#");var hashPart=hashParts[1]||"";var urlParts=hashParts[0].split("?");var pathPart=urlParts[0];var urlString=pathPart+"?"+this.toQueryString(Object.assign(urlParams,params));if(hashPart){urlString+="#"+hashPart}return urlString}}},{"./dom":32}],80:[function(require,module,exports){var device=require("./device");const weatherApi=require("./weather");const ApiError=require("./ApiError");module.exports={createUserInfo:function(window,defaultLocationData){var locationData=Object.assign({zipCode:"",countryCode:"",latitude:-1,longitude:-1},defaultLocationData);var fetchedLocationData=false;var deviceProps=device.getDeviceProperties(window);var deviceInfo={isMobile:deviceProps.isMobile,isOtherTouchDevice:!deviceProps.isMobile&&deviceProps.probablyTouchscreen,isOtherDevice:!deviceProps.isMobile&&!deviceProps.probablyTouchscreen};var weatherData=null;return{hasFetchedWeatherData:function(){return weatherData!=null},getWeatherData:function(){return weatherData},hasValidLocationData:function(){return locationData.countryCode!==""},hasZipCode:function(){return locationData.zipCode!==""},hasCountryCode:function(){return locationData.countryCode!==""},hasFetchedLocationData:function(){return fetchedLocationData},getLocationData:function(){return locationData},getDeviceInfo:function(){return deviceInfo},overrideDeviceInfo:function(overrides){Object.assign(deviceInfo,overrides)},updateLocationFromAPI:function(callback){var xhr=new XMLHttpRequest;xhr.open("GET","https://cjk2h0sjce.execute-api.us-east-1.amazonaws.com/production/test",true);xhr.addEventListener("loadend",function(){fetchedLocationData=true;if(xhr.status>=300||xhr.status<200){callback(new ApiError("Failed to fetch user location"));return}var resultData=JSON.parse(xhr.responseText);locationData={countryCode:resultData.country_code.toLowerCase(),latitude:resultData.latitude,longitude:resultData.longitude,zipCode:resultData.zip};callback(null,locationData)});xhr.send()},updateWeatherFromAPI:function(creativeId,callback,retrying=false){if(!this.hasValidLocationData()&&this.hasFetchedLocationData()){callback(new ApiError("Cannot fetch weather data - hasValidLocationData is false, but hasFetchedLocationData is true"));return}if(!this.hasZipCode()||!this.hasCountryCode()){if(retrying){callback(new ApiError("Failed to get valid location data despite retry"));return}this.updateLocationFromAPI(err=>{if(err){callback(err);return}this.updateWeatherFromAPI(creativeId,callback,true)})}const{zipCode,countryCode}=locationData;weatherApi.fetchCurrentWeatherByZipCode(creativeId,zipCode,countryCode,function(err,weatherResult){if(err){callback(err);return}weatherData=weatherResult;callback(null,weatherData)})}}}}},{"./ApiError":8,"./device":31,"./weather":83}],81:[function(require,module,exports){var creativeUUID=_generateUUID();function getCreativeUUID(){return creativeUUID}function _generateUUID(){if(typeof crypto==="undefined"){console.warn("Crypto is missing");return""}return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,c=>(c^crypto.getRandomValues(new Uint8Array(1))[0]&15>>c/4).toString(16))}module.exports={creativeUUID:getCreativeUUID(),generateUUID:function(){return _generateUUID()}}},{}],82:[function(require,module,exports){var dom=require("./dom");module.exports={isElementVisible:function(containerWindow,element){var offset=element.getBoundingClientRect();var outOfBounds=offset.bottom<0||offset.top>containerWindow.innerHeight||offset.right<0||offset.left>containerWindow.innerWidth;if(outOfBounds||!containerWindow.document.elementFromPoint){return!outOfBounds}var sampleSize=5;var sampleXOffset=offset.width/sampleSize;var sampleYOffset=offset.height/sampleSize;var points=[];for(var i=0;i<sampleSize;i++){points.push([offset.left+1+sampleXOffset*i,offset.top+1+sampleYOffset*i]);points.push([offset.right-1-sampleXOffset*i,offset.top+1+sampleYOffset*i]);points.push([offset.left+1+sampleXOffset*i,offset.bottom-1-sampleYOffset*i]);points.push([offset.right-1-sampleXOffset*i,offset.bottom-1-sampleYOffset*i])}for(i=0;i<points.length;i++){var foundEl=containerWindow.document.elementFromPoint(points[i][0],points[i][1]);if(foundEl===element){return true}}return false},getVisiblePercentage:function(containerWindow,element){var windowSize=dom.getWindowSize(containerWindow);var windowScroll=dom.getWindowScrollOffset(containerWindow);var elementBounds=element.getBoundingClientRect();var intersection=Math.max(0,Math.min(windowScroll.x+windowSize.width,elementBounds.right)-Math.max(windowScroll.x,elementBounds.left))*(elementBounds.top+elementBounds.height>windowSize.height?Math.max(0,windowSize.height-elementBounds.top):Math.max(0,Math.max(0,elementBounds.bottom)-Math.max(0,elementBounds.top)));var windowArea=windowSize.width*windowSize.height;var elementArea=elementBounds.width*elementBounds.height;return Math.min(1,intersection/Math.min(windowArea,elementArea))},onVisibilityChange:function(containerObject,callback,startStop){var frameVisibility;containerObject.getAdDocument().addEventListener("visibilitychange",function(){emitVisibilityEvent()});var emitVisibilityEvent=function(){var visible=containerObject.isAdVisible(startStop);var pageVisibility=containerObject.getAdDocument().visibilityState;if(typeof pageVisibility==="string"){visible=visible&&pageVisibility==="visible"}if(frameVisibility!=visible){callback(visible)}frameVisibility=visible};emitVisibilityEvent();return containerObject.onPageScroll(emitVisibilityEvent)},getOnScreenPercentage:function(containerWindow,element,startStop){var windowSize=dom.getWindowSize(containerWindow);var bounds=element.getBoundingClientRect();var percentageIn;if(startStop===-1){percentageIn=(bounds.top-0)/(windowSize.height-bounds.height-0)}else if(startStop===2){percentageIn=(bounds.top- -bounds.height)/(windowSize.height- -bounds.height)}else if(startStop===3){percentageIn=bounds.top/(windowSize.height-bounds.height+bounds.height/2)}else{percentageIn=(bounds.top+bounds.height*startStop)/windowSize.height}if(percentageIn<0){percentageIn=0}if(percentageIn>1){percentageIn=1}percentageIn=1-percentageIn;return percentageIn}}},{"./dom":32}],83:[function(require,module,exports){const config=require("./config");const ApiError=require("./ApiError");const weatherConditionStrings=["tornado","tropical storm","hurricane","strong storms","thunderstorms","rain/snow","rain/sleet","wintry mix","freezing drizzle","drizzle","freezing rain","showers","rain","flurries","snow showers","blowing/drifting snow","snow","hail","sleet","blowing dust/sandstorms","foggy","haze","smoke","breezy","windy","frigid/ice crystals","cloudy","mostly cloudy","partly cloudy","clear","sunny","fair/mostly clear","fair/mostly sunny","mixed rain and hail","hot","isolated thunderstorms","heavy rain","scattered snow showers","heavy snow","blizzard","scattered showers","scattered snow showers","scattered thunderstorms"];module.exports={fetchCurrentWeatherByZipCode:function(creativeId,zipCode,countryCode,callback){const xhr=new XMLHttpRequest;xhr.open("GET",`${config.weatherApiZipCode}?zipCode=${zipCode}&countryCode=${countryCode}&creativeId=${creativeId}`,true);xhr.addEventListener("loadend",function(){if(xhr.status>=300||xhr.status<200){callback(new ApiError("Failed to fetch weather data"));return}var resultData=JSON.parse(xhr.responseText);if(!resultData.weather){callback(new ApiError("invalid response"));return}callback(null,resultData.weather)});xhr.send()},weatherConditionStrings:weatherConditionStrings}},{"./ApiError":8,"./config":26}],84:[function(require,module,exports){var async=require("./async.js");var loadPromises={};var lastDocument=null;function init(document){if(document!==lastDocument){loadPromises={}}lastDocument=document}function loadSimpleCss(document,href){return async.defer(function(done){var elLink=document.createElement("link");elLink.rel="stylesheet";elLink.href=href;elLink.onload=function(){done(null)};elLink.onerror=function(){var error=new Error("Failed to load uploaded webfont CSS. Is it deleted? "+href);done(error)};document.head.appendChild(elLink)})}function loadMonotypeFont(document,font){var licenseText=font.import.code.licenseText;var trackerScript=font.import.code.trackerScript;if(trackerScript){var elScript=document.createElement("script");elScript.text=trackerScript;document.head.appendChild(elScript)}if(licenseText){var domComment=document.createComment(licenseText);document.head.appendChild(domComment)}var href=font.import.urlBase+"demo-async.css";return loadSimpleCss(document,href)}function loadFontsCom(document,font){return loadMonotypeFont(document,font)}function loadFontShop(document,font){var href=font.import.urlBase+font.displayName+".css";return loadSimpleCss(document,href)}function loadFontSquirrel(document,font){var href=font.import.urlBase+"stylesheet.css";return loadSimpleCss(document,href)}function loadLinotype(document,font){return loadMonotypeFont(document,font)}function loadMyFonts(document,font){var licenseText=font.import.code.licenseText;if(licenseText){var domComment=document.createComment(licenseText);document.head.appendChild(domComment)}var href=font.import.urlBase+"MyFontsWebfontsKit/MyFontsWebfontsKit.css";return loadSimpleCss(document,href)}function loadTransfonter(document,font){var href=font.import.urlBase+"stylesheet.css";return loadSimpleCss(document,href)}function loadUser(document,font){return async.defer(function(done){try{const code=font.import.code.stylesheet;if(!code){throw new Error("Import code missing for "+font.displayName+". Probably there was an error on uploading")}const codeWithResolvedUrl=location.protocol==="file:"?code.replaceAll("url('//publish.responsiveads.com/","url('./"):code;var el=document.createElement("style");el.textContent=codeWithResolvedUrl;document.head.appendChild(el);done(null)}catch(error){done(error)}})}module.exports.load=function(document,font,callback){init(document);if(!font.import||!font.import.urlBase){console.warn(font);callback(new Error("Failed to resolve font URL"));return}var displayName=font.displayName;var p;if(displayName in loadPromises){p=loadPromises[displayName]}else{if(font.fontProvider==="Fonts.com"){p=loadFontsCom(document,font)}else if(font.fontProvider==="FontShop"){p=loadFontShop(document,font)}else if(font.fontProvider==="Font Squirrel"){p=loadFontSquirrel(document,font)}else if(font.fontProvider==="Linotype"){p=loadLinotype(document,font)}else if(font.fontProvider==="MyFonts"){p=loadMyFonts(document,font)}else if(font.fontProvider==="Transfonter"){p=loadTransfonter(document,font)}else if(font.fontProvider==="User"){p=loadUser(document,font)}else{var error=new Error("Unsupported font provider: "+font.fontProvider);callback(error);return}loadPromises[displayName]=p}p.then(function(error){callback(error)})}},{"./async.js":23}]},{},[62]);
