!function(e,t){"use strict";function n(t){var n=e.createElement("a");return n.href=decodeURIComponent(t),n}function r(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n,e);if(r)return r}}function o(e){var t=r(d,function(t){return e.href.match(t)});if(t){console.log("is skimlinks",e.href);var o=n(t[1]);e.href=o.href,e.hostname=o.hostname,e.vendor="skimlinks",e.product=o.href}return e}function a(e){var t=r(p,function(t){return e.href.match(t)});if(t){console.log("is amazon",e.href);var o=n(t[1]);e.href=o.href,e.hostname=o.hostname,e.vendor="amazon",e.product=t[0].split("?")}return e}function i(e){function t(t){for(var n=e.tracker,r=0;r<g.length;r++){var o=g[r],a=e[g[r]];a&&(n+=o+":"+a+"/")}return n+"destination:"+t}function n(t){return r(e.targetHostnames,function(e){return e===t})}return function(e){return n(e.hostname)&&(e.href=t(e.href),e.vendor="performancehorizon",e.redirect=!0),e}}function f(e,t){for(var n=0;n<t.length;n++)if(e.match(t[n]))return!0;return!1}function c(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t].test(n))return e[r]}function s(e,t,n){for(var r=Object.keys(e),o=[],a=0,i=0;i<r.length;i++){var f=r[i],c=f+":"+e[f];if(!(a+c.length<n))break;o.push(c),a+=c.length}return o.join(t)}function u(t,n,r){for(var o=e.links,a={total:0},i=0,c=Object.keys(n),s=0;s<c.length;s++)a[n[c[s]]]=0;for(var u=0;u<o.length;u++){var h=r.reduce(function(e,t){return t(e)},{hostname:o[u].hostname,href:o[u].href}),m=h.href,l=h.hostname;if(m&&l&&function(e){return!f(e,t)}(m)){i++;var d=n[l]||l;a[d]=(a[d]||0)+1}}return a.total=i,a}function h(e,n,r,o){if(t.s){var a=t.s,i=r.url,f=r.product,c=r.vendor,s=r.linkCount,u=r.name,h=[a[i],a[f],a[c],a[s]];a[i]=n.href,a[f]=n.product,a[c]=n.vendor,a[s]=n.linkCount,a.linkTrackVars=[i,f,c,s].join(","),a.linkTrackEvents="none",a.tl(e,"e",u,null,o),a[i]=h[0],a[f]=h[1],a[c]=h[2],a[s]=h[3]}}function m(){!function(e,t,n,r,o,a,i){e.fbq||(o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],(a=t.createElement(n)).async=!0,a.src="https://connect.facebook.net/en_US/fbevents.js",(i=t.getElementsByTagName(n)[0]).parentNode.insertBefore(a,i))}(t,e,"script")}function l(e){m();var n=t.fbq&&t.fbq.__fbeventsModules;n&&n.fbevents().getState().pixels.map(function(e){return e.id}).indexOf(e)>-1||t.fbq("init",e)}var d=[/go\.redirectingat\.com\/.*url=([^\&]+)/,/go\.skimresources\.com\/.*url=([^\&]+)/],p=[/^https?:\/\/(www\.)?amazon\..*/],g=["camref","creativeref","pubref","adref"],w=1,v=["A"];!function(n){function r(e,t){return t.redirect&&t.href!==e.href?t:e}function o(e,n,o){var a=r(e,n);console.log("open window",{initial:e.href,redirected:n.href,go:a.href}),t.open(a.href,o)||(t.location.href=a.href)}function a(e,t,n){r(t,n)===n&&(console.log("shuffled href",{initial:t.href,redirected:n.href}),e.setAttribute("href",n.href),setTimeout(function(){e.setAttribute("href",t.href)},0))}function i(e){if(e&&e.nodeType===w){if(v.indexOf(e.nodeName)>-1)return e;if(e.parentNode)return i(e.parentNode)}return null}var m=c(n.targetList,"targetLocation",location.href);m&&(n.facebookPixel&&n.facebookPixel.enabled&&n.facebookPixel.id&&l(n.facebookPixel.id),e.addEventListener("click",function(e){var r=i(e.target),c=m.elReducers,l=m.destinationReducers;if(r){var d={hostname:r.hostname,href:r.href},p=c.reduce(function(e,t){return t(e)},{hostname:d.hostname,href:d.href,product:"",vendor:""});if(!f(p.href,n.notExternal)){console.log("is external",p.href);var g=l.reduce(function(e,t){return t(e)},{href:p.href,hostname:p.hostname,vendor:p.vendor});if(n.facebookPixel&&n.facebookPixel.enabled&&n.facebookPixel.targetLinkRegEx.test(r.textContent)&&"function"==typeof t.fbq&&t.fbq("track","AddToCart",{content_type:"product",content_name:p.href}),n.omniture&&n.omniture.enableExitLinkTracking){e.preventDefault();var w=n.shortNames,v=s(u(n.notExternal,w,c),"|",100);h(r,Object.assign({linkCount:v},d,p,g),n.omniture,function(){var e=r.target||"_self";o(d,g,e)})}a(r,d,g)}}},!0))}({targetList:[{targetLocation:/www.gq.com/,elReducers:[o,a],destinationReducers:[i({tracker:"http://prf.hn/click/",camref:"1011l3dMu",pubref:"GQ",targetHostnames:["www.farfetch.com"]})]},{targetLocation:/.*/,elReducers:[o,a],destinationReducers:[i({tracker:"http://demo.prf.hn/click/",camref:"111111l5Vt",pubref:"GQ",targetHostnames:["www.farfetch.com"]})]}],notExternal:[/^https?:\/\/[^\/]*\.gq\.[^\/]*(\/|$)/m,/^https?:\/\/[^\/]*\.gqstyle\.[^\/]*(\/|$)/m,/^https?:\/\/[^\/]*\.gq-?magazine?\.[^\/]*(\/|$)/m,/^https?:\/\/gq\.[^\/]*(\/|$)/m,/^https?:\/\/[^\/]*condenast\.com(\/|$)/m,/^https?:\/\/[^\/]+\/gq(\/|$)/m,/^https?:\/\/[^\/]+\/gqmagazine(\/|$)/m,/^https?:\/\/www\.condenaststore\.com(\/|$)/m,/^https?:\/\/www\.revistagq\.com(\/|$)/m,/^https?:\/\/www\.gqindia\.com(\/|$)/m,/^https?:\/\/www\.gqjapan\.jp(\/|$)/m,/^https?:\/\/www\.gqthailand\.com(\/|$)/m,/^https?:\/\/www\.gqitalia\.it(\/|$)/m,/^https?:\/\/www\.youtube\.com\/user\/gqvideos\//m,/cds_mag_code=GQM/m,/^https?:\/\/www\.outbrain\.com\/what-is\/default\/en/m,/^https?:\/\/www\.facebook\.com\//m,/^https?:\/\/twitter\.com\/share/m,/^mailto:/m,/^https?:\/\/www\.pinterest\.com\/pin\/create\/button/m,/^https?:\/\/localhost/m]})}(document,window);
